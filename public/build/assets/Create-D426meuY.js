import{r as _,j as e,G as J,S as K,x as E}from"./app-BMIA6nir.js";import{A as W}from"./AppLayout-DbMk6clK.js";import{C as j,a as f,b as v,d as z,c as g}from"./card-BAsSN-2Z.js";import{B as p}from"./createLucideIcon-Cg8jdX0w.js";import{I as u}from"./input-Bg5GDATO.js";import{L as c}from"./label-CM6YsqH1.js";import{T as P}from"./textarea-CP26afIU.js";import{S as w,a as S,b as F,c as A,d as N}from"./select-B6KOX9nY.js";import{u as O}from"./useTranslate-ER5gAOX6.js";import{A as Y,a as Z}from"./alert-CNp8ZuHk.js";import{u as ee}from"./useFinanceAI-oMHKJO8s.js";import{B as H}from"./bot-COuCQh0r.js";import{X as se,U as te}from"./x-C3KwZK3B.js";import{S as ae}from"./sparkles-Csmgo_ih.js";import{C as R}from"./calculator-DwuSx6in.js";import{C as ie}from"./circle-alert-DVIk47WR.js";import{C as ne}from"./circle-check-big-DCsv6rXk.js";import{C as re}from"./copy-XqgUo3o3.js";import{t as L}from"./index-Dj2TB_RL.js";import{A as ce}from"./arrow-left-UX2kDF52.js";import{F as le}from"./file-text-D25AipK4.js";import{T as oe}from"./trash-2-DZc0jDKK.js";import{P as de}from"./plus-BjPf5uI-.js";import{D as me}from"./dollar-sign-Cli0KufN.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./bell-5VRgJnzP.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";function pe({onItemsGenerated:D,onClose:b}){O();const{generateInvoiceItems:T,loading:C}=ee(),[t,o]=_.useState(""),[x,q]=_.useState(""),[d,n]=_.useState(null),r=async()=>{if(!t.trim())return;const i=await T({project_description:t,estimated_value:x?parseFloat(x):void 0});i&&n(i)},k=()=>{d&&(D(d.items,d.notes),b())},h=i=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(i);return e.jsxs(j,{className:"border-green-200 bg-green-50/50",children:[e.jsxs(f,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5 text-green-600"}),e.jsx(v,{className:"text-green-700",children:"AI Invoice Items Generator"})]}),e.jsx(p,{variant:"ghost",size:"sm",onClick:b,className:"h-6 w-6 p-0 text-green-600 hover:text-green-800",children:e.jsx(se,{className:"h-4 w-4"})})]}),e.jsx(z,{children:"Generate professional invoice line items based on your project description"})]}),e.jsxs(g,{className:"space-y-4",children:[d?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Invoice Items Generated"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Line Items"}),d.items.map((i,G)=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center text-sm border-b pb-2",children:[e.jsx("div",{className:"col-span-6",children:e.jsx("p",{className:"font-medium",children:i.description})}),e.jsx("div",{className:"col-span-2 text-center",children:e.jsx("p",{children:i.quantity})}),e.jsx("div",{className:"col-span-2 text-right",children:e.jsx("p",{children:h(i.unit_price)})}),e.jsx("div",{className:"col-span-2 text-right",children:e.jsx("p",{className:"font-medium",children:h(i.quantity*i.unit_price)})})]},G))]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex justify-between items-center font-medium",children:[e.jsx("span",{children:"Total Estimated:"}),e.jsx("span",{className:"text-lg",children:h(d.total_estimated)})]})}),d.notes&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs text-muted-foreground",children:"Suggested Notes"}),e.jsx("div",{className:"bg-gray-50 rounded p-3",children:e.jsx("p",{className:"text-sm",children:d.notes})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(p,{onClick:k,className:"flex-1",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Apply to Invoice"]}),e.jsx(p,{variant:"outline",onClick:()=>n(null),children:"Try Again"})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"project-description",children:"Project Description *"}),e.jsx(P,{id:"project-description",placeholder:"Describe your project or service in detail...",value:t,onChange:i=>o(i.target.value),rows:4,className:"resize-none"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Be specific about the services, deliverables, and scope of work"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"estimated-value",children:"Estimated Total Value (Optional)"}),e.jsx(u,{id:"estimated-value",type:"number",min:"0",step:"0.01",placeholder:"0.00",value:x,onChange:i=>q(i.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Helps AI generate more accurate pricing"})]})]}),e.jsx(p,{onClick:r,disabled:!t.trim()||C,className:"w-full",children:C?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating Items..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Generate Invoice Items"]})}),e.jsxs(Y,{children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx(Z,{className:"text-sm",children:"AI will break down your project into professional invoice line items with suggested quantities and pricing."})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center pt-2 border-t",children:"Powered by Mistral AI"})]})]})}function hs({clients:D=[],leads:b=[],currencies:T={},statuses:C={}}){var $;const{t}=O(),[o,x]=_.useState([{description:"",quantity:1,unit_price:0,total_price:0}]),[q,d]=_.useState(!1),{data:n,setData:r,post:k,processing:h,errors:i}=J({billable_type:"",billable_id:"",issue_date:new Date().toISOString().split("T")[0],due_date:"",currency:"USD",status:"draft",notes:"",terms:"",tax_rate:0,discount_amount:0,items:o}),G=()=>{x([...o,{description:"",quantity:1,unit_price:0,total_price:0}])},M=s=>{if(o.length>1){const a=o.filter((m,l)=>l!==s);x(a),r("items",a)}},V=(s,a,m)=>{const l=[...o];l[s]={...l[s],[a]:m},(a==="quantity"||a==="unit_price")&&(l[s].total_price=l[s].quantity*l[s].unit_price),x(l),r("items",l)},I=()=>o.reduce((s,a)=>s+a.total_price,0),B=()=>I()*n.tax_rate/100,U=()=>I()+B()-n.discount_amount,Q=s=>{s.preventDefault();const a={...n,items:o,subtotal:I(),tax_amount:B(),total_amount:U()};k(route("finance.invoices.store"),{data:a,onSuccess:()=>{L.success(t("finance.invoice_created","Invoice created successfully"))},onError:()=>{L.error(t("common.error_occurred","An error occurred"))}})},y=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:n.currency}).format(s),X=(s,a)=>{const m=s.map(l=>({description:l.description,quantity:l.quantity,unit_price:l.unit_price,total_price:l.quantity*l.unit_price}));x(m),r("items",m),a&&!n.notes&&r("notes",a),L.success("Invoice items generated successfully!")};return e.jsxs(W,{title:t("finance.create_invoice","Create Invoice"),breadcrumbs:[{label:t("finance.title","Finance"),href:"/finance"},{label:t("finance.invoices","Invoices"),href:"/finance/invoices"},{label:t("finance.create_invoice","Create Invoice")}],children:[e.jsx(K,{title:t("finance.create_invoice","Create Invoice")}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(p,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(E,{href:route("finance.invoices.index"),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),t("common.back","Back")]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:t("finance.create_invoice","Create Invoice")}),e.jsx("p",{className:"text-muted-foreground",children:t("finance.create_invoice_description","Create a new invoice for your client")})]})]}),e.jsxs("form",{onSubmit:Q,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(j,{children:[e.jsx(f,{children:e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),t("finance.invoice_details","Invoice Details")]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"issue_date",children:[t("finance.issue_date","Issue Date")," *"]}),e.jsx(u,{id:"issue_date",type:"date",value:n.issue_date,onChange:s=>r("issue_date",s.target.value),required:!0}),i.issue_date&&e.jsx("p",{className:"text-sm text-red-600",children:i.issue_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"due_date",children:[t("finance.due_date","Due Date")," *"]}),e.jsx(u,{id:"due_date",type:"date",value:n.due_date,onChange:s=>r("due_date",s.target.value),required:!0}),i.due_date&&e.jsx("p",{className:"text-sm text-red-600",children:i.due_date})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"currency",children:[t("finance.currency","Currency")," *"]}),e.jsxs(w,{value:n.currency,onValueChange:s=>r("currency",s),children:[e.jsx(S,{children:e.jsx(F,{})}),e.jsx(A,{children:Object.entries(T||{}).map(([s,a])=>e.jsxs(N,{value:s,children:[s," - ",a]},s))})]}),i.currency&&e.jsx("p",{className:"text-sm text-red-600",children:i.currency})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"status",children:[t("common.status","Status")," *"]}),e.jsxs(w,{value:n.status,onValueChange:s=>r("status",s),children:[e.jsx(S,{children:e.jsx(F,{})}),e.jsx(A,{children:Object.entries(C||{}).map(([s,a])=>e.jsx(N,{value:s,children:a},s))})]}),i.status&&e.jsx("p",{className:"text-sm text-red-600",children:i.status})]})]})]})]}),e.jsxs(j,{children:[e.jsx(f,{children:e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),t("finance.client_details","Client Details")]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"billable_type",children:[t("finance.client_type","Client Type")," *"]}),e.jsxs(w,{value:n.billable_type,onValueChange:s=>{r("billable_type",s),r("billable_id","")},children:[e.jsx(S,{children:e.jsx(F,{placeholder:t("finance.select_client_type","Select client type")})}),e.jsxs(A,{children:[e.jsx(N,{value:"client",children:t("crm.client","Client")}),e.jsx(N,{value:"lead",children:t("crm.lead","Lead")})]})]}),i.billable_type&&e.jsx("p",{className:"text-sm text-red-600",children:i.billable_type})]}),n.billable_type&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"billable_id",children:[n.billable_type==="client"?t("crm.client","Client"):t("crm.lead","Lead")," *"]}),e.jsxs(w,{value:n.billable_id,onValueChange:s=>r("billable_id",s),children:[e.jsx(S,{children:e.jsx(F,{placeholder:`Select ${n.billable_type}`})}),e.jsx(A,{children:(($=n.billable_type==="client"?D:b)==null?void 0:$.map(s=>e.jsx(N,{value:s.id.toString(),children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.email})]})},s.id)))||[]})]}),i.billable_id&&e.jsx("p",{className:"text-sm text-red-600",children:i.billable_id})]})]})]})]}),e.jsxs(j,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),t("finance.invoice_items","Invoice Items")]}),e.jsx(z,{children:t("finance.add_items_description","Add items or services to your invoice")})]}),e.jsxs(p,{type:"button",variant:"outline",size:"sm",onClick:()=>d(!0),className:"text-green-600 border-green-200 hover:bg-green-50",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"Generate with AI"]})]})}),e.jsxs(g,{className:"space-y-4",children:[q&&e.jsx(pe,{onItemsGenerated:X,onClose:()=>d(!1)}),o.map((s,a)=>e.jsxs("div",{className:"grid gap-4 md:grid-cols-12 items-end p-4 border rounded-lg",children:[e.jsxs("div",{className:"md:col-span-5 space-y-2",children:[e.jsx(c,{htmlFor:`description-${a}`,children:t("finance.description","Description")}),e.jsx(u,{id:`description-${a}`,placeholder:t("finance.item_description","Item description"),value:s.description,onChange:m=>V(a,"description",m.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(c,{htmlFor:`quantity-${a}`,children:t("finance.quantity","Quantity")}),e.jsx(u,{id:`quantity-${a}`,type:"number",min:"1",step:"1",value:s.quantity,onChange:m=>V(a,"quantity",parseInt(m.target.value)||1)})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(c,{htmlFor:`unit_price-${a}`,children:t("finance.unit_price","Unit Price")}),e.jsx(u,{id:`unit_price-${a}`,type:"number",min:"0",step:"0.01",value:s.unit_price,onChange:m=>V(a,"unit_price",parseFloat(m.target.value)||0)})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(c,{children:t("finance.total","Total")}),e.jsx("div",{className:"h-10 px-3 py-2 border rounded-md bg-muted flex items-center",children:y(s.total_price)})]}),e.jsx("div",{className:"md:col-span-1",children:e.jsx(p,{type:"button",variant:"outline",size:"sm",onClick:()=>M(a),disabled:o.length===1,children:e.jsx(oe,{className:"h-4 w-4"})})})]},a)),e.jsxs(p,{type:"button",variant:"outline",onClick:G,children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),t("finance.add_item","Add Item")]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(v,{children:t("finance.additional_information","Additional Information")})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"notes",children:t("finance.notes","Notes")}),e.jsx(P,{id:"notes",placeholder:t("finance.invoice_notes_placeholder","Add any notes for the client..."),value:n.notes,onChange:s=>r("notes",s.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"terms",children:t("finance.terms","Terms & Conditions")}),e.jsx(P,{id:"terms",placeholder:t("finance.terms_placeholder","Payment terms and conditions..."),value:n.terms,onChange:s=>r("terms",s.target.value),rows:3})]})]})]}),e.jsxs(j,{children:[e.jsx(f,{children:e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),t("finance.invoice_totals","Invoice Totals")]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"tax_rate",children:t("finance.tax_rate","Tax Rate (%)")}),e.jsx(u,{id:"tax_rate",type:"number",min:"0",max:"100",step:"0.01",value:n.tax_rate,onChange:s=>r("tax_rate",parseFloat(s.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"discount_amount",children:t("finance.discount_amount","Discount Amount")}),e.jsx(u,{id:"discount_amount",type:"number",min:"0",step:"0.01",value:n.discount_amount,onChange:s=>r("discount_amount",parseFloat(s.target.value)||0)})]})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[t("finance.subtotal","Subtotal"),":"]}),e.jsx("span",{className:"font-medium",children:y(I())})]}),n.tax_rate>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[t("finance.tax","Tax")," (",n.tax_rate,"%):"]}),e.jsx("span",{className:"font-medium",children:y(B())})]}),n.discount_amount>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[t("finance.discount","Discount"),":"]}),e.jsxs("span",{className:"font-medium",children:["-",y(n.discount_amount)]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold pt-2 border-t",children:[e.jsxs("span",{children:[t("finance.total","Total"),":"]}),e.jsx("span",{children:y(U())})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(p,{type:"button",variant:"outline",asChild:!0,children:e.jsx(E,{href:route("finance.invoices.index"),children:t("common.cancel","Cancel")})}),e.jsx(p,{type:"submit",disabled:h,children:h?t("common.saving","Saving..."):t("finance.create_invoice","Create Invoice")})]})]})]})]})}export{hs as default};
