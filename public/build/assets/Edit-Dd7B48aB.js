import{u as E,r as w,j as e,S as F,A as f}from"./app-BMIA6nir.js";import{A as O,N as M}from"./AppLayout-DbMk6clK.js";import{C as o,a as x,b as h,d as N,c as p}from"./card-BAsSN-2Z.js";import{B as r}from"./createLucideIcon-Cg8jdX0w.js";import{I}from"./input-Bg5GDATO.js";import{L as d}from"./label-CM6YsqH1.js";import{T as k}from"./textarea-CP26afIU.js";import{S as L,a as J,b as z,c as B,d as P}from"./select-B6KOX9nY.js";import{S as $}from"./switch-_qD_kSA5.js";import{A as V,a as R}from"./alert-CNp8ZuHk.js";import{B as q}from"./x-C3KwZK3B.js";import{u as H}from"./useTranslate-ER5gAOX6.js";import{t as j}from"./index-Dj2TB_RL.js";import{A as U}from"./arrow-left-UX2kDF52.js";import{P as A}from"./plus-BjPf5uI-.js";import{S as W}from"./save-D6UyxhH5.js";import{T as G}from"./triangle-alert-BWIpgUmg.js";import{S as K}from"./sheet-1SUjjT9Y.js";import{S as Q}from"./square-pen-CReBrXbl.js";import{T as X}from"./trash-2-DZc0jDKK.js";import"./useTypedPage-hmuARwun.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./bell-5VRgJnzP.js";import"./dollar-sign-Cli0KufN.js";import"./file-text-D25AipK4.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";function Ye({menu:i,locations:D,errors:a}){const{t:s}=H(),g=E(),[v,u]=w.useState(!1),[n,_]=w.useState({name:i.name,slug:i.slug,description:i.description||"",location:i.location,is_active:i.is_active,settings:JSON.stringify(i.settings||{},null,2)}),l=(t,c)=>{if(_(m=>({...m,[t]:c})),t==="name"&&!n.slug){const m=c.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");_(T=>({...T,slug:m}))}},y=async t=>{t.preventDefault(),u(!0);try{try{JSON.parse(n.settings)}catch{j.error(s("cms.invalid_json","Invalid JSON format in settings")),u(!1);return}f.put(g("cms.menus.update",i.id),{...n,settings:JSON.parse(n.settings)},{onSuccess:()=>{j.success(s("cms.menu_updated","Menu updated successfully"))},onError:c=>{console.error("Validation errors:",c),j.error(s("cms.menu_update_failed","Failed to update menu"))},onFinish:()=>{u(!1)}})}catch(c){console.error("Error updating menu:",c),j.error(s("cms.menu_update_failed","Failed to update menu")),u(!1)}},S=()=>{f.visit(g("cms.menus.items.index",i.id))},b=t=>new Date(t).toLocaleDateString(),C=(t,c=0)=>t.map(m=>e.jsxs("div",{className:`border rounded-lg p-3 ${c>0?"ml-6 border-l-2 border-l-primary":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium",children:m.title}),m.target==="_blank"&&e.jsx(q,{variant:"outline",className:"text-xs",children:"External"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.url})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(Q,{className:"h-3 w-3"})}),e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(X,{className:"h-3 w-3"})})]})]}),m.children&&m.children.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:C(m.children,c+1)})]},m.id));return e.jsxs(O,{children:[e.jsx(F,{title:`${s("common.edit","Edit")} ${i.name}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>f.visit(g("cms.menus.index")),children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),s("common.back","Back")]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight",children:[s("common.edit","Edit")," ",i.name]}),e.jsx("p",{className:"text-muted-foreground",children:s("cms.edit_menu_description","Modify menu settings and structure")})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"outline",onClick:S,children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),s("cms.manage_items","Manage Items")]}),e.jsxs(r,{onClick:y,disabled:v||!n.name||!n.location,children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),v?s("common.saving","Saving..."):s("common.save","Save")]})]})]}),Object.keys(a||{}).length>0&&e.jsxs(V,{variant:"destructive",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx(R,{children:s("common.validation_errors","Please fix the validation errors below")})]}),e.jsx("form",{onSubmit:y,className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(o,{children:[e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),s("cms.menu_details","Menu Details")]}),e.jsx(N,{children:s("cms.menu_details_desc","Configure the basic menu information")})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"name",children:[s("cms.menu_name","Menu Name")," *"]}),e.jsx(I,{id:"name",value:n.name,onChange:t=>l("name",t.target.value),placeholder:s("cms.enter_menu_name","Enter menu name"),className:a!=null&&a.name?"border-destructive":""}),(a==null?void 0:a.name)&&e.jsx("p",{className:"text-sm text-destructive",children:a.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"slug",children:s("cms.slug","Slug")}),e.jsx(I,{id:"slug",value:n.slug,onChange:t=>l("slug",t.target.value),placeholder:s("cms.auto_generated","Auto-generated from name"),className:a!=null&&a.slug?"border-destructive":""}),(a==null?void 0:a.slug)&&e.jsx("p",{className:"text-sm text-destructive",children:a.slug})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"description",children:s("cms.description","Description")}),e.jsx(k,{id:"description",value:n.description,onChange:t=>l("description",t.target.value),placeholder:s("cms.menu_description_placeholder","Describe this menu..."),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"location",children:[s("cms.menu_location","Menu Location")," *"]}),e.jsxs(L,{value:n.location,onValueChange:t=>l("location",t),children:[e.jsx(J,{className:a!=null&&a.location?"border-destructive":"",children:e.jsx(z,{placeholder:s("cms.select_location","Select a location")})}),e.jsx(B,{children:Object.entries(D).map(([t,c])=>e.jsx(P,{value:t,children:c},t))})]}),(a==null?void 0:a.location)&&e.jsx("p",{className:"text-sm text-destructive",children:a.location}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("cms.location_help","Where this menu will be displayed on your website")})]})]})]}),e.jsxs(o,{children:[e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:[s("cms.menu_items","Menu Items")," (",i.items.length,")"]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:S,children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),s("cms.manage_items","Manage Items")]})]}),e.jsx(N,{children:s("cms.menu_items_desc","Current menu structure and items")})]}),e.jsx(p,{children:i.items.length>0?e.jsx("div",{className:"space-y-3",children:C(i.items)}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(M,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:s("cms.no_menu_items","No menu items yet")}),e.jsx("p",{className:"text-sm",children:s("cms.add_menu_items_hint",'Click "Manage Items" to add menu items')})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(o,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5"}),s("cms.menu_settings","Menu Settings")]})}),e.jsx(p,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{children:s("cms.active","Active")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("cms.menu_active_desc","Make this menu available for display")})]}),e.jsx($,{checked:n.is_active,onCheckedChange:t=>l("is_active",t)})]})})]}),e.jsxs(o,{children:[e.jsx(x,{children:e.jsx(h,{children:s("cms.menu_information","Menu Information")})}),e.jsxs(p,{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("cms.created_by","Created by"),": "]}),e.jsx("span",{children:i.created_by.name})]}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("cms.created_at","Created"),": "]}),e.jsx("span",{children:b(i.created_at)})]}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("cms.updated_at","Updated"),": "]}),e.jsx("span",{children:b(i.updated_at)})]}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("cms.total_items","Total Items"),": "]}),e.jsx("span",{className:"font-medium",children:i.items.length})]})]})]}),e.jsxs(o,{children:[e.jsxs(x,{children:[e.jsx(h,{children:s("cms.advanced_settings","Advanced Settings")}),e.jsx(N,{children:s("cms.menu_advanced_settings_desc","JSON configuration for menu behavior")})]}),e.jsx(p,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"settings",children:s("cms.menu_settings_json","Menu Settings")}),e.jsx(k,{id:"settings",value:n.settings,onChange:t=>l("settings",t.target.value),placeholder:'{"max_depth": 3, "show_icons": true, "mobile_breakpoint": "768px"}',rows:6,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("cms.json_format","JSON format")})]})})]})]})]})})]})]})}export{Ye as default};
