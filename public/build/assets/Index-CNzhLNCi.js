import{u as ke,r as i,j as e,S as Ce,x as C,A as S}from"./app-BMIA6nir.js";import{A as Se,S as Me,U as Ae,C as Pe}from"./AppLayout-DbMk6clK.js";import{c as Te,B as l}from"./createLucideIcon-Cg8jdX0w.js";import{C as u,c as g,a as Re,b as Be,d as De}from"./card-BAsSN-2Z.js";import{B as f}from"./x-C3KwZK3B.js";import{I as Q}from"./input-Bg5GDATO.js";import{S as z,a as F,b as E,c as G,d as x}from"./select-B6KOX9nY.js";import{T as Le,a as ze,b as W,c as J}from"./tabs-YflTNJKH.js";import{C as h}from"./checkbox-B8CiFAgv.js";import{D as X,a as Y,b as Z,c as ee,d as se,e as ae,f as te}from"./dialog-BAVny-7O.js";import{L as m}from"./label-CM6YsqH1.js";import{u as Fe}from"./useTranslate-ER5gAOX6.js";import{S as re}from"./search-_p1CX5vB.js";import{S as U}from"./shield-DwKJ9Ble.js";import{D as le}from"./database-COWZUYE3.js";import{U as ie}from"./users-3SuyoAg3.js";import{F as Ee}from"./funnel-v8IwREza.js";import{K as ne}from"./key-Qw2I2-NE.js";import{E as ce}from"./eye-DdivFxyT.js";import{S as de}from"./square-pen-CReBrXbl.js";import{T as oe}from"./trash-2-DZc0jDKK.js";import{P as Ge}from"./plus-BjPf5uI-.js";import{S as me}from"./sheet-1SUjjT9Y.js";import{B as Ue}from"./brain-D-NomhzH.js";import{U as $e}from"./user-check-s2c-295p.js";import{F as _e}from"./file-text-D25AipK4.js";import{M as Ve}from"./message-square-32k9udjC.js";import{B as He}from"./briefcase-VHX-s59a.js";import"./useTypedPage-hmuARwun.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./index-Dj2TB_RL.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./bell-5VRgJnzP.js";import"./dollar-sign-Cli0KufN.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./user-cog-hTW3YbTW.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Oe=Te("wand-sparkles",Ie);function Ws({permissions:N,roles:$,modules:_,filters:P}){Fe();const c=ke(),[y,xe]=i.useState(P.search||""),[v,he]=i.useState(P.module||"all"),[w,pe]=i.useState(P.role||"all"),[r,d]=i.useState([]),[je,M]=i.useState(!1),[ue,T]=i.useState(!1),[p,ge]=i.useState("assign"),[b,R]=i.useState([]),[B,V]=i.useState(""),[k,D]=i.useState([]),[A,L]=i.useState([]),fe=["view","create","edit","delete","manage","export","import"],H=(s,t)=>{d(t?[...r,s]:r.filter(a=>a!==s))},Ne=s=>{d(s?o.map(t=>t.id):[])},ye=()=>{if(r.length!==0)if(p==="delete")confirm(`Are you sure you want to delete ${r.length} permission(s)?`)&&S.delete(c("admin.permissions.bulk-delete"),{data:{permission_ids:r},onSuccess:()=>{d([]),M(!1)}});else{if(b.length===0){alert("Please select at least one role.");return}S.post(c("admin.permissions.bulk-assign-roles"),{permission_ids:r,role_ids:b,action:p},{onSuccess:()=>{d([]),R([]),M(!1)}})}},ve=()=>{if(!B||k.length===0){alert("Please enter a module name and select at least one action.");return}S.post(c("admin.permissions.generate-module"),{module:B,actions:k,assign_to_roles:A},{onSuccess:()=>{V(""),D([]),L([]),T(!1)}})},we=()=>{S.get(c("admin.permissions.index"),{search:y,module:v,role:w},{preserveState:!0,replace:!0})},I=i.useMemo(()=>{const s=new Set;return N.forEach(t=>{t.roles.forEach(a=>{s.add(a.name)})}),Array.from(s).sort()},[N]),o=i.useMemo(()=>N.filter(s=>{const t=s.name.toLowerCase().includes(y.toLowerCase())||s.description.toLowerCase().includes(y.toLowerCase()),a=v==="all"||s.module===v,n=w==="all"||s.roles.some(j=>j.name===w);return t&&a&&n}),[N,y,v,w]),O=i.useMemo(()=>{const s={};return o.forEach(t=>{const a=t.module||"system";s[a]||(s[a]=[]),s[a].push(t)}),s},[o]),be=s=>{switch(s){case"admin":return e.jsx(me,{className:"h-5 w-5"});case"crm":return e.jsx(ie,{className:"h-5 w-5"});case"finance":return e.jsx(Pe,{className:"h-5 w-5"});case"projects":return e.jsx(He,{className:"h-5 w-5"});case"support":return e.jsx(Ve,{className:"h-5 w-5"});case"cms":return e.jsx(_e,{className:"h-5 w-5"});case"hr":return e.jsx($e,{className:"h-5 w-5"});case"ai":return e.jsx(Ue,{className:"h-5 w-5"});case"settings":return e.jsx(me,{className:"h-5 w-5"});default:return e.jsx(le,{className:"h-5 w-5"})}},q=s=>({admin:"bg-red-100 text-red-800 border-red-200",crm:"bg-blue-100 text-blue-800 border-blue-200",finance:"bg-green-100 text-green-800 border-green-200",projects:"bg-purple-100 text-purple-800 border-purple-200",support:"bg-orange-100 text-orange-800 border-orange-200",cms:"bg-indigo-100 text-indigo-800 border-indigo-200",hr:"bg-pink-100 text-pink-800 border-pink-200",ai:"bg-cyan-100 text-cyan-800 border-cyan-200",settings:"bg-gray-100 text-gray-800 border-gray-200"})[s]||"bg-gray-100 text-gray-800 border-gray-200",K=s=>{confirm(`Are you sure you want to delete the permission "${s.name}"?`)&&S.delete(c("admin.permissions.destroy",s.id))};return e.jsxs(Se,{title:"Permission Management",renderHeader:()=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Permission Management"}),e.jsx(C,{href:c("admin.permissions.create"),children:e.jsxs(l,{children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Create Permission"]})})]}),children:[e.jsx(Ce,{title:"Permission Management"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-xl sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"System Permissions"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Manage system permissions and their role assignments. Permissions control what actions users can perform."})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Q,{placeholder:"Search permissions...",value:y,onChange:s=>xe(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(z,{value:v,onValueChange:he,children:[e.jsx(F,{className:"w-40",children:e.jsx(E,{placeholder:"All Modules"})}),e.jsxs(G,{children:[e.jsx(x,{value:"all",children:"All Modules"}),_.map(s=>e.jsx(x,{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))]})]}),e.jsxs(z,{value:w,onValueChange:pe,children:[e.jsx(F,{className:"w-40",children:e.jsx(E,{placeholder:"All Roles"})}),e.jsxs(G,{children:[e.jsx(x,{value:"all",children:"All Roles"}),I.map(s=>e.jsx(x,{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))]})]}),e.jsxs(l,{onClick:we,variant:"outline",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Search"]})]})]}),r.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[r.length," permission(s) selected"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(X,{open:je,onOpenChange:M,children:[e.jsx(Y,{asChild:!0,children:e.jsxs(l,{variant:"outline",size:"sm",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Bulk Actions"]})}),e.jsxs(Z,{children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Bulk Permission Actions"}),e.jsxs(ae,{children:["Perform actions on ",r.length," selected permission(s)."]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Action Type"}),e.jsxs(z,{value:p,onValueChange:s=>ge(s),children:[e.jsx(F,{children:e.jsx(E,{})}),e.jsxs(G,{children:[e.jsx(x,{value:"assign",children:"Assign to Roles"}),e.jsx(x,{value:"remove",children:"Remove from Roles"}),e.jsx(x,{value:"delete",children:"Delete Permissions"})]})]})]}),p!=="delete"&&e.jsxs("div",{children:[e.jsx(m,{children:"Select Roles"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:$.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{id:`role-${s.id}`,checked:b.includes(s.id),onCheckedChange:t=>{R(t?[...b,s.id]:b.filter(a=>a!==s.id))}}),e.jsx(m,{htmlFor:`role-${s.id}`,className:"text-sm",children:s.name})]},s.id))})]})]}),e.jsxs(te,{children:[e.jsx(l,{variant:"outline",onClick:()=>M(!1),children:"Cancel"}),e.jsx(l,{onClick:ye,children:p==="delete"?"Delete":p==="assign"?"Assign":"Remove"})]})]})]}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>d([]),children:"Clear Selection"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{}),e.jsxs(X,{open:ue,onOpenChange:T,children:[e.jsx(Y,{asChild:!0,children:e.jsxs(l,{variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Generate Module Permissions"]})}),e.jsxs(Z,{children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Generate Module Permissions"}),e.jsx(ae,{children:"Quickly create a set of permissions for a new module."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"module-name",children:"Module Name"}),e.jsx(Q,{id:"module-name",value:B,onChange:s=>V(s.target.value),placeholder:"e.g., inventory, reports"})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Actions to Generate"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:fe.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{id:`action-${s}`,checked:k.includes(s),onCheckedChange:t=>{D(t?[...k,s]:k.filter(a=>a!==s))}}),e.jsx(m,{htmlFor:`action-${s}`,className:"text-sm",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Assign to Roles (Optional)"}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:$.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{id:`assign-role-${s.id}`,checked:A.includes(s.name),onCheckedChange:t=>{L(t?[...A,s.name]:A.filter(a=>a!==s.name))}}),e.jsx(m,{htmlFor:`assign-role-${s.id}`,className:"text-sm",children:s.name})]},s.id))})]})]}),e.jsxs(te,{children:[e.jsx(l,{variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsx(l,{onClick:ve,children:"Generate Permissions"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(u,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Permissions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.length})]})]})})}),e.jsx(u,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Modules"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:_.length})]})]})})}),e.jsx(u,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Roles"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:I.length})]})]})})}),e.jsx(u,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ee,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Filtered"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.length})]})]})})})]})]}),e.jsxs(Le,{defaultValue:"grouped",className:"w-full",children:[e.jsxs(ze,{className:"grid w-full grid-cols-2",children:[e.jsx(W,{value:"grouped",children:"Grouped by Module"}),e.jsx(W,{value:"list",children:"List View"})]}),e.jsx(J,{value:"grouped",className:"space-y-6",children:Object.keys(O).length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(U,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100",children:"No permissions found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Try adjusting your search criteria or create a new permission."})]}):Object.entries(O).map(([s,t])=>e.jsxs(u,{children:[e.jsxs(Re,{children:[e.jsxs(Be,{className:"flex items-center gap-2",children:[e.jsx(h,{checked:t.every(a=>r.includes(a.id)),onCheckedChange:a=>{if(a){const n=[...r];t.forEach(j=>{n.includes(j.id)||n.push(j.id)}),d(n)}else d(r.filter(n=>!t.some(j=>j.id===n)))}}),be(s),e.jsxs("span",{className:"capitalize",children:[s," Module"]}),e.jsxs(f,{variant:"outline",className:q(s),children:[t.length," permissions"]})]}),e.jsxs(De,{children:["Permissions for the ",s," module functionality"]})]}),e.jsx(g,{children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:t.map(a=>e.jsx("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx(h,{checked:r.includes(a.id),onCheckedChange:n=>H(a.id,!!n),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ne,{className:"h-4 w-4 text-gray-500"}),e.jsx("h4",{className:"font-medium text-sm",children:a.name})]}),a.description&&e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:a.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:a.roles.length>0?a.roles.map(n=>e.jsx(f,{variant:"secondary",className:"text-xs",children:n.name},n.id)):e.jsx(f,{variant:"outline",className:"text-xs text-gray-500",children:"No roles assigned"})})]}),e.jsxs("div",{className:"flex gap-1 ml-2",children:[e.jsx(C,{href:c("admin.permissions.show",a.id),children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(ce,{className:"h-3 w-3"})})}),e.jsx(C,{href:c("admin.permissions.edit",a.id),children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(de,{className:"h-3 w-3"})})}),!a.name.includes("admin.")&&e.jsx(l,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",onClick:()=>K(a),children:e.jsx(oe,{className:"h-3 w-3"})})]})]})})},a.id))})})]},s))}),e.jsx(J,{value:"list",children:e.jsx(u,{children:e.jsx(g,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider w-12",children:e.jsx(h,{checked:o.length>0&&o.every(s=>r.includes(s.id)),onCheckedChange:Ne})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Permission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Roles"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Module"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:o.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center",children:[e.jsx(U,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100",children:"No permissions found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Try adjusting your search criteria or create a new permission."})]})}):o.map(s=>{const t=s.module||"system";return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(h,{checked:r.includes(s.id),onCheckedChange:a=>H(s.id,!!a)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ne,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("div",{children:e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:s.name})})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 max-w-xs truncate",children:s.description||"No description"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.roles.length>0?s.roles.map(a=>e.jsx(f,{variant:"secondary",className:"text-xs",children:a.name},a.id)):e.jsx(f,{variant:"outline",className:"text-xs text-gray-500",children:"No roles"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(f,{variant:"outline",className:q(t),children:t})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(C,{href:c("admin.permissions.show",s.id),children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(ce,{className:"h-4 w-4"})})}),e.jsx(C,{href:c("admin.permissions.edit",s.id),children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(de,{className:"h-4 w-4"})})}),!s.name.includes("admin.")&&e.jsx(l,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",onClick:()=>K(s),children:e.jsx(oe,{className:"h-4 w-4"})})]})})]},s.id)})})]})})})})})]})]})})})})]})}export{Ws as default};
