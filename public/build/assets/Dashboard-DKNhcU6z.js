import{r as S,j as e,S as z}from"./app-BMIA6nir.js";import{A as Q,U as W,C as Z}from"./AppLayout-DbMk6clK.js";import{C as t,a as i,b as r,d as L,c as n}from"./card-BAsSN-2Z.js";import{B as ee}from"./createLucideIcon-Cg8jdX0w.js";import{T as se,a as ae,b as m,c as x}from"./tabs-YflTNJKH.js";import{B as d}from"./x-C3KwZK3B.js";import{S as T,a as R,b as B,c as A,d as l}from"./select-B6KOX9nY.js";import{t as k}from"./index-Dj2TB_RL.js";import{s as te}from"./index-sFwGSaal.js";import{U as ie}from"./users-3SuyoAg3.js";import{M as re}from"./message-square-32k9udjC.js";import{P as ne}from"./phone-347MTOqH.js";import{R as h,C as D,X as K,Y as $,T as j,L as le,a as U,B as V}from"./generateCategoricalChart-71Idvjih.js";import{L as ce,a as C}from"./LineChart-CiUXfZQg.js";import{T as de}from"./target-DIhftedx.js";import{P as F,a as O}from"./PieChart-CoJ2J4Cg.js";import{B as G}from"./BarChart-DEKLa_g_.js";import{A as oe}from"./activity-BI-t7JT3.js";import{D as me}from"./download-CNZP3fGS.js";import{T as xe}from"./trending-up-00s2SIxN.js";import{T as he}from"./trending-down-nOrQI_re.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./useTranslate-ER5gAOX6.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./bell-5VRgJnzP.js";import"./dollar-sign-Cli0KufN.js";import"./file-text-D25AipK4.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./plus-BjPf5uI-.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";import"./tiny-invariant-BaFNuDhB.js";const p=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"];function us({overview:c,leadMetrics:u,clientMetrics:y,communicationMetrics:E,liveChatMetrics:v,conversionFunnel:_,timeSeriesData:X,topPerformers:q,dateRange:P}){const[H,J]=S.useState("30d"),[w,Y]=S.useState("csv"),[b,I]=S.useState("overview"),M=async()=>{var s;try{const a=await fetch(te("crm.analytics.export"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({format:w,type:b,start_date:P.start,end_date:P.end})});if(a.ok){const f=await a.blob(),N=window.URL.createObjectURL(f),o=document.createElement("a");o.href=N,o.download=`crm_${b}_analytics.${w}`,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(N),document.body.removeChild(o),k.success("Analytics data exported successfully!")}else k.error("Failed to export analytics data")}catch{k.error("An error occurred while exporting data")}},g=({title:s,value:a,growth:f,icon:N,description:o})=>e.jsxs(t,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm font-medium",children:s}),e.jsx(N,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.toLocaleString()}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[f>=0?e.jsx(xe,{className:"h-3 w-3 text-green-500 mr-1"}):e.jsx(he,{className:"h-3 w-3 text-red-500 mr-1"}),e.jsxs("span",{className:f>=0?"text-green-500":"text-red-500",children:[Math.abs(f),"%"]}),e.jsx("span",{className:"ml-1",children:o})]})]})]});return e.jsxs(Q,{title:"CRM Analytics",renderHeader:()=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"CRM Analytics & Reports"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(T,{value:H,onValueChange:J,children:[e.jsx(R,{className:"w-32",children:e.jsx(B,{})}),e.jsxs(A,{children:[e.jsx(l,{value:"7d",children:"Last 7 days"}),e.jsx(l,{value:"30d",children:"Last 30 days"}),e.jsx(l,{value:"90d",children:"Last 90 days"}),e.jsx(l,{value:"1y",children:"Last year"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(T,{value:b,onValueChange:I,children:[e.jsx(R,{className:"w-32",children:e.jsx(B,{})}),e.jsxs(A,{children:[e.jsx(l,{value:"overview",children:"Overview"}),e.jsx(l,{value:"leads",children:"Leads"}),e.jsx(l,{value:"clients",children:"Clients"}),e.jsx(l,{value:"communications",children:"Communications"}),e.jsx(l,{value:"livechat",children:"LiveChat"})]})]}),e.jsxs(T,{value:w,onValueChange:Y,children:[e.jsx(R,{className:"w-20",children:e.jsx(B,{})}),e.jsxs(A,{children:[e.jsx(l,{value:"csv",children:"CSV"}),e.jsx(l,{value:"json",children:"JSON"})]})]}),e.jsxs(ee,{onClick:M,className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),"Export"]})]})]})]}),children:[e.jsx(z,{title:"CRM Analytics"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-8",children:[e.jsx(g,{title:"Total Leads",value:c.totalLeads,growth:c.leadGrowth,icon:W,description:"from last period"}),e.jsx(g,{title:"Total Clients",value:c.totalClients,growth:c.clientGrowth,icon:ie,description:"from last period"}),e.jsx(g,{title:"Communications",value:c.totalCommunications,growth:c.communicationGrowth,icon:re,description:"from last period"}),e.jsx(g,{title:"Conversations",value:c.totalConversations,growth:c.conversationGrowth,icon:ne,description:"from last period"})]}),e.jsxs(se,{defaultValue:"overview",className:"w-full",children:[e.jsxs(ae,{className:"grid w-full grid-cols-6",children:[e.jsx(m,{value:"overview",children:"Overview"}),e.jsx(m,{value:"leads",children:"Leads"}),e.jsx(m,{value:"clients",children:"Clients"}),e.jsx(m,{value:"communications",children:"Communications"}),e.jsx(m,{value:"livechat",children:"LiveChat"}),e.jsx(m,{value:"funnel",children:"Conversion"})]}),e.jsx(x,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(t,{className:"md:col-span-2",children:[e.jsxs(i,{children:[e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),"Activity Over Time"]}),e.jsx(L,{children:"Daily activity trends across all CRM modules"})]}),e.jsx(n,{children:e.jsx(h,{width:"100%",height:300,children:e.jsxs(ce,{data:X,children:[e.jsx(D,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"date"}),e.jsx($,{}),e.jsx(j,{}),e.jsx(le,{}),e.jsx(C,{type:"monotone",dataKey:"leads",stroke:"#8884d8",name:"Leads"}),e.jsx(C,{type:"monotone",dataKey:"clients",stroke:"#82ca9d",name:"Clients"}),e.jsx(C,{type:"monotone",dataKey:"communications",stroke:"#ffc658",name:"Communications"}),e.jsx(C,{type:"monotone",dataKey:"conversations",stroke:"#ff7300",name:"Conversations"})]})})})]}),e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5"}),"Top Performers"]}),e.jsx(L,{children:"Most active team members"})]}),e.jsx(n,{children:e.jsx("div",{className:"space-y-3",children:q.topSalesUsers.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"outline",className:"w-6 h-6 p-0 flex items-center justify-center",children:a+1}),e.jsx("span",{className:"font-medium",children:s.name})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.communications_count," communications"]})]},s.name))})})]})]})}),e.jsx(x,{value:"leads",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(r,{children:"Leads by Status"})}),e.jsx(n,{children:e.jsx(h,{width:"100%",height:300,children:e.jsxs(F,{children:[e.jsx(O,{data:u.leadsByStatus,cx:"50%",cy:"50%",labelLine:!1,label:({status:s,count:a})=>`${s}: ${a}`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:u.leadsByStatus.map((s,a)=>e.jsx(U,{fill:p[a%p.length]},`cell-${a}`))}),e.jsx(j,{})]})})})]}),e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(r,{children:"Leads by Source"})}),e.jsx(n,{children:e.jsx(h,{width:"100%",height:300,children:e.jsxs(G,{data:u.leadsBySource,children:[e.jsx(D,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"source"}),e.jsx($,{}),e.jsx(j,{}),e.jsx(V,{dataKey:"count",fill:"#8884d8"})]})})})]}),e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(r,{children:"Lead Metrics"})}),e.jsxs(n,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Conversion Rate"}),e.jsxs(d,{variant:"secondary",children:[u.conversionRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Avg. Time to Conversion"}),e.jsxs(d,{variant:"secondary",children:[u.averageTimeToConversion," days"]})]})]})]})]})}),e.jsx(x,{value:"clients",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(r,{children:"Clients by Status"})}),e.jsx(n,{children:e.jsx(h,{width:"100%",height:300,children:e.jsxs(F,{children:[e.jsx(O,{data:y.clientsByStatus,cx:"50%",cy:"50%",labelLine:!1,label:({status:s,count:a})=>`${s}: ${a}`,outerRadius:80,fill:"#82ca9d",dataKey:"count",children:y.clientsByStatus.map((s,a)=>e.jsx(U,{fill:p[a%p.length]},`cell-${a}`))}),e.jsx(j,{})]})})})]}),e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(r,{children:"Client Metrics"})}),e.jsxs(n,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Retention Rate"}),e.jsxs(d,{variant:"secondary",children:[y.clientRetentionRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Avg. Client Value"}),e.jsxs(d,{variant:"secondary",children:["$",y.averageClientValue]})]})]})]})]})}),e.jsx(x,{value:"communications",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(r,{children:"Communications by Type"})}),e.jsx(n,{children:e.jsx(h,{width:"100%",height:300,children:e.jsxs(G,{data:E.communicationsByType,children:[e.jsx(D,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"type"}),e.jsx($,{}),e.jsx(j,{}),e.jsx(V,{dataKey:"count",fill:"#ffc658"})]})})})]}),e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(r,{children:"Communications by User"})}),e.jsx(n,{children:e.jsx("div",{className:"space-y-3",children:E.communicationsByUser.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx(d,{variant:"outline",children:s.count})]},s.name))})})]})]})}),e.jsx(x,{value:"livechat",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(r,{children:"Conversations by Status"})}),e.jsx(n,{children:e.jsx(h,{width:"100%",height:300,children:e.jsxs(F,{children:[e.jsx(O,{data:v.conversationsByStatus,cx:"50%",cy:"50%",labelLine:!1,label:({status:s,count:a})=>`${s}: ${a}`,outerRadius:80,fill:"#ff7300",dataKey:"count",children:v.conversationsByStatus.map((s,a)=>e.jsx(U,{fill:p[a%p.length]},`cell-${a}`))}),e.jsx(j,{})]})})})]}),e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(r,{children:"LiveChat Metrics"})}),e.jsxs(n,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Avg. Conversation Length"}),e.jsxs(d,{variant:"secondary",children:[v.averageConversationLength," messages"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Customer Satisfaction"}),e.jsxs(d,{variant:"secondary",children:[v.customerSatisfactionScore,"/5"]})]})]})]})]})}),e.jsx(x,{value:"funnel",className:"space-y-6",children:e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5"}),"Conversion Funnel"]}),e.jsx(L,{children:"Track the customer journey from lead to active client"})]}),e.jsx(n,{children:e.jsx("div",{className:"space-y-4",children:_.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 text-sm font-medium",children:s.stage}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${s.percentage}%`}})}),e.jsxs("div",{className:"text-sm text-muted-foreground w-16",children:[s.percentage,"%"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[s.count," ",s.stage.toLowerCase()]})]})]},s.stage))})})]})})]})]})})]})}export{us as default};
