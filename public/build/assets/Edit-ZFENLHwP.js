import{r as B,G as O,j as e,S as q,x as I}from"./app-BMIA6nir.js";import{A as R}from"./AppLayout-DbMk6clK.js";import{C as u,a as j,b as y,c as _,d as $}from"./card-BAsSN-2Z.js";import{B as f}from"./createLucideIcon-Cg8jdX0w.js";import{I as b}from"./input-Bg5GDATO.js";import{L as l}from"./label-CM6YsqH1.js";import{T as z}from"./textarea-CP26afIU.js";import{S as o,a as m,b as p,c as h,d}from"./select-B6KOX9nY.js";import{u as G}from"./useTranslate-ER5gAOX6.js";import{t as A}from"./index-Dj2TB_RL.js";import{A as H}from"./arrow-left-UX2kDF52.js";import{C as M}from"./NotificationComponent-CHA3vjZG.js";import{U as J}from"./x-C3KwZK3B.js";import{F as K}from"./file-text-D25AipK4.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./dollar-sign-Cli0KufN.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./plus-BjPf5uI-.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";import"./bell-5VRgJnzP.js";function ze({payment:i,accounts:w,invoices:v,clients:P,leads:E,paymentMethods:T,statuses:D}){var C,F;const{t}=G(),[x,g]=B.useState(i.invoice||null),{data:a,setData:r,put:V,processing:N,errors:s}=O({account_id:i.account_id.toString(),payable_type:i.payable_type||"",payable_id:((C=i.payable_id)==null?void 0:C.toString())||"",invoice_id:((F=i.invoice_id)==null?void 0:F.toString())||"",amount:i.amount.toString(),payment_date:i.payment_date,payment_method:i.payment_method,reference_number:i.reference_number||"",status:i.status,notes:i.notes||""}),L=n=>{const c=v.find(k=>k.id.toString()===n);c?(g(c),r({...a,invoice_id:n,amount:c.total_amount.toString(),payable_type:"client",payable_id:c.billable.id.toString()})):(g(null),r({...a,invoice_id:"",payable_type:a.payable_type,payable_id:a.payable_id}))},U=n=>{n.preventDefault(),V(route("finance.payments.update",i.id),{onSuccess:()=>{A.success(t("finance.payment_updated","Payment updated successfully"))},onError:()=>{A.error(t("common.error_occurred","An error occurred"))}})},S=(n,c="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:c}).format(n);return e.jsxs(R,{title:t("finance.edit_payment","Edit Payment"),breadcrumbs:[{label:t("finance.title","Finance"),href:"/finance"},{label:t("finance.payments","Payments"),href:"/finance/payments"},{label:i.payment_number,href:`/finance/payments/${i.id}`},{label:t("common.edit","Edit")}],children:[e.jsx(q,{title:t("finance.edit_payment","Edit Payment")}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(I,{href:route("finance.payments.show",i.id),children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),t("common.back","Back")]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:t("finance.edit_payment","Edit Payment")}),e.jsxs("p",{className:"text-muted-foreground",children:[t("finance.edit_payment_description","Update payment information")," - ",i.payment_number]})]})]}),e.jsxs("form",{onSubmit:U,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(u,{children:[e.jsx(j,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),t("finance.payment_details","Payment Details")]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"account_id",children:[t("finance.account","Account")," *"]}),e.jsxs(o,{value:a.account_id,onValueChange:n=>r("account_id",n),children:[e.jsx(m,{children:e.jsx(p,{placeholder:t("finance.select_account","Select account")})}),e.jsx(h,{children:w.map(n=>e.jsx(d,{value:n.id.toString(),children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.type," - ",n.currency]})]})},n.id))})]}),s.account_id&&e.jsx("p",{className:"text-sm text-red-600",children:s.account_id})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"payment_date",children:[t("finance.payment_date","Payment Date")," *"]}),e.jsx(b,{id:"payment_date",type:"date",value:a.payment_date,onChange:n=>r("payment_date",n.target.value),required:!0}),s.payment_date&&e.jsx("p",{className:"text-sm text-red-600",children:s.payment_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"payment_method",children:[t("finance.payment_method","Payment Method")," *"]}),e.jsxs(o,{value:a.payment_method,onValueChange:n=>r("payment_method",n),children:[e.jsx(m,{children:e.jsx(p,{placeholder:t("finance.select_method","Select method")})}),e.jsx(h,{children:Object.entries(T).map(([n,c])=>e.jsx(d,{value:n,children:c},n))})]}),s.payment_method&&e.jsx("p",{className:"text-sm text-red-600",children:s.payment_method})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"amount",children:[t("finance.amount","Amount")," *"]}),e.jsx(b,{id:"amount",type:"number",min:"0",step:"0.01",placeholder:"0.00",value:a.amount,onChange:n=>r("amount",n.target.value),required:!0}),s.amount&&e.jsx("p",{className:"text-sm text-red-600",children:s.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"status",children:[t("common.status","Status")," *"]}),e.jsxs(o,{value:a.status,onValueChange:n=>r("status",n),children:[e.jsx(m,{children:e.jsx(p,{})}),e.jsx(h,{children:Object.entries(D).map(([n,c])=>e.jsx(d,{value:n,children:c},n))})]}),s.status&&e.jsx("p",{className:"text-sm text-red-600",children:s.status})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"reference_number",children:t("finance.reference_number","Reference Number")}),e.jsx(b,{id:"reference_number",placeholder:t("finance.reference_placeholder","Transaction reference..."),value:a.reference_number,onChange:n=>r("reference_number",n.target.value)}),s.reference_number&&e.jsx("p",{className:"text-sm text-red-600",children:s.reference_number})]})]})]}),e.jsxs(u,{children:[e.jsxs(j,{children:[e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),t("finance.invoice_client_details","Invoice & Client Details")]}),e.jsx($,{children:t("finance.optional_invoice_link","Optionally link this payment to an invoice")})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"invoice_id",children:t("finance.invoice","Invoice")}),e.jsxs(o,{value:a.invoice_id,onValueChange:L,children:[e.jsx(m,{children:e.jsx(p,{placeholder:t("finance.select_invoice","Select invoice (optional)")})}),e.jsxs(h,{children:[e.jsx(d,{value:"none",children:t("finance.no_invoice","No invoice")}),v.map(n=>e.jsx(d,{value:n.id.toString(),children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.invoice_number}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.billable.name," - ",S(n.total_amount,n.currency)]})]})},n.id))]})]}),s.invoice_id&&e.jsx("p",{className:"text-sm text-red-600",children:s.invoice_id})]}),!a.invoice_id&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"payable_type",children:t("finance.client_type","Client Type")}),e.jsxs(o,{value:a.payable_type,onValueChange:n=>{r("payable_type",n),r("payable_id","")},children:[e.jsx(m,{children:e.jsx(p,{placeholder:t("finance.select_client_type","Select client type")})}),e.jsxs(h,{children:[e.jsx(d,{value:"none",children:t("finance.no_client","No client")}),e.jsx(d,{value:"client",children:t("crm.client","Client")}),e.jsx(d,{value:"lead",children:t("crm.lead","Lead")})]})]}),s.payable_type&&e.jsx("p",{className:"text-sm text-red-600",children:s.payable_type})]}),a.payable_type&&a.payable_type!=="none"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"payable_id",children:a.payable_type==="client"?t("crm.client","Client"):t("crm.lead","Lead")}),e.jsxs(o,{value:a.payable_id,onValueChange:n=>r("payable_id",n),children:[e.jsx(m,{children:e.jsx(p,{placeholder:`Select ${a.payable_type}`})}),e.jsx(h,{children:(a.payable_type==="client"?P:E).map(n=>e.jsx(d,{value:n.id.toString(),children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n.email})]})},n.id))})]}),s.payable_id&&e.jsx("p",{className:"text-sm text-red-600",children:s.payable_id})]})]}),x&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),t("finance.selected_invoice","Selected Invoice")]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[t("finance.invoice_number","Invoice #"),":"]})," ",x.invoice_number]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("finance.client","Client"),":"]})," ",x.billable.name]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("finance.amount","Amount"),":"]})," ",S(x.total_amount,x.currency)]})]})]})]})]})]}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(y,{children:t("finance.additional_information","Additional Information")})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"notes",children:t("finance.notes","Notes")}),e.jsx(z,{id:"notes",placeholder:t("finance.payment_notes_placeholder","Add any notes about this payment..."),value:a.notes,onChange:n=>r("notes",n.target.value),rows:3}),s.notes&&e.jsx("p",{className:"text-sm text-red-600",children:s.notes})]})})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(f,{type:"button",variant:"outline",asChild:!0,children:e.jsx(I,{href:route("finance.payments.show",i.id),children:t("common.cancel","Cancel")})}),e.jsx(f,{type:"submit",disabled:N,children:N?t("common.saving","Saving..."):t("finance.update_payment","Update Payment")})]})]})]})]})}export{ze as default};
