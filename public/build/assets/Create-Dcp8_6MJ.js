import{r as C,j as e,G as z,S as U,x as B}from"./app-BMIA6nir.js";import{A as q,R as G}from"./AppLayout-DbMk6clK.js";import{C as N,a as v,b as y,d as I,c as _}from"./card-BAsSN-2Z.js";import{B as x}from"./createLucideIcon-Cg8jdX0w.js";import{I as j}from"./input-Bg5GDATO.js";import{L as i}from"./label-CM6YsqH1.js";import{T as k}from"./textarea-CP26afIU.js";import{S as A,a as E,b as D,c as T,d as g}from"./select-B6KOX9nY.js";import{u as L}from"./useTranslate-ER5gAOX6.js";import{X as $,B as H}from"./x-C3KwZK3B.js";import{A as X,a as J}from"./alert-CNp8ZuHk.js";import{u as Y}from"./useFinanceAI-oMHKJO8s.js";import{B as V}from"./bot-COuCQh0r.js";import{S as K}from"./sparkles-Csmgo_ih.js";import{F as Q}from"./file-text-D25AipK4.js";import{C as W}from"./circle-alert-DVIk47WR.js";import{C as Z}from"./circle-check-big-DCsv6rXk.js";import{C as ee}from"./copy-XqgUo3o3.js";import{t as R}from"./index-Dj2TB_RL.js";import{A as se}from"./arrow-left-UX2kDF52.js";import{T as te}from"./trending-up-00s2SIxN.js";import{D as re}from"./dollar-sign-Cli0KufN.js";import{B as ae}from"./building-DIkCZBBP.js";import{U as ie}from"./upload-DoO0wQwa.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./bell-5VRgJnzP.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./plus-BjPf5uI-.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";function ne({onExpenseDataExtracted:p,onClose:m}){L();const{processReceipt:b,loading:t}=Y(),[o,w]=C.useState(""),[a,h]=C.useState(null),n=async()=>{if(!o.trim())return;const r=await b(o);r&&h(r)},c=()=>{a&&(p(a),m())},S=r=>r>=.8?"bg-green-100 text-green-800":r>=.6?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",f=r=>r>=.8?"High":r>=.6?"Medium":"Low";return e.jsxs(N,{className:"border-purple-200 bg-purple-50/50",children:[e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-purple-600"}),e.jsx(y,{className:"text-purple-700",children:"AI Receipt Processor"})]}),e.jsx(x,{variant:"ghost",size:"sm",onClick:m,className:"h-6 w-6 p-0 text-purple-600 hover:text-purple-800",children:e.jsx($,{className:"h-4 w-4"})})]}),e.jsx(I,{children:"Extract expense information from receipt text using AI"})]}),e.jsxs(_,{className:"space-y-4",children:[a?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Expense Data Extracted"}),e.jsxs(H,{className:S(a.confidence),variant:"secondary",children:[f(a.confidence)," (",Math.round(a.confidence*100),"%)"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-muted-foreground",children:"Title"}),e.jsx("p",{className:"font-medium",children:a.title})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-muted-foreground",children:"Amount"}),e.jsxs("p",{className:"font-medium",children:["$",a.amount.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-muted-foreground",children:"Vendor"}),e.jsx("p",{className:"font-medium",children:a.vendor||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-muted-foreground",children:"Date"}),e.jsx("p",{className:"font-medium",children:a.expense_date})]})]}),a.description&&e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-muted-foreground",children:"Description"}),e.jsx("p",{className:"text-sm",children:a.description})]}),a.suggested_category&&e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-muted-foreground",children:"Suggested Category"}),e.jsx("p",{className:"text-sm",children:a.suggested_category})]}),a.items&&a.items.length>0&&e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-muted-foreground",children:"Items"}),e.jsx("div",{className:"space-y-1",children:a.items.map((r,F)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:r.description}),e.jsxs("span",{children:["$",r.amount.toFixed(2)]})]},F))})]}),a.tax_amount>0&&e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-muted-foreground",children:"Tax Amount"}),e.jsxs("p",{className:"text-sm",children:["$",a.tax_amount.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(x,{onClick:c,className:"flex-1",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Apply to Form"]}),e.jsx(x,{variant:"outline",onClick:()=>h(null),children:"Try Again"})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"receipt-text",children:"Receipt Text"}),e.jsx(k,{id:"receipt-text",placeholder:"Paste or type the text from your receipt here...",value:o,onChange:r=>w(r.target.value),rows:6,className:"resize-none"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"You can copy text from a digital receipt or type the information manually"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(x,{onClick:n,disabled:!o.trim()||t,className:"flex-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Process Receipt"]})})}),e.jsxs(X,{children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx(J,{className:"text-sm",children:"The AI will extract vendor name, amount, date, and other expense details from your receipt text."})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center pt-2 border-t",children:"Powered by Mistral AI"})]})]})}function ls({accounts:p=[],categories:m=[],statuses:b={}}){const{t}=L(),[o,w]=C.useState(null),[a,h]=C.useState(!1),{data:n,setData:c,post:S,processing:f,errors:r}=z({account_id:"",category_id:"none",title:"",description:"",amount:"",expense_date:new Date().toISOString().split("T")[0],vendor:"",status:"draft",receipt:null}),F=s=>{var d;const l=((d=s.target.files)==null?void 0:d[0])||null;w(l),c("receipt",l)},M=s=>{s.preventDefault();const l=new FormData;Object.entries(n).forEach(([d,u])=>{u!=null&&(d==="receipt"&&u instanceof File?l.append(d,u):l.append(d,u.toString()))}),S(route("finance.expenses.store"),{data:l,forceFormData:!0,onSuccess:()=>{R.success(t("finance.expense_created","Expense created successfully"))},onError:()=>{R.error(t("common.error_occurred","An error occurred"))}})},P=p.find(s=>s.id.toString()===n.account_id),O=s=>{if(c({...n,title:s.title,description:s.description,amount:s.amount.toString(),vendor:s.vendor,expense_date:s.expense_date}),s.suggested_category){const l=m.find(d=>d.name.toLowerCase().includes(s.suggested_category.toLowerCase()));l&&c(d=>({...d,category_id:l.id.toString()}))}R.success("Expense data applied from receipt!")};return e.jsxs(q,{title:t("finance.add_expense","Add Expense"),breadcrumbs:[{label:t("finance.title","Finance"),href:"/finance"},{label:t("finance.expenses","Expenses"),href:"/finance/expenses"},{label:t("finance.add_expense","Add Expense")}],children:[e.jsx(U,{title:t("finance.add_expense","Add Expense")}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(B,{href:route("finance.expenses.index"),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),t("common.back","Back")]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:t("finance.add_expense","Add Expense")}),e.jsx("p",{className:"text-muted-foreground",children:t("finance.add_expense_description","Record a new business expense")})]})]}),e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[a&&e.jsx(ne,{onExpenseDataExtracted:O,onClose:()=>h(!1)}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs(x,{type:"button",variant:"outline",onClick:()=>h(!0),className:"text-purple-600 border-purple-200 hover:bg-purple-50",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Process Receipt with AI"]})}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(N,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),t("finance.expense_details","Expense Details")]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"title",children:[t("finance.title","Title")," *"]}),e.jsx(j,{id:"title",placeholder:t("finance.expense_title_placeholder","Enter expense title..."),value:n.title,onChange:s=>c("title",s.target.value),required:!0}),r.title&&e.jsx("p",{className:"text-sm text-red-600",children:r.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"description",children:t("finance.description","Description")}),e.jsx(k,{id:"description",placeholder:t("finance.expense_description_placeholder","Describe the expense..."),value:n.description,onChange:s=>c("description",s.target.value),rows:3}),r.description&&e.jsx("p",{className:"text-sm text-red-600",children:r.description})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"amount",children:[t("finance.amount","Amount")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(j,{id:"amount",type:"number",min:"0",step:"0.01",placeholder:"0.00",value:n.amount,onChange:s=>c("amount",s.target.value),className:"pl-8",required:!0})]}),P&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Currency: ",P.currency]}),r.amount&&e.jsx("p",{className:"text-sm text-red-600",children:r.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"expense_date",children:[t("finance.expense_date","Expense Date")," *"]}),e.jsx(j,{id:"expense_date",type:"date",value:n.expense_date,onChange:s=>c("expense_date",s.target.value),required:!0}),r.expense_date&&e.jsx("p",{className:"text-sm text-red-600",children:r.expense_date})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"vendor",children:t("finance.vendor","Vendor")}),e.jsx(j,{id:"vendor",placeholder:t("finance.vendor_placeholder","Vendor or supplier name..."),value:n.vendor,onChange:s=>c("vendor",s.target.value)}),r.vendor&&e.jsx("p",{className:"text-sm text-red-600",children:r.vendor})]})]})]}),e.jsxs(N,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),t("finance.account_category","Account & Category")]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"account_id",children:[t("finance.account","Account")," *"]}),e.jsxs(A,{value:n.account_id,onValueChange:s=>c("account_id",s),children:[e.jsx(E,{children:e.jsx(D,{placeholder:t("finance.select_account","Select account")})}),e.jsx(T,{children:(p==null?void 0:p.map(s=>e.jsx(g,{value:s.id.toString(),children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.type," - ",s.currency]})]})},s.id)))||[]})]}),r.account_id&&e.jsx("p",{className:"text-sm text-red-600",children:r.account_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"category_id",children:t("finance.category","Category")}),e.jsxs(A,{value:n.category_id,onValueChange:s=>c("category_id",s),children:[e.jsx(E,{children:e.jsx(D,{placeholder:t("finance.select_category","Select category (optional)")})}),e.jsxs(T,{children:[e.jsx(g,{value:"none",children:t("finance.no_category","No category")}),(m==null?void 0:m.map(s=>e.jsx(g,{value:s.id.toString(),children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})},s.id)))||[]]})]}),r.category_id&&e.jsx("p",{className:"text-sm text-red-600",children:r.category_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"status",children:[t("common.status","Status")," *"]}),e.jsxs(A,{value:n.status,onValueChange:s=>c("status",s),children:[e.jsx(E,{children:e.jsx(D,{})}),e.jsx(T,{children:Object.entries(b||{}).map(([s,l])=>e.jsx(g,{value:s,children:l},s))})]}),r.status&&e.jsx("p",{className:"text-sm text-red-600",children:r.status})]})]})]})]}),e.jsxs(N,{children:[e.jsxs(v,{children:[e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),t("finance.receipt","Receipt")]}),e.jsx(I,{children:t("finance.receipt_description","Upload a receipt or supporting document for this expense")})]}),e.jsx(_,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"receipt",children:t("finance.receipt_file","Receipt File")}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(j,{id:"receipt",type:"file",accept:"image/*,.pdf,.doc,.docx",onChange:F,className:"flex-1"}),e.jsx(ie,{className:"h-4 w-4 text-muted-foreground"})]}),o&&e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium",children:o.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(o.size/1024/1024).toFixed(2)," MB"]})]}),r.receipt&&e.jsx("p",{className:"text-sm text-red-600",children:r.receipt}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("finance.receipt_formats","Supported formats: JPG, PNG, PDF, DOC, DOCX (Max 10MB)")})]})})})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(x,{type:"button",variant:"outline",asChild:!0,children:e.jsx(B,{href:route("finance.expenses.index"),children:t("common.cancel","Cancel")})}),e.jsx(x,{type:"submit",disabled:f,children:f?t("common.saving","Saving..."):t("finance.add_expense","Add Expense")})]})]})]})]})}export{ls as default};
