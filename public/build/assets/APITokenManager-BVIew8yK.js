import{j as e,u as L,G as y,r as N}from"./app-BMIA6nir.js";import{c as m,M as _,S as E,T as O,I as R,A as z,D as l,a as k}from"./SecondaryButton-CpjXw7yt.js";import{A as G}from"./ActionMessage-BHW7rjd8.js";import{D as W}from"./DangerButton-Dwjq3RFS.js";import{I as S}from"./InputLabel-BJTiKGWD.js";import{P as h}from"./PrimaryButton-DpJmRNkC.js";import{u as Y}from"./useTypedPage-hmuARwun.js";import"./transition-Dyv_LKQb.js";import"./with-selector-CvGlte-K.js";function A(a){return e.jsx("input",{type:"checkbox",...a,className:m("rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500",a.className)})}u.Content=function({title:n,children:o}){return e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("svg",{className:"h-6 w-6 text-red-600",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:n}),e.jsx("div",{className:"mt-4 text-sm text-gray-600",children:o})]})]})})};u.Footer=function({children:n}){return e.jsx("div",{className:"px-6 py-4 bg-gray-100 text-right",children:n})};function u({children:a,...n}){return e.jsx(_,{...n,children:a})}function q({onSubmit:a,renderActions:n,title:o,description:c,children:t}){const r=!!n;return e.jsxs("div",{className:"md:grid md:grid-cols-3 md:gap-6",children:[e.jsx(E,{title:o,description:c}),e.jsx("div",{className:"mt-5 md:mt-0 md:col-span-2",children:e.jsxs("form",{onSubmit:d=>{d.preventDefault(),a()},children:[e.jsx("div",{className:m("px-4 py-5 bg-white sm:p-6 shadow",r?"sm:rounded-tl-md sm:rounded-tr-md":"sm:rounded-md"),children:e.jsx("div",{className:"grid grid-cols-6 gap-6",children:t})}),r&&e.jsx("div",{className:"flex items-center justify-end px-4 py-3 bg-gray-50 text-right sm:px-6 shadow sm:rounded-bl-md sm:rounded-br-md",children:n==null?void 0:n()})]})})]})}function H(){return e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"border-t border-gray-200"})})})}function se({tokens:a,availablePermissions:n,defaultPermissions:o}){var C,T,b;const c=L(),t=y({name:"",permissions:o}),r=y({permissions:[]}),d=y({}),[D,g]=N.useState(!1),[j,x]=N.useState(null),[f,p]=N.useState(null),w=Y();function F(){t.post(c("api-tokens.store"),{preserveScroll:!0,onSuccess:()=>{g(!0),t.reset()}})}function P(s){r.setData("permissions",s.abilities),x(s)}function I(){j&&r.put(c("api-tokens.update",[j]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>x(null)})}function M(s){p(s)}function B(){f&&d.delete(c("api-tokens.destroy",[f]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>p(null)})}return e.jsxs("div",{children:[e.jsxs(q,{onSubmit:F,title:"Create API Token",description:"API tokens allow third-party services to authenticate with our application on your behalf.",renderActions:()=>e.jsxs(e.Fragment,{children:[e.jsx(G,{on:t.recentlySuccessful,className:"mr-3",children:"Created."}),e.jsx(h,{className:m({"opacity-25":t.processing}),disabled:t.processing,children:"Create"})]}),children:[e.jsxs("div",{className:"col-span-6 sm:col-span-4",children:[e.jsx(S,{htmlFor:"name",children:"Name"}),e.jsx(O,{id:"name",type:"text",className:"mt-1 block w-full",value:t.data.name,onChange:s=>t.setData("name",s.currentTarget.value),autoFocus:!0}),e.jsx(R,{message:t.errors.name,className:"mt-2"})]}),n.length>0&&e.jsxs("div",{className:"col-span-6",children:[e.jsx(S,{htmlFor:"permissions",children:"Permissions"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(s=>e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx(A,{value:s,checked:t.data.permissions.includes(s),onChange:i=>{t.data.permissions.includes(i.currentTarget.value)?t.setData("permissions",t.data.permissions.filter(v=>v!==i.currentTarget.value)):t.setData("permissions",[i.currentTarget.value,...t.data.permissions])}}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:s})]})},s))})]})]}),a.length>0?e.jsxs("div",{children:[e.jsx(H,{}),e.jsx("div",{className:"mt-10 sm:mt-0",children:e.jsx(z,{title:"Manage API Tokens",description:"You may delete any of your existing tokens if they are no longer needed.",children:e.jsx("div",{className:"space-y-6",children:a.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"break-all",children:s.name}),e.jsxs("div",{className:"flex items-center",children:[s.last_used_ago&&e.jsxs("div",{className:"text-sm text-gray-400",children:["Last used ",s.last_used_ago]}),n.length>0?e.jsx(h,{className:"cursor-pointer ml-6 text-sm text-gray-400 underline",onClick:()=>P(s),children:"Permissions"}):null,e.jsx(h,{className:"cursor-pointer ml-6 text-sm text-red-500",onClick:()=>M(s),children:"Delete"})]})]},s.id))})})})]}):null,e.jsxs(l,{isOpen:D,onClose:()=>g(!1),children:[e.jsxs(l.Content,{title:"API Token",children:[e.jsx("div",{children:"Please copy your new API token. For your security, it won't be shown again."}),e.jsx("div",{className:"mt-4 bg-gray-100 px-4 py-2 rounded font-mono text-sm text-gray-500",children:(b=(T=(C=w.props)==null?void 0:C.jetstream)==null?void 0:T.flash)==null?void 0:b.token})]}),e.jsx(l.Footer,{children:e.jsx(k,{onClick:()=>g(!1),children:"Close"})})]}),e.jsxs(l,{isOpen:!!j,onClose:()=>x(null),children:[e.jsx(l.Content,{title:"API Token Permissions",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(s=>e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx(A,{value:s,checked:r.data.permissions.includes(s),onChange:i=>{r.data.permissions.includes(i.currentTarget.value)?r.setData("permissions",r.data.permissions.filter(v=>v!==i.currentTarget.value)):r.setData("permissions",[i.currentTarget.value,...r.data.permissions])}}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:s})]})},s))})}),e.jsxs(l.Footer,{children:[e.jsx(k,{onClick:()=>x(null),children:"Cancel"}),e.jsx(h,{onClick:I,className:m("ml-2",{"opacity-25":r.processing}),disabled:r.processing,children:"Save"})]})]}),e.jsxs(u,{isOpen:!!f,onClose:()=>p(null),children:[e.jsx(u.Content,{title:"Delete API Token",children:"Are you sure you would like to delete this API token?"}),e.jsxs(u.Footer,{children:[e.jsx(k,{onClick:()=>p(null),children:"Cancel"}),e.jsx(W,{onClick:B,className:m("ml-2",{"opacity-25":d.processing}),disabled:d.processing,children:"Delete"})]})]})]})}export{se as default};
