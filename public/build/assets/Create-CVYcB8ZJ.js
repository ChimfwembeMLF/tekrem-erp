import{r as k,G as O,j as e,S as U,x as F}from"./app-BMIA6nir.js";import{A as B}from"./AppLayout-DbMk6clK.js";import{C as u,a as y,b as f,c as _,d as E}from"./card-BAsSN-2Z.js";import{B as b}from"./createLucideIcon-Cg8jdX0w.js";import{I as v}from"./input-Bg5GDATO.js";import{L as c}from"./label-CM6YsqH1.js";import{T as q}from"./textarea-CP26afIU.js";import{S as m,a as o,b as p,c as x,d as l}from"./select-B6KOX9nY.js";import{u as z}from"./useTranslate-ER5gAOX6.js";import{t as I}from"./index-Dj2TB_RL.js";import{A as G}from"./arrow-left-UX2kDF52.js";import{C as H}from"./NotificationComponent-CHA3vjZG.js";import{U as M}from"./x-C3KwZK3B.js";import{F as $}from"./file-text-D25AipK4.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./dollar-sign-Cli0KufN.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./plus-BjPf5uI-.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";import"./bell-5VRgJnzP.js";function qe({accounts:j=[],invoices:d=[],clients:A=[],leads:P=[],paymentMethods:w={},statuses:T={}}){var C;const{t:a}=z(),[h,g]=k.useState(null),{data:s,setData:r,post:D,processing:N,errors:t}=O({account_id:"",payable_type:"",payable_id:"",invoice_id:"",amount:"",payment_date:new Date().toISOString().split("T")[0],payment_method:"",reference_number:"",status:"completed",notes:""}),R=n=>{if(n==="none"){g(null),r({...s,invoice_id:"",amount:"",payable_type:"",payable_id:""});return}const i=d==null?void 0:d.find(L=>L.id.toString()===n);i&&(g(i),r({...s,invoice_id:n,amount:i.total_amount.toString(),payable_type:"client",payable_id:i.billable.id.toString()}))},V=n=>{n.preventDefault(),D(route("finance.payments.store"),{onSuccess:()=>{I.success(a("finance.payment_recorded","Payment recorded successfully"))},onError:()=>{I.error(a("common.error_occurred","An error occurred"))}})},S=(n,i="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:i}).format(n);return e.jsxs(B,{title:a("finance.record_payment","Record Payment"),breadcrumbs:[{label:a("finance.title","Finance"),href:"/finance"},{label:a("finance.payments","Payments"),href:"/finance/payments"},{label:a("finance.record_payment","Record Payment")}],children:[e.jsx(U,{title:a("finance.record_payment","Record Payment")}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(F,{href:route("finance.payments.index"),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),a("common.back","Back")]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:a("finance.record_payment","Record Payment")}),e.jsx("p",{className:"text-muted-foreground",children:a("finance.record_payment_description","Record a new payment transaction")})]})]}),e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(u,{children:[e.jsx(y,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),a("finance.payment_details","Payment Details")]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"account_id",children:[a("finance.account","Account")," *"]}),e.jsxs(m,{value:s.account_id,onValueChange:n=>r("account_id",n),children:[e.jsx(o,{children:e.jsx(p,{placeholder:a("finance.select_account","Select account")})}),e.jsx(x,{children:(j==null?void 0:j.map(n=>e.jsx(l,{value:n.id.toString(),children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.type," - ",n.currency]})]})},n.id)))||[]})]}),t.account_id&&e.jsx("p",{className:"text-sm text-red-600",children:t.account_id})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"payment_date",children:[a("finance.payment_date","Payment Date")," *"]}),e.jsx(v,{id:"payment_date",type:"date",value:s.payment_date,onChange:n=>r("payment_date",n.target.value),required:!0}),t.payment_date&&e.jsx("p",{className:"text-sm text-red-600",children:t.payment_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"payment_method",children:[a("finance.payment_method","Payment Method")," *"]}),e.jsxs(m,{value:s.payment_method,onValueChange:n=>r("payment_method",n),children:[e.jsx(o,{children:e.jsx(p,{placeholder:a("finance.select_method","Select method")})}),e.jsx(x,{children:Object.entries(w||{}).map(([n,i])=>e.jsx(l,{value:n,children:i},n))})]}),t.payment_method&&e.jsx("p",{className:"text-sm text-red-600",children:t.payment_method})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"amount",children:[a("finance.amount","Amount")," *"]}),e.jsx(v,{id:"amount",type:"number",min:"0",step:"0.01",placeholder:"0.00",value:s.amount,onChange:n=>r("amount",n.target.value),required:!0}),t.amount&&e.jsx("p",{className:"text-sm text-red-600",children:t.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"status",children:[a("common.status","Status")," *"]}),e.jsxs(m,{value:s.status,onValueChange:n=>r("status",n),children:[e.jsx(o,{children:e.jsx(p,{})}),e.jsx(x,{children:Object.entries(T||{}).map(([n,i])=>e.jsx(l,{value:n,children:i},n))})]}),t.status&&e.jsx("p",{className:"text-sm text-red-600",children:t.status})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"reference_number",children:a("finance.reference_number","Reference Number")}),e.jsx(v,{id:"reference_number",placeholder:a("finance.reference_placeholder","Transaction reference..."),value:s.reference_number,onChange:n=>r("reference_number",n.target.value)}),t.reference_number&&e.jsx("p",{className:"text-sm text-red-600",children:t.reference_number})]})]})]}),e.jsxs(u,{children:[e.jsxs(y,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),a("finance.invoice_client_details","Invoice & Client Details")]}),e.jsx(E,{children:a("finance.optional_invoice_link","Optionally link this payment to an invoice")})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"invoice_id",children:a("finance.invoice","Invoice")}),e.jsxs(m,{value:s.invoice_id,onValueChange:R,children:[e.jsx(o,{children:e.jsx(p,{placeholder:a("finance.select_invoice","Select invoice (optional)")})}),e.jsxs(x,{children:[e.jsx(l,{value:"none",children:a("finance.no_invoice","No invoice")}),(d==null?void 0:d.map(n=>e.jsx(l,{value:n.id.toString(),children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.invoice_number}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.billable.name," - ",S(n.total_amount,n.currency)]})]})},n.id)))||[]]})]}),t.invoice_id&&e.jsx("p",{className:"text-sm text-red-600",children:t.invoice_id})]}),!s.invoice_id&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"payable_type",children:a("finance.client_type","Client Type")}),e.jsxs(m,{value:s.payable_type,onValueChange:n=>{r("payable_type",n),r("payable_id","")},children:[e.jsx(o,{children:e.jsx(p,{placeholder:a("finance.select_client_type","Select client type")})}),e.jsxs(x,{children:[e.jsx(l,{value:"none",children:a("finance.no_client","No client")}),e.jsx(l,{value:"client",children:a("crm.client","Client")}),e.jsx(l,{value:"lead",children:a("crm.lead","Lead")})]})]}),t.payable_type&&e.jsx("p",{className:"text-sm text-red-600",children:t.payable_type})]}),s.payable_type&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"payable_id",children:s.payable_type==="client"?a("crm.client","Client"):a("crm.lead","Lead")}),e.jsxs(m,{value:s.payable_id,onValueChange:n=>r("payable_id",n),children:[e.jsx(o,{children:e.jsx(p,{placeholder:`Select ${s.payable_type}`})}),e.jsx(x,{children:((C=s.payable_type==="client"?A:P)==null?void 0:C.map(n=>e.jsx(l,{value:n.id.toString(),children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n.email})]})},n.id)))||[]})]}),t.payable_id&&e.jsx("p",{className:"text-sm text-red-600",children:t.payable_id})]})]}),h&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),a("finance.selected_invoice","Selected Invoice")]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[a("finance.invoice_number","Invoice #"),":"]})," ",h.invoice_number]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[a("finance.client","Client"),":"]})," ",h.billable.name]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[a("finance.amount","Amount"),":"]})," ",S(h.total_amount,h.currency)]})]})]})]})]})]}),e.jsxs(u,{children:[e.jsx(y,{children:e.jsx(f,{children:a("finance.additional_information","Additional Information")})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"notes",children:a("finance.notes","Notes")}),e.jsx(q,{id:"notes",placeholder:a("finance.payment_notes_placeholder","Add any notes about this payment..."),value:s.notes,onChange:n=>r("notes",n.target.value),rows:3}),t.notes&&e.jsx("p",{className:"text-sm text-red-600",children:t.notes})]})})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(b,{type:"button",variant:"outline",asChild:!0,children:e.jsx(F,{href:route("finance.payments.index"),children:a("common.cancel","Cancel")})}),e.jsx(b,{type:"submit",disabled:N,children:N?a("common.saving","Saving..."):a("finance.record_payment","Record Payment")})]})]})]})]})}export{qe as default};
