import{u as q,r as y,j as e,S as O,x as P,A as C}from"./app-BMIA6nir.js";import{A as V}from"./AppLayout-DbMk6clK.js";import{C as o,a as m,b as x,c as h,d as T}from"./card-BAsSN-2Z.js";import{c as G,B as g}from"./createLucideIcon-Cg8jdX0w.js";import{B as J}from"./x-C3KwZK3B.js";import{T as K,a as Q,b as D,c as M}from"./tabs-YflTNJKH.js";import{T as B,a as S,b as j,c as i,d as A,e as c}from"./table-DqBb-9tC.js";import{C as L}from"./checkbox-B8CiFAgv.js";import{u as X}from"./useTranslate-ER5gAOX6.js";import{t as l}from"./index-Dj2TB_RL.js";import{A as Y}from"./arrow-left-UX2kDF52.js";import{T as Z}from"./target-DIhftedx.js";import{L as E}from"./link-5UzZl49p.js";import{C as ee}from"./circle-check-big-DCsv6rXk.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./bell-5VRgJnzP.js";import"./dollar-sign-Cli0KufN.js";import"./file-text-D25AipK4.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./plus-BjPf5uI-.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]],ne=G("unlink",se);function es({reconciliation:t,bankTransactions:N,bookTransactions:b,suggestedMatches:R}){const{t:n}=X(),_=q(),[u,v]=y.useState([]),[p,k]=y.useState([]),[re,te]=y.useState(""),[U,z]=y.useState("unmatched"),F=()=>{C.post(_("finance.bank-reconciliation.auto-match",t.id),{},{onSuccess:()=>{l.success(n("Auto-matching completed"))},onError:s=>{l.error(s.error||n("Auto-matching failed"))}})},$=()=>{if(u.length===0||p.length===0){l.error(n("Please select transactions to match"));return}C.post(_("finance.bank-reconciliation.manual-match",t.id),{bank_transaction_ids:u,book_transaction_ids:p},{onSuccess:()=>{l.success(n("Transactions matched successfully")),v([]),k([])},onError:s=>{l.error(s.error||n("Failed to match transactions"))}})},H=(s,a)=>{C.post(_("finance.bank-reconciliation.unmatch",t.id),{bank_transaction_id:s,book_transaction_id:a},{onSuccess:()=>{l.success(n("Transactions unmatched successfully"))},onError:r=>{l.error(r.error||n("Failed to unmatch transactions"))}})},I=()=>{t.difference!==0&&!confirm(n("There is still a difference of :amount. Are you sure you want to complete?",{amount:d(t.difference)}))||C.post(_("finance.bank-reconciliation.complete",t.id),{},{onSuccess:()=>{l.success(n("Reconciliation completed successfully"))},onError:s=>{l.error(s.error||n("Failed to complete reconciliation"))}})},d=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),f=s=>new Date(s).toLocaleDateString(),W=s=>s>=.8?"text-green-600":s>=.6?"text-yellow-600":"text-red-600";return e.jsxs(V,{children:[e.jsx(O,{title:n("Bank Reconciliation Workspace")}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(g,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(P,{href:_("finance.bank-reconciliation.index"),children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),n("Back")]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:n("Reconciliation Workspace")}),e.jsxs("p",{className:"text-muted-foreground",children:[t.reconciliation_number," - ",t.account.name]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{variant:"outline",onClick:F,children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),n("Auto Match")]}),e.jsxs(g,{variant:"outline",onClick:$,disabled:u.length===0||p.length===0,children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),n("Manual Match")]}),e.jsxs(g,{onClick:I,disabled:t.status==="completed",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),n("Complete")]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(o,{children:[e.jsx(m,{className:"pb-2",children:e.jsx(x,{className:"text-sm font-medium",children:n("Statement Balance")})}),e.jsxs(h,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d(t.statement_closing_balance)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n("Opening"),": ",d(t.statement_opening_balance)]})]})]}),e.jsxs(o,{children:[e.jsx(m,{className:"pb-2",children:e.jsx(x,{className:"text-sm font-medium",children:n("Book Balance")})}),e.jsxs(h,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d(t.book_closing_balance)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n("Opening"),": ",d(t.book_opening_balance)]})]})]}),e.jsxs(o,{children:[e.jsx(m,{className:"pb-2",children:e.jsx(x,{className:"text-sm font-medium",children:n("Difference")})}),e.jsxs(h,{children:[e.jsx("div",{className:`text-2xl font-bold ${t.difference===0?"text-green-600":"text-red-600"}`,children:d(t.difference)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.difference===0?n("Balanced"):n("Needs attention")})]})]}),e.jsxs(o,{children:[e.jsx(m,{className:"pb-2",children:e.jsx(x,{className:"text-sm font-medium",children:n("Progress")})}),e.jsxs(h,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[t.progress_percentage,"%"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${t.progress_percentage}%`}})})]})]})]}),e.jsxs(K,{value:U,onValueChange:z,children:[e.jsxs(Q,{className:"grid w-full grid-cols-3",children:[e.jsx(D,{value:"unmatched",children:n("Unmatched Transactions")}),e.jsx(D,{value:"matched",children:n("Matched Transactions")}),e.jsx(D,{value:"suggestions",children:n("Suggested Matches")})]}),e.jsx(M,{value:"unmatched",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsx(x,{children:n("Bank Statement Transactions")}),e.jsxs(T,{children:[N.unmatched.length," ",n("unmatched transactions")]})]}),e.jsx(h,{children:e.jsxs(B,{children:[e.jsx(S,{children:e.jsxs(j,{children:[e.jsx(i,{className:"w-[50px]"}),e.jsx(i,{children:n("Date")}),e.jsx(i,{children:n("Description")}),e.jsx(i,{children:n("Amount")})]})}),e.jsx(A,{children:N.unmatched.map(s=>e.jsxs(j,{children:[e.jsx(c,{children:e.jsx(L,{checked:u.includes(s.id),onCheckedChange:a=>{v(a?[...u,s.id]:u.filter(r=>r!==s.id))}})}),e.jsx(c,{children:f(s.transaction_date)}),e.jsx(c,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.description}),s.reference_number&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Ref: ",s.reference_number]})]})}),e.jsx(c,{children:e.jsx("span",{className:s.debit_amount>0?"text-red-600":"text-green-600",children:s.debit_amount>0?`-${d(s.debit_amount)}`:`+${d(s.credit_amount)}`})})]},s.id))})]})})]}),e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsx(x,{children:n("Book Transactions")}),e.jsxs(T,{children:[b.unmatched.length," ",n("unmatched transactions")]})]}),e.jsx(h,{children:e.jsxs(B,{children:[e.jsx(S,{children:e.jsxs(j,{children:[e.jsx(i,{className:"w-[50px]"}),e.jsx(i,{children:n("Date")}),e.jsx(i,{children:n("Description")}),e.jsx(i,{children:n("Amount")})]})}),e.jsx(A,{children:b.unmatched.map(s=>e.jsxs(j,{children:[e.jsx(c,{children:e.jsx(L,{checked:p.includes(s.id),onCheckedChange:a=>{k(a?[...p,s.id]:p.filter(r=>r!==s.id))}})}),e.jsx(c,{children:f(s.transaction_date)}),e.jsx(c,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.description}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Ref: ",s.reference]})]})}),e.jsx(c,{children:e.jsx("span",{className:s.debit_amount>0?"text-red-600":"text-green-600",children:s.debit_amount>0?`-${d(s.debit_amount)}`:`+${d(s.credit_amount)}`})})]},s.id))})]})})]})]})}),e.jsx(M,{value:"matched",className:"space-y-4",children:e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsx(x,{children:n("Matched Transactions")}),e.jsxs(T,{children:[N.matched.length," ",n("matched pairs")]})]}),e.jsx(h,{children:e.jsxs(B,{children:[e.jsx(S,{children:e.jsxs(j,{children:[e.jsx(i,{children:n("Bank Transaction")}),e.jsx(i,{children:n("Book Transaction")}),e.jsx(i,{children:n("Amount")}),e.jsx(i,{children:n("Actions")})]})}),e.jsx(A,{children:N.matched.map((s,a)=>{const r=b.matched[a];return e.jsxs(j,{children:[e.jsx(c,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.description}),e.jsx("div",{className:"text-sm text-muted-foreground",children:f(s.transaction_date)})]})}),e.jsx(c,{children:r&&e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:r.description}),e.jsx("div",{className:"text-sm text-muted-foreground",children:f(r.transaction_date)})]})}),e.jsx(c,{children:e.jsx("span",{className:"text-green-600",children:d(s.debit_amount||s.credit_amount)})}),e.jsx(c,{children:e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>H(s.id,r==null?void 0:r.id),children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),n("Unmatch")]})})]},`${s.id}-${r==null?void 0:r.id}`)})})]})})]})}),e.jsx(M,{value:"suggestions",className:"space-y-4",children:e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsx(x,{children:n("Suggested Matches")}),e.jsxs(T,{children:[R.length," ",n("AI-suggested transaction matches")]})]}),e.jsx(h,{children:e.jsxs(B,{children:[e.jsx(S,{children:e.jsxs(j,{children:[e.jsx(i,{children:n("Bank Transaction")}),e.jsx(i,{children:n("Book Transaction")}),e.jsx(i,{children:n("Confidence")}),e.jsx(i,{children:n("Reason")}),e.jsx(i,{children:n("Actions")})]})}),e.jsx(A,{children:R.map(s=>{const a=N.unmatched.find(w=>w.id===s.bank_transaction_id),r=b.unmatched.find(w=>w.id===s.book_transaction_id);return!a||!r?null:e.jsxs(j,{children:[e.jsx(c,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.description}),e.jsx("div",{className:"text-sm text-muted-foreground",children:f(a.transaction_date)})]})}),e.jsx(c,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:r.description}),e.jsx("div",{className:"text-sm text-muted-foreground",children:f(r.transaction_date)})]})}),e.jsx(c,{children:e.jsxs(J,{variant:"outline",className:W(s.confidence_score),children:[Math.round(s.confidence_score*100),"%"]})}),e.jsx(c,{children:e.jsx("span",{className:"text-sm text-muted-foreground",children:s.match_reason})}),e.jsx(c,{children:e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>{v([s.bank_transaction_id]),k([s.book_transaction_id]),$()},children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),n("Accept")]})})]},`${s.bank_transaction_id}-${s.book_transaction_id}`)})})]})})]})})]})]})]})}export{es as default};
