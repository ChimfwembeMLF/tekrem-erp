import{u as $,r as f,G as J,j as e,S as U}from"./app-BMIA6nir.js";import{A as Q}from"./AppLayout-DbMk6clK.js";import{B as o}from"./createLucideIcon-Cg8jdX0w.js";import{C as d,a as m,b as x,d as p,c as h}from"./card-BAsSN-2Z.js";import{I as _}from"./input-Bg5GDATO.js";import{L as r}from"./label-CM6YsqH1.js";import{T as Y}from"./textarea-CP26afIU.js";import{S as y}from"./switch-_qD_kSA5.js";import{S as Z,a as ee,b as se,c as ae,d as ie}from"./select-B6KOX9nY.js";import{B as b}from"./x-C3KwZK3B.js";import{T as te,a as re,b as w,c as k}from"./tabs-YflTNJKH.js";import{u as ne}from"./useTranslate-ER5gAOX6.js";import{t as c}from"./index-Dj2TB_RL.js";import{K as N}from"./key-Qw2I2-NE.js";import{S as A}from"./shield-DwKJ9Ble.js";import{L as q}from"./lock-uJsQfGf1.js";import{P as le}from"./plus-BjPf5uI-.js";import{L as C}from"./loader-circle-BUEefOfS.js";import{E as ce}from"./eye-off-b0nJPnR3.js";import{E as oe}from"./eye-DdivFxyT.js";import{C as de}from"./copy-XqgUo3o3.js";import{T as me}from"./trash-2-DZc0jDKK.js";import{S as F}from"./sheet-1SUjjT9Y.js";import{S as D}from"./save-D6UyxhH5.js";import{A as xe}from"./arrow-left-UX2kDF52.js";import{T as pe}from"./triangle-alert-BWIpgUmg.js";import"./useTypedPage-hmuARwun.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./bell-5VRgJnzP.js";import"./dollar-sign-Cli0KufN.js";import"./file-text-D25AipK4.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";function ys({apiKeys:I,securitySettings:i,availablePermissions:M,signatureAlgorithms:O}){ne();const v=$(),[G,H]=f.useState("api-keys"),[P,B]=f.useState({}),[S,E]=f.useState(!1),{data:a,setData:l,put:z,processing:g,errors:he,reset:T}=J({api_rate_limiting_enabled:i.api_rate_limiting_enabled||!0,api_rate_limit_per_minute:i.api_rate_limit_per_minute||100,api_key_expiry_days:i.api_key_expiry_days||365,require_api_key_rotation:i.require_api_key_rotation||!0,enable_ip_whitelisting:i.enable_ip_whitelisting||!1,allowed_ip_addresses:i.allowed_ip_addresses||[],enable_request_signing:i.enable_request_signing||!0,signature_algorithm:i.signature_algorithm||"HMAC-SHA256",enable_audit_logging:i.enable_audit_logging||!0,log_retention_days:i.log_retention_days||90,enable_encryption_at_rest:i.enable_encryption_at_rest||!0,encryption_key_rotation_days:i.encryption_key_rotation_days||90,enable_two_factor_auth:i.enable_two_factor_auth||!1,session_timeout_minutes:i.session_timeout_minutes||60}),[n,u]=f.useState({name:"",permissions:[],expires_at:""}),L=s=>{s.preventDefault(),z(v("settings.finance.security.update"),{onSuccess:()=>{c.success("Security settings updated successfully")},onError:()=>{c.error("Failed to update security settings")}})},V=async()=>{var s;if(!n.name.trim()){c.error("Please enter a name for the API key");return}E(!0);try{const j=await(await fetch(v("settings.finance.security.api-keys.generate"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify(n)})).json();j.success?(c.success("API key generated successfully"),u({name:"",permissions:[],expires_at:""}),window.location.reload()):c.error(`Failed to generate API key: ${j.message}`)}catch{c.error("Failed to generate API key")}finally{E(!1)}},K=async s=>{var t;if(confirm("Are you sure you want to revoke this API key? This action cannot be undone."))try{const R=await(await fetch(v("settings.finance.security.api-keys.revoke",s),{method:"DELETE",headers:{"X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""}})).json();R.success?(c.success("API key revoked successfully"),window.location.reload()):c.error(`Failed to revoke API key: ${R.message}`)}catch{c.error("Failed to revoke API key")}},W=s=>{navigator.clipboard.writeText(s),c.success("Copied to clipboard")},X=s=>{B(t=>({...t,[s]:!t[s]}))};return e.jsxs(Q,{title:"Security & API Management",renderHeader:()=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>window.history.back(),children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-6 w-6 text-gray-600 dark:text-gray-400"}),e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Security & API Management"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(b,{variant:"outline",className:"text-red-600 border-red-600",children:[e.jsx(pe,{className:"h-3 w-3 mr-1"}),"High Security"]})})]}),children:[e.jsx(U,{title:"Security & API Management"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-6xl mx-auto sm:px-6 lg:px-8",children:e.jsxs(te,{value:G,onValueChange:H,children:[e.jsxs(re,{className:"mb-6",children:[e.jsxs(w,{value:"api-keys",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"API Keys"]}),e.jsxs(w,{value:"security",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Security Settings"]}),e.jsxs(w,{value:"encryption",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Encryption"]})]}),e.jsxs(k,{value:"api-keys",className:"space-y-6",children:[e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5"}),"Generate New API Key"]}),e.jsx(p,{children:"Create a new API key for external integrations"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"key_name",children:"API Key Name"}),e.jsx(_,{id:"key_name",placeholder:"e.g., Mobile App Integration",value:n.name,onChange:s=>u({...n,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"expires_at",children:"Expiry Date (Optional)"}),e.jsx(_,{id:"expires_at",type:"date",value:n.expires_at,onChange:s=>u({...n,expires_at:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Permissions"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:M.map(s=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:n.permissions.includes(s),onChange:t=>{t.target.checked?u({...n,permissions:[...n.permissions,s]}):u({...n,permissions:n.permissions.filter(j=>j!==s)})},className:"rounded border-gray-300"}),e.jsx("span",{className:"text-sm",children:s})]},s))})]}),e.jsxs(o,{onClick:V,disabled:S||!n.name.trim(),children:[S?e.jsx(C,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(N,{className:"h-4 w-4 mr-2"}),"Generate API Key"]})]})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5"}),"Existing API Keys"]}),e.jsx(p,{children:"Manage your existing API keys and their permissions"})]}),e.jsx(h,{children:I.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No API keys found. Generate your first API key above."}):e.jsx("div",{className:"space-y-4",children:I.map(s=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx(b,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>X(s.id),children:P[s.id]?e.jsx(ce,{className:"h-4 w-4"}):e.jsx(oe,{className:"h-4 w-4"})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>W(s.key),children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>K(s.id),className:"text-red-600 hover:text-red-700",children:e.jsx(me,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-mono text-sm bg-gray-100 dark:bg-gray-800 p-2 rounded",children:P[s.id]?s.key:"••••••••••••••••••••••••••••••••"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.permissions.map(t=>e.jsx(b,{variant:"outline",className:"text-xs",children:t},t))}),e.jsxs("div",{className:"text-sm text-gray-500 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:["Created: ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("div",{children:["Last Used: ",s.last_used?new Date(s.last_used).toLocaleDateString():"Never"]}),s.expires_at&&e.jsxs("div",{children:["Expires: ",new Date(s.expires_at).toLocaleDateString()]})]})]})]},s.id))})})]})]}),e.jsx(k,{value:"security",className:"space-y-6",children:e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"Rate Limiting"]}),e.jsx(p,{children:"Configure API rate limiting to prevent abuse"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{children:"Enable API Rate Limiting"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Limit the number of API requests per minute"})]}),e.jsx(y,{checked:a.api_rate_limiting_enabled,onCheckedChange:s=>l("api_rate_limiting_enabled",s)})]}),a.api_rate_limiting_enabled&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"api_rate_limit_per_minute",children:"Requests per Minute"}),e.jsx(_,{id:"api_rate_limit_per_minute",type:"number",min:"1",max:"10000",value:a.api_rate_limit_per_minute,onChange:s=>l("api_rate_limit_per_minute",parseInt(s.target.value))})]})]})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"IP Whitelisting"]}),e.jsx(p,{children:"Restrict API access to specific IP addresses"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{children:"Enable IP Whitelisting"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Only allow API access from whitelisted IPs"})]}),e.jsx(y,{checked:a.enable_ip_whitelisting,onCheckedChange:s=>l("enable_ip_whitelisting",s)})]}),a.enable_ip_whitelisting&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"allowed_ip_addresses",children:"Allowed IP Addresses"}),e.jsx(Y,{id:"allowed_ip_addresses",placeholder:`192.168.1.1
10.0.0.1
203.0.113.0/24`,value:a.allowed_ip_addresses.join(`
`),onChange:s=>l("allowed_ip_addresses",s.target.value.split(`
`).filter(t=>t.trim())),rows:4}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enter one IP address or CIDR block per line"})]})]})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5"}),"Request Signing"]}),e.jsx(p,{children:"Require cryptographic signatures for API requests"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{children:"Enable Request Signing"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Require HMAC signatures for all API requests"})]}),e.jsx(y,{checked:a.enable_request_signing,onCheckedChange:s=>l("enable_request_signing",s)})]}),a.enable_request_signing&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"signature_algorithm",children:"Signature Algorithm"}),e.jsxs(Z,{value:a.signature_algorithm,onValueChange:s=>l("signature_algorithm",s),children:[e.jsx(ee,{children:e.jsx(se,{placeholder:"Select signature algorithm"})}),e.jsx(ae,{children:O.map(s=>e.jsx(ie,{value:s,children:s},s))})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>T(),disabled:g,children:"Reset"}),e.jsxs(o,{type:"submit",disabled:g,children:[g?e.jsx(C,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(D,{className:"h-4 w-4 mr-2"}),"Save Security Settings"]})]})]})}),e.jsx(k,{value:"encryption",className:"space-y-6",children:e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"Encryption at Rest"]}),e.jsx(p,{children:"Configure encryption for stored data"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{children:"Enable Encryption at Rest"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Encrypt sensitive data in the database"})]}),e.jsx(y,{checked:a.enable_encryption_at_rest,onCheckedChange:s=>l("enable_encryption_at_rest",s)})]}),a.enable_encryption_at_rest&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"encryption_key_rotation_days",children:"Key Rotation Interval (days)"}),e.jsx(_,{id:"encryption_key_rotation_days",type:"number",min:"30",max:"365",value:a.encryption_key_rotation_days,onChange:s=>l("encryption_key_rotation_days",parseInt(s.target.value))})]})]})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"Audit Logging"]}),e.jsx(p,{children:"Configure audit logging for security events"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{children:"Enable Audit Logging"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Log all security-related events"})]}),e.jsx(y,{checked:a.enable_audit_logging,onCheckedChange:s=>l("enable_audit_logging",s)})]}),a.enable_audit_logging&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"log_retention_days",children:"Log Retention Period (days)"}),e.jsx(_,{id:"log_retention_days",type:"number",min:"30",max:"2555",value:a.log_retention_days,onChange:s=>l("log_retention_days",parseInt(s.target.value))})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>T(),disabled:g,children:"Reset"}),e.jsxs(o,{type:"submit",disabled:g,children:[g?e.jsx(C,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(D,{className:"h-4 w-4 mr-2"}),"Save Encryption Settings"]})]})]})})]})})})]})}export{ys as default};
