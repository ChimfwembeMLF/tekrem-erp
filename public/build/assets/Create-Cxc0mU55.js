import{r as B,G as L,j as e,S as z,x as A}from"./app-BMIA6nir.js";import{A as R}from"./AppLayout-DbMk6clK.js";import{C as x,a as h,b as j,c as f,d as G}from"./card-BAsSN-2Z.js";import{B as _}from"./createLucideIcon-Cg8jdX0w.js";import{I as m}from"./input-Bg5GDATO.js";import{L as n}from"./label-CM6YsqH1.js";import{T as Q}from"./textarea-CP26afIU.js";import{S as C,a as q,b as S,c as w,d as F}from"./select-B6KOX9nY.js";import{u as H}from"./useTranslate-ER5gAOX6.js";import{t as $}from"./index-Dj2TB_RL.js";import{A as J}from"./arrow-left-UX2kDF52.js";import{F as K}from"./file-text-D25AipK4.js";import{C as M}from"./clock-BTinGqFV.js";import{U as W}from"./x-C3KwZK3B.js";import{C as X}from"./calculator-DwuSx6in.js";import{T as Y}from"./trash-2-DZc0jDKK.js";import{P as Z}from"./plus-BjPf5uI-.js";import{D as ee}from"./dollar-sign-Cli0KufN.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./bell-5VRgJnzP.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";function Xe({leads:u=[],currencies:k={},statuses:U={},selectedLead:g}){var T;const{t:s}=H(),[o,N]=B.useState([{description:"",quantity:1,unit_price:0,total_price:0}]),{data:i,setData:r,post:E,processing:D,errors:c}=L({lead_id:((T=g==null?void 0:g.id)==null?void 0:T.toString())||"",issue_date:new Date().toISOString().split("T")[0],expiry_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],currency:"USD",status:"draft",notes:"",terms:"",tax_rate:0,discount_amount:0,items:o}),O=()=>{N([...o,{description:"",quantity:1,unit_price:0,total_price:0}])},P=t=>{if(o.length>1){const a=o.filter((d,l)=>l!==t);N(a),r("items",a)}},v=(t,a,d)=>{const l=[...o];l[t]={...l[t],[a]:d},(a==="quantity"||a==="unit_price")&&(l[t].total_price=l[t].quantity*l[t].unit_price),N(l),r("items",l)},y=()=>o.reduce((t,a)=>t+a.total_price,0),b=()=>y()*i.tax_rate/100,I=()=>y()+b()-i.discount_amount,V=t=>{t.preventDefault();const a={...i,items:o,subtotal:y(),tax_amount:b(),total_amount:I()};E(route("finance.quotations.store"),{data:a,onSuccess:()=>{$.success(s("finance.quotation_created","Quotation created successfully"))},onError:()=>{$.error(s("common.error_occurred","An error occurred"))}})},p=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:i.currency}).format(t);return e.jsxs(R,{title:s("finance.create_quotation","Create Quotation"),breadcrumbs:[{label:s("finance.title","Finance"),href:"/finance"},{label:s("finance.quotations","Quotations"),href:"/finance/quotations"},{label:s("finance.create_quotation","Create Quotation")}],children:[e.jsx(z,{title:s("finance.create_quotation","Create Quotation")}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(_,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(A,{href:route("finance.quotations.index"),children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),s("common.back","Back")]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:s("finance.create_quotation","Create Quotation")}),e.jsx("p",{className:"text-muted-foreground",children:s("finance.create_quotation_description","Create a new quotation for your lead")})]})]}),e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),s("finance.quotation_details","Quotation Details")]})}),e.jsxs(f,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"issue_date",children:[s("finance.issue_date","Issue Date")," *"]}),e.jsx(m,{id:"issue_date",type:"date",value:i.issue_date,onChange:t=>r("issue_date",t.target.value),required:!0}),c.issue_date&&e.jsx("p",{className:"text-sm text-red-600",children:c.issue_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"expiry_date",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),s("finance.expiry_date","Expiry Date")," *"]})}),e.jsx(m,{id:"expiry_date",type:"date",value:i.expiry_date,onChange:t=>r("expiry_date",t.target.value),required:!0}),c.expiry_date&&e.jsx("p",{className:"text-sm text-red-600",children:c.expiry_date})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"currency",children:[s("finance.currency","Currency")," *"]}),e.jsxs(C,{value:i.currency,onValueChange:t=>r("currency",t),children:[e.jsx(q,{children:e.jsx(S,{})}),e.jsx(w,{children:Object.entries(k||{}).map(([t,a])=>e.jsxs(F,{value:t,children:[t," - ",a]},t))})]}),c.currency&&e.jsx("p",{className:"text-sm text-red-600",children:c.currency})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"status",children:[s("common.status","Status")," *"]}),e.jsxs(C,{value:i.status,onValueChange:t=>r("status",t),children:[e.jsx(q,{children:e.jsx(S,{})}),e.jsx(w,{children:Object.entries(U||{}).map(([t,a])=>e.jsx(F,{value:t,children:a},t))})]}),c.status&&e.jsx("p",{className:"text-sm text-red-600",children:c.status})]})]})]})]}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),s("finance.lead_details","Lead Details")]})}),e.jsxs(f,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"lead_id",children:[s("crm.lead","Lead")," *"]}),e.jsxs(C,{value:i.lead_id,onValueChange:t=>r("lead_id",t),children:[e.jsx(q,{children:e.jsx(S,{placeholder:s("finance.select_lead","Select a lead")})}),e.jsx(w,{children:(u==null?void 0:u.map(t=>e.jsx(F,{value:t.id.toString(),children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.company?`${t.company} â€¢ ${t.email}`:t.email})]})},t.id)))||[]})]}),c.lead_id&&e.jsx("p",{className:"text-sm text-red-600",children:c.lead_id})]}),i.lead_id&&e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:(()=>{const t=u==null?void 0:u.find(a=>a.id.toString()===i.lead_id);return t?e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.email}),t.company&&e.jsx("p",{className:"text-sm text-muted-foreground",children:t.company})]}):null})()})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),s("finance.quotation_items","Quotation Items")]}),e.jsx(G,{children:s("finance.add_items_description","Add items or services to your quotation")})]}),e.jsxs(f,{className:"space-y-4",children:[o.map((t,a)=>e.jsxs("div",{className:"grid gap-4 md:grid-cols-12 items-end p-4 border rounded-lg",children:[e.jsxs("div",{className:"md:col-span-5 space-y-2",children:[e.jsx(n,{htmlFor:`description-${a}`,children:s("finance.description","Description")}),e.jsx(m,{id:`description-${a}`,placeholder:s("finance.item_description","Item description"),value:t.description,onChange:d=>v(a,"description",d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(n,{htmlFor:`quantity-${a}`,children:s("finance.quantity","Quantity")}),e.jsx(m,{id:`quantity-${a}`,type:"number",min:"1",step:"1",value:t.quantity,onChange:d=>v(a,"quantity",parseInt(d.target.value)||1)})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(n,{htmlFor:`unit_price-${a}`,children:s("finance.unit_price","Unit Price")}),e.jsx(m,{id:`unit_price-${a}`,type:"number",min:"0",step:"0.01",value:t.unit_price,onChange:d=>v(a,"unit_price",parseFloat(d.target.value)||0)})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(n,{children:s("finance.total","Total")}),e.jsx("div",{className:"h-10 px-3 py-2 border rounded-md bg-muted flex items-center",children:p(t.total_price)})]}),e.jsx("div",{className:"md:col-span-1",children:e.jsx(_,{type:"button",variant:"outline",size:"sm",onClick:()=>P(a),disabled:o.length===1,children:e.jsx(Y,{className:"h-4 w-4"})})})]},a)),e.jsxs(_,{type:"button",variant:"outline",onClick:O,children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),s("finance.add_item","Add Item")]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(j,{children:s("finance.additional_information","Additional Information")})}),e.jsxs(f,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"notes",children:s("finance.notes","Notes")}),e.jsx(Q,{id:"notes",placeholder:s("finance.quotation_notes_placeholder","Add any notes for the lead..."),value:i.notes,onChange:t=>r("notes",t.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"terms",children:s("finance.terms","Terms & Conditions")}),e.jsx(Q,{id:"terms",placeholder:s("finance.terms_placeholder","Payment terms and conditions..."),value:i.terms,onChange:t=>r("terms",t.target.value),rows:3})]})]})]}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),s("finance.quotation_totals","Quotation Totals")]})}),e.jsxs(f,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"tax_rate",children:s("finance.tax_rate","Tax Rate (%)")}),e.jsx(m,{id:"tax_rate",type:"number",min:"0",max:"100",step:"0.01",value:i.tax_rate,onChange:t=>r("tax_rate",parseFloat(t.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"discount_amount",children:s("finance.discount_amount","Discount Amount")}),e.jsx(m,{id:"discount_amount",type:"number",min:"0",step:"0.01",value:i.discount_amount,onChange:t=>r("discount_amount",parseFloat(t.target.value)||0)})]})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[s("finance.subtotal","Subtotal"),":"]}),e.jsx("span",{className:"font-medium",children:p(y())})]}),i.tax_rate>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[s("finance.tax","Tax")," (",i.tax_rate,"%):"]}),e.jsx("span",{className:"font-medium",children:p(b())})]}),i.discount_amount>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[s("finance.discount","Discount"),":"]}),e.jsxs("span",{className:"font-medium",children:["-",p(i.discount_amount)]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold pt-2 border-t",children:[e.jsxs("span",{children:[s("finance.total","Total"),":"]}),e.jsx("span",{children:p(I())})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(_,{type:"button",variant:"outline",asChild:!0,children:e.jsx(A,{href:route("finance.quotations.index"),children:s("common.cancel","Cancel")})}),e.jsx(_,{type:"submit",disabled:D,children:D?s("common.saving","Saving..."):s("finance.create_quotation","Create Quotation")})]})]})]})]})}export{Xe as default};
