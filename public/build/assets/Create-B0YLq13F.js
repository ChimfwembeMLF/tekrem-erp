import{j as e,r as v,G as ee,S as se,x as V}from"./app-BMIA6nir.js";import{A as te}from"./AppLayout-DbMk6clK.js";import{C as S,a as w,b as T,d as A,c as k}from"./card-BAsSN-2Z.js";import{B as d}from"./createLucideIcon-Cg8jdX0w.js";import{I as C}from"./input-Bg5GDATO.js";import{L as l}from"./label-CM6YsqH1.js";import{T as ae}from"./textarea-CP26afIU.js";import{S as u,a as j,b as f,c as g,d as x}from"./select-B6KOX9nY.js";import{u as H}from"./useTranslate-ER5gAOX6.js";import{u as re}from"./useFinanceAI-oMHKJO8s.js";import{X as ne,B as G}from"./x-C3KwZK3B.js";import{A as O,a as R}from"./alert-CNp8ZuHk.js";import{B as I}from"./bot-COuCQh0r.js";import{S as M}from"./sparkles-Csmgo_ih.js";import{L as ie}from"./lightbulb-COB8R_XU.js";import{T as P}from"./thumbs-up-BgoIjls2.js";import{T as ce}from"./triangle-alert-BWIpgUmg.js";import{C as oe}from"./circle-check-big-DCsv6rXk.js";import{T as le}from"./thumbs-down-SVKOui9E.js";import{t as h}from"./index-Dj2TB_RL.js";import{A as de}from"./arrow-left-UX2kDF52.js";import{C as me}from"./NotificationComponent-CHA3vjZG.js";import{C as pe}from"./circle-alert-DVIk47WR.js";import{S as xe}from"./save-D6UyxhH5.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./dollar-sign-Cli0KufN.js";import"./file-text-D25AipK4.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./plus-BjPf5uI-.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";import"./bell-5VRgJnzP.js";function he({suggestions:r,onApplySuggestion:m,onDismiss:_,loading:N=!1}){H();const p=o=>o>=.8?"bg-green-100 text-green-800":o>=.6?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",t=o=>o>=.8?"High":o>=.6?"Medium":"Low";return N?e.jsxs(S,{className:"border-blue-200 bg-blue-50/50",children:[e.jsxs(w,{className:"pb-3",children:[e.jsxs(T,{className:"flex items-center gap-2 text-blue-700",children:[e.jsx(I,{className:"h-5 w-5 animate-pulse"}),"AI Assistant"]}),e.jsx(A,{children:"Analyzing your transaction..."})]}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 animate-spin text-blue-600"}),e.jsx("span",{className:"text-sm text-blue-600",children:"Getting AI suggestions..."})]})})]}):e.jsxs(S,{className:"border-blue-200 bg-blue-50/50",children:[e.jsxs(w,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-blue-600"}),e.jsx(T,{className:"text-blue-700",children:"AI Suggestions"})]}),e.jsx(d,{variant:"ghost",size:"sm",onClick:_,className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-800",children:e.jsx(ne,{className:"h-4 w-4"})})]}),e.jsx(A,{children:"AI-powered suggestions to improve your transaction"})]}),e.jsxs(k,{className:"space-y-4",children:[r.category&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4 text-amber-600"}),e.jsx("span",{className:"font-medium text-sm",children:"Category Suggestion"}),e.jsxs(G,{className:p(r.category.confidence),variant:"secondary",children:[t(r.category.confidence)," (",Math.round(r.category.confidence*100),"%)"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:r.category.category}),e.jsxs(d,{size:"sm",onClick:()=>{var o;return m("category",(o=r.category)==null?void 0:o.category)},className:"h-7",children:[e.jsx(P,{className:"h-3 w-3 mr-1"}),"Apply"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.category.reasoning})]})]}),r.enhanced_description&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"font-medium text-sm",children:"Enhanced Description"})]}),e.jsx("div",{className:"bg-white rounded-lg p-3 border",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm",children:r.enhanced_description}),e.jsxs(d,{size:"sm",onClick:()=>m("description",r.enhanced_description),className:"h-7",children:[e.jsx(P,{className:"h-3 w-3 mr-1"}),"Apply"]})]})})]}),r.duplicate_check&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r.duplicate_check.is_duplicate?e.jsx(ce,{className:"h-4 w-4 text-red-600"}):e.jsx(oe,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-medium text-sm",children:"Duplicate Check"}),e.jsxs(G,{className:p(r.duplicate_check.confidence),variant:"secondary",children:[t(r.duplicate_check.confidence)," (",Math.round(r.duplicate_check.confidence*100),"%)"]})]}),e.jsx(O,{className:r.duplicate_check.is_duplicate?"border-red-200 bg-red-50":"border-green-200 bg-green-50",children:e.jsxs(R,{className:"text-sm",children:[r.duplicate_check.is_duplicate?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Potential duplicate detected!"})," This transaction appears similar to ",r.duplicate_check.similar_transactions.length," recent transaction(s)."]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"No duplicates found."})," This transaction appears to be unique."]}),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1 block",children:r.duplicate_check.reasoning})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:_,className:"flex-1",children:[e.jsx(le,{className:"h-3 w-3 mr-1"}),"Dismiss"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Powered by Mistral AI"})]})]})]})}function _s({accounts:r=[],categories:m=[],transactionTypes:_={},statuses:N={},selectedAccount:p}){const{t}=H(),{getTransactionSuggestions:o,suggestions:F,loading:y,clearSuggestions:q}=re(),[D,L]=v.useState(m),[K,B]=v.useState(!1),{data:n,setData:c,post:U,processing:E,errors:a,reset:X}=ee({type:"",amount:"",description:"",transaction_date:new Date().toISOString().split("T")[0],account_id:(p==null?void 0:p.id.toString())||"",category_id:"none",transfer_to_account_id:"",reference_number:"",status:"completed"});v.useEffect(()=>{if(n.type){const s=m.filter(i=>i.type===n.type||i.type==="both");L(s),n.category_id&&n.category_id!=="none"&&!s.find(i=>i.id.toString()===n.category_id)&&c("category_id","none")}else L(m)},[n.type,m]);const b=(r==null?void 0:r.filter(s=>s.id.toString()!==n.account_id))||[],$=s=>{s.preventDefault(),U(route("finance.transactions.store"),{onSuccess:()=>{h.success(t("finance.transaction_created","Transaction created successfully")),X()},onError:i=>{h.error(t("finance.create_error","Error creating transaction"))}})},J=s=>{c(i=>({...i,type:s,category_id:"none",transfer_to_account_id:s==="transfer"?i.transfer_to_account_id:""}))},Q=async()=>{if(!n.description.trim()){h.error("Please enter a description first");return}B(!0),await o({description:n.description,amount:n.amount?parseFloat(n.amount):void 0,date:n.transaction_date})},W=(s,i)=>{switch(s){case"category":const z=D.find(Z=>Z.name.toLowerCase()===i.toLowerCase());z?(c("category_id",z.id.toString()),h.success("Category applied successfully")):h.info(`Category "${i}" not found in your categories`);break;case"description":c("description",i),h.success("Description updated successfully");break}},Y=()=>{B(!1),q()};return e.jsxs(te,{title:t("finance.create_transaction","Create Transaction"),children:[e.jsx(se,{title:t("finance.create_transaction","Create Transaction")}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(d,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(V,{href:route("finance.transactions.index"),children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),t("common.back","Back")]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:t("finance.create_transaction","Create Transaction")}),e.jsx("p",{className:"text-muted-foreground",children:t("finance.create_transaction_description","Add a new financial transaction")})]})]}),e.jsxs(S,{children:[e.jsxs(w,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),t("finance.transaction_details","Transaction Details")]}),e.jsx(A,{children:t("finance.transaction_details_description","Enter the details for your new transaction")})]}),e.jsx(k,{children:e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"type",children:[t("finance.transaction_type","Transaction Type")," *"]}),e.jsxs(u,{value:n.type,onValueChange:J,children:[e.jsx(j,{className:a.type?"border-red-500":"",children:e.jsx(f,{placeholder:t("finance.select_transaction_type","Select transaction type")})}),e.jsx(g,{children:Object.entries(_||{}).map(([s,i])=>e.jsx(x,{value:s,children:i},s))})]}),a.type&&e.jsx("p",{className:"text-sm text-red-600",children:a.type})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"amount",children:[t("finance.amount","Amount")," *"]}),e.jsx(C,{id:"amount",type:"number",step:"0.01",min:"0.01",value:n.amount,onChange:s=>c("amount",s.target.value),placeholder:"0.00",className:a.amount?"border-red-500":""}),a.amount&&e.jsx("p",{className:"text-sm text-red-600",children:a.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"account_id",children:[t("finance.account","Account")," *"]}),e.jsxs(u,{value:n.account_id,onValueChange:s=>c("account_id",s),children:[e.jsx(j,{className:a.account_id?"border-red-500":"",children:e.jsx(f,{placeholder:t("finance.select_account","Select account")})}),e.jsx(g,{children:(r==null?void 0:r.map(s=>e.jsxs(x,{value:s.id.toString(),children:[s.name," (",s.currency,")"]},s.id)))||[]})]}),a.account_id&&e.jsx("p",{className:"text-sm text-red-600",children:a.account_id})]}),n.type==="transfer"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"transfer_to_account_id",children:[t("finance.transfer_to_account","Transfer To Account")," *"]}),e.jsxs(u,{value:n.transfer_to_account_id,onValueChange:s=>c("transfer_to_account_id",s),children:[e.jsx(j,{className:a.transfer_to_account_id?"border-red-500":"",children:e.jsx(f,{placeholder:t("finance.select_destination_account","Select destination account")})}),e.jsx(g,{children:(b==null?void 0:b.map(s=>e.jsxs(x,{value:s.id.toString(),children:[s.name," (",s.currency,")"]},s.id)))||[]})]}),a.transfer_to_account_id&&e.jsx("p",{className:"text-sm text-red-600",children:a.transfer_to_account_id})]}),n.type&&n.type!=="transfer"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"category_id",children:t("finance.category","Category")}),e.jsxs(u,{value:n.category_id,onValueChange:s=>c("category_id",s),children:[e.jsx(j,{className:a.category_id?"border-red-500":"",children:e.jsx(f,{placeholder:t("finance.select_category","Select category")})}),e.jsxs(g,{children:[e.jsx(x,{value:"none",children:t("common.no_category","No Category")}),D.map(s=>e.jsx(x,{value:s.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.color}}),s.name]})},s.id))]})]}),a.category_id&&e.jsx("p",{className:"text-sm text-red-600",children:a.category_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"transaction_date",children:[t("finance.transaction_date","Transaction Date")," *"]}),e.jsx(C,{id:"transaction_date",type:"date",value:n.transaction_date,onChange:s=>c("transaction_date",s.target.value),className:a.transaction_date?"border-red-500":""}),a.transaction_date&&e.jsx("p",{className:"text-sm text-red-600",children:a.transaction_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"status",children:[t("common.status","Status")," *"]}),e.jsxs(u,{value:n.status,onValueChange:s=>c("status",s),children:[e.jsx(j,{className:a.status?"border-red-500":"",children:e.jsx(f,{placeholder:t("finance.select_status","Select status")})}),e.jsx(g,{children:Object.entries(N||{}).map(([s,i])=>e.jsx(x,{value:s,children:i},s))})]}),a.status&&e.jsx("p",{className:"text-sm text-red-600",children:a.status})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"reference_number",children:t("finance.reference_number","Reference Number")}),e.jsx(C,{id:"reference_number",type:"text",value:n.reference_number,onChange:s=>c("reference_number",s.target.value),placeholder:t("finance.reference_number_placeholder","e.g., INV-001, CHK-123"),className:a.reference_number?"border-red-500":""}),a.reference_number&&e.jsx("p",{className:"text-sm text-red-600",children:a.reference_number})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(l,{htmlFor:"description",children:[t("common.description","Description")," *"]}),e.jsxs(d,{type:"button",variant:"outline",size:"sm",onClick:Q,disabled:!n.description.trim()||y,className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),y?"Getting AI Suggestions...":"Get AI Suggestions"]})]}),e.jsx(ae,{id:"description",value:n.description,onChange:s=>c("description",s.target.value),placeholder:t("finance.transaction_description_placeholder","Enter transaction description"),rows:3,className:a.description?"border-red-500":""}),a.description&&e.jsx("p",{className:"text-sm text-red-600",children:a.description})]}),K&&F&&e.jsx(he,{suggestions:F,onApplySuggestion:W,onDismiss:Y,loading:y}),n.status==="pending"&&e.jsxs(O,{children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx(R,{children:t("finance.pending_transaction_note","Pending transactions will not affect account balances until marked as completed.")})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-6 border-t",children:[e.jsxs(d,{type:"submit",disabled:E,children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),E?t("common.creating","Creating..."):t("finance.create_transaction","Create Transaction")]}),e.jsx(d,{type:"button",variant:"outline",asChild:!0,children:e.jsx(V,{href:route("finance.transactions.index"),children:t("common.cancel","Cancel")})})]})]})})]})]})]})}export{_s as default};
