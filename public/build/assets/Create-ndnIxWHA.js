import{u as U,r as H,G as O,j as e,S as G,x as k}from"./app-BMIA6nir.js";import{A as z}from"./AppLayout-DbMk6clK.js";import{C as u,a as g,b as f,d as y,c as _}from"./card-BAsSN-2Z.js";import{B as b}from"./createLucideIcon-Cg8jdX0w.js";import{I as l}from"./input-Bg5GDATO.js";import{L as i}from"./label-CM6YsqH1.js";import{T as J}from"./textarea-CP26afIU.js";import{S as F,a as T,b as w,c as Y,d as m}from"./select-B6KOX9nY.js";import{T as q,a as K,b as B,c as I}from"./tabs-YflTNJKH.js";import{T as Q,a as W,b as E,c as h,d as X,e as j}from"./table-DqBb-9tC.js";import{u as Z}from"./useTranslate-ER5gAOX6.js";import{t as v}from"./index-Dj2TB_RL.js";import{A as $}from"./arrow-left-UX2kDF52.js";import{F as ee}from"./file-text-D25AipK4.js";import{C as se}from"./circle-alert-DVIk47WR.js";import{U as ae}from"./upload-DoO0wQwa.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./x-C3KwZK3B.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./index-DgfI6AGt.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./bell-5VRgJnzP.js";import"./dollar-sign-Cli0KufN.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./plus-BjPf5uI-.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";function ss({accounts:M,previewData:c}){const{t:s}=Z(),N=U(),[V,S]=H.useState("import"),{data:t,setData:n,post:D,processing:C,errors:r}=O({account_id:"",statement_number:"",statement_date:"",period_start:"",period_end:"",opening_balance:"",closing_balance:"",import_method:"csv",file:null,column_mapping:{date:"",description:"",reference:"",debit:"",credit:"",balance:""},date_format:"Y-m-d",skip_header_rows:"1",notes:""}),A=a=>{var o;const d=(o=a.target.files)==null?void 0:o[0];d&&n("file",d)},P=a=>{if(a.preventDefault(),!t.file){v.error(s("Please select a file to import"));return}const d=new FormData;Object.entries(t).forEach(([o,p])=>{o==="file"&&p?d.append(o,p):o==="column_mapping"?d.append(o,JSON.stringify(p)):p!==null&&p!==""&&d.append(o,p.toString())}),D(N("finance.bank-statements.preview"),{data:d,onSuccess:()=>{S("preview"),v.success(s("File preview generated successfully"))},onError:()=>{v.error(s("Failed to preview file"))}})},R=()=>{D(N("finance.bank-statements.store"),{onSuccess:()=>{v.success(s("Bank statement imported successfully"))},onError:()=>{v.error(s("Failed to import bank statement"))}})},x=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a),L=a=>new Date(a).toLocaleDateString();return e.jsxs(z,{children:[e.jsx(G,{title:s("Import Bank Statement")}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(b,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(k,{href:N("finance.bank-statements.index"),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),s("Back")]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:s("Import Bank Statement")}),e.jsx("p",{className:"text-muted-foreground",children:s("Import transactions from CSV or Excel files")})]})]})}),e.jsxs(q,{value:V,onValueChange:S,children:[e.jsxs(K,{className:"grid w-full grid-cols-2",children:[e.jsx(B,{value:"import",children:s("Import Settings")}),e.jsx(B,{value:"preview",disabled:!c,children:s("Preview & Confirm")})]}),e.jsx(I,{value:"import",className:"space-y-6",children:e.jsx("form",{onSubmit:P,className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(u,{children:[e.jsxs(g,{children:[e.jsx(f,{children:s("Statement Information")}),e.jsx(y,{children:s("Basic information about the bank statement")})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"account_id",children:[s("Account")," *"]}),e.jsxs(F,{value:t.account_id.toString(),onValueChange:a=>n("account_id",a),children:[e.jsx(T,{className:r.account_id?"border-red-500":"",children:e.jsx(w,{placeholder:s("Select account")})}),e.jsx(Y,{children:M.map(a=>e.jsxs(m,{value:a.id.toString(),children:[a.account_code," - ",a.name]},a.id))})]}),r.account_id&&e.jsx("p",{className:"text-sm text-red-500",children:r.account_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"statement_number",children:[s("Statement Number")," *"]}),e.jsx(l,{id:"statement_number",value:t.statement_number,onChange:a=>n("statement_number",a.target.value),placeholder:s("Enter statement number"),className:r.statement_number?"border-red-500":""}),r.statement_number&&e.jsx("p",{className:"text-sm text-red-500",children:r.statement_number})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"statement_date",children:[s("Statement Date")," *"]}),e.jsx(l,{id:"statement_date",type:"date",value:t.statement_date,onChange:a=>n("statement_date",a.target.value),className:r.statement_date?"border-red-500":""}),r.statement_date&&e.jsx("p",{className:"text-sm text-red-500",children:r.statement_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"period_start",children:[s("Period Start")," *"]}),e.jsx(l,{id:"period_start",type:"date",value:t.period_start,onChange:a=>n("period_start",a.target.value),className:r.period_start?"border-red-500":""}),r.period_start&&e.jsx("p",{className:"text-sm text-red-500",children:r.period_start})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"period_end",children:[s("Period End")," *"]}),e.jsx(l,{id:"period_end",type:"date",value:t.period_end,onChange:a=>n("period_end",a.target.value),className:r.period_end?"border-red-500":""}),r.period_end&&e.jsx("p",{className:"text-sm text-red-500",children:r.period_end})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"opening_balance",children:[s("Opening Balance")," *"]}),e.jsx(l,{id:"opening_balance",type:"number",step:"0.01",value:t.opening_balance,onChange:a=>n("opening_balance",a.target.value),placeholder:"0.00",className:r.opening_balance?"border-red-500":""}),r.opening_balance&&e.jsx("p",{className:"text-sm text-red-500",children:r.opening_balance})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"closing_balance",children:[s("Closing Balance")," *"]}),e.jsx(l,{id:"closing_balance",type:"number",step:"0.01",value:t.closing_balance,onChange:a=>n("closing_balance",a.target.value),placeholder:"0.00",className:r.closing_balance?"border-red-500":""}),r.closing_balance&&e.jsx("p",{className:"text-sm text-red-500",children:r.closing_balance})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"notes",children:s("Notes")}),e.jsx(J,{id:"notes",value:t.notes,onChange:a=>n("notes",a.target.value),placeholder:s("Optional notes about this statement"),rows:3})]})]})]})}),e.jsxs("div",{children:[e.jsxs(u,{children:[e.jsxs(g,{children:[e.jsx(f,{children:s("File Import")}),e.jsx(y,{children:s("Upload and configure file import settings")})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"import_method",children:[s("Import Method")," *"]}),e.jsxs(F,{value:t.import_method,onValueChange:a=>n("import_method",a),children:[e.jsx(T,{children:e.jsx(w,{})}),e.jsxs(Y,{children:[e.jsx(m,{value:"csv",children:"CSV File"}),e.jsx(m,{value:"excel",children:"Excel File"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"file",children:[s("File")," *"]}),e.jsx(l,{id:"file",type:"file",accept:".csv,.xlsx,.xls",onChange:A,className:r.file?"border-red-500":""}),r.file&&e.jsx("p",{className:"text-sm text-red-500",children:r.file}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("Supported formats: CSV, Excel (.xlsx, .xls)")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"date_format",children:s("Date Format")}),e.jsxs(F,{value:t.date_format,onValueChange:a=>n("date_format",a),children:[e.jsx(T,{children:e.jsx(w,{})}),e.jsxs(Y,{children:[e.jsx(m,{value:"Y-m-d",children:"YYYY-MM-DD"}),e.jsx(m,{value:"m/d/Y",children:"MM/DD/YYYY"}),e.jsx(m,{value:"d/m/Y",children:"DD/MM/YYYY"}),e.jsx(m,{value:"d-m-Y",children:"DD-MM-YYYY"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"skip_header_rows",children:s("Skip Header Rows")}),e.jsx(l,{id:"skip_header_rows",type:"number",min:"0",value:t.skip_header_rows,onChange:a=>n("skip_header_rows",a.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("Number of rows to skip at the beginning of the file")})]})]})]}),e.jsxs(u,{className:"mt-6",children:[e.jsxs(g,{children:[e.jsx(f,{children:s("Column Mapping")}),e.jsx(y,{children:s("Map CSV columns to transaction fields")})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{children:[s("Date Column")," *"]}),e.jsx(l,{value:t.column_mapping.date,onChange:a=>n("column_mapping",{...t.column_mapping,date:a.target.value}),placeholder:s("e.g., A, 1, Date")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{children:[s("Description Column")," *"]}),e.jsx(l,{value:t.column_mapping.description,onChange:a=>n("column_mapping",{...t.column_mapping,description:a.target.value}),placeholder:s("e.g., B, 2, Description")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:s("Reference Column")}),e.jsx(l,{value:t.column_mapping.reference,onChange:a=>n("column_mapping",{...t.column_mapping,reference:a.target.value}),placeholder:s("e.g., C, 3, Reference")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:s("Debit Column")}),e.jsx(l,{value:t.column_mapping.debit,onChange:a=>n("column_mapping",{...t.column_mapping,debit:a.target.value}),placeholder:s("e.g., D, 4, Debit")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:s("Credit Column")}),e.jsx(l,{value:t.column_mapping.credit,onChange:a=>n("column_mapping",{...t.column_mapping,credit:a.target.value}),placeholder:s("e.g., E, 5, Credit")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:s("Balance Column")}),e.jsx(l,{value:t.column_mapping.balance,onChange:a=>n("column_mapping",{...t.column_mapping,balance:a.target.value}),placeholder:s("e.g., F, 6, Balance")})]})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end space-x-2",children:[e.jsx(b,{variant:"outline",asChild:!0,children:e.jsx(k,{href:N("finance.bank-statements.index"),children:s("Cancel")})}),e.jsxs(b,{type:"submit",disabled:C,children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),s(C?"Generating Preview...":"Preview")]})]})]})]})})}),e.jsx(I,{value:"preview",className:"space-y-6",children:c&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{children:[e.jsx(g,{children:e.jsx(f,{children:s("Import Summary")})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.summary.total_transactions}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("Transactions")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:x(c.summary.total_debits)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("Total Debits")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:x(c.summary.total_credits)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("Total Credits")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:x(c.summary.closing_balance)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("Closing Balance")})]})]}),c.summary.errors.length>0&&e.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(se,{className:"h-4 w-4 text-red-600"}),e.jsx("h4",{className:"font-medium text-red-800",children:s("Import Errors")})]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-red-700",children:c.summary.errors.map((a,d)=>e.jsx("li",{children:a},d))})]})]})]}),e.jsxs(u,{children:[e.jsxs(g,{children:[e.jsx(f,{children:s("Transaction Preview")}),e.jsx(y,{children:s("Review the first 50 transactions before importing")})]}),e.jsxs(_,{children:[e.jsxs(Q,{children:[e.jsx(W,{children:e.jsxs(E,{children:[e.jsx(h,{children:s("Date")}),e.jsx(h,{children:s("Description")}),e.jsx(h,{children:s("Reference")}),e.jsx(h,{children:s("Debit")}),e.jsx(h,{children:s("Credit")}),e.jsx(h,{children:s("Balance")})]})}),e.jsx(X,{children:c.transactions.slice(0,50).map((a,d)=>e.jsxs(E,{className:a.errors?"bg-red-50":"",children:[e.jsx(j,{children:L(a.date)}),e.jsx(j,{children:a.description}),e.jsx(j,{children:a.reference||"-"}),e.jsx(j,{children:a.debit_amount>0&&e.jsx("span",{className:"text-red-600",children:x(a.debit_amount)})}),e.jsx(j,{children:a.credit_amount>0&&e.jsx("span",{className:"text-green-600",children:x(a.credit_amount)})}),e.jsx(j,{children:x(a.balance)})]},d))})]}),c.transactions.length>50&&e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:s("Showing first 50 of :total transactions",{total:c.transactions.length})})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(b,{variant:"outline",onClick:()=>S("import"),children:s("Back to Settings")}),e.jsxs(b,{onClick:R,disabled:C||c.summary.errors.length>0,children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),s(C?"Importing...":"Import Statement")]})]})]})})]})]})]})}export{ss as default};
