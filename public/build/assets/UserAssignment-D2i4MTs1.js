import{u as H,r as i,j as e,S as P,A as V}from"./app-BMIA6nir.js";import{A as E,U as I}from"./AppLayout-DbMk6clK.js";import{c as $,B as m}from"./createLucideIcon-Cg8jdX0w.js";import{C as c,c as n,a as q,b as O}from"./card-BAsSN-2Z.js";import{B as o}from"./x-C3KwZK3B.js";import{C as v}from"./checkbox-B8CiFAgv.js";import{I as z}from"./input-Bg5GDATO.js";import{S as G,a as J,b as K,c as Q,d as b}from"./select-B6KOX9nY.js";import{D as W,b as X,c as Y,d as Z,e as M,f as ee}from"./dialog-BAVny-7O.js";import{u as se}from"./useTranslate-ER5gAOX6.js";import{U as x}from"./users-3SuyoAg3.js";import{S as R}from"./shield-DwKJ9Ble.js";import{S as te}from"./search-_p1CX5vB.js";import{F as ae}from"./funnel-v8IwREza.js";import{A as re}from"./arrow-left-UX2kDF52.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./index-Dj2TB_RL.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./bell-5VRgJnzP.js";import"./dollar-sign-Cli0KufN.js";import"./file-text-D25AipK4.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./plus-BjPf5uI-.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],ie=$("user-minus",le);function as({roles:h,userRoleMatrix:k}){se();const w=H(),[a,d]=i.useState([]),[p,u]=i.useState([]),[A,g]=i.useState(!1),[j,U]=i.useState("assign"),[y,D]=i.useState(""),[f,B]=i.useState(""),S=s=>{switch(s){case"admin":return"destructive";case"manager":return"default";case"staff":return"secondary";case"customer":return"outline";default:return"secondary"}},l=k.filter(s=>{const t=s.user.name.toLowerCase().includes(y.toLowerCase())||s.user.email.toLowerCase().includes(y.toLowerCase()),r=!f||s.roles.includes(f);return t&&r}),_=(s,t)=>{d(t?r=>[...r,s]:r=>r.filter(N=>N!==s))},L=s=>{d(s?l.map(t=>t.user.id):[])},F=(s,t)=>{u(t?r=>[...r,s]:r=>r.filter(N=>N!==s))},T=()=>{if(a.length===0||p.length===0){alert("Please select users and roles.");return}V.post(w("admin.roles.bulk-assign-users"),{user_ids:a,role_ids:p,action:j},{onSuccess:()=>{d([]),u([]),g(!1)}})},C=s=>{if(a.length===0){alert("Please select users first.");return}U(s),g(!0)};return e.jsxs(E,{title:"User Role Assignment",renderHeader:()=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(m,{variant:"outline",asChild:!0,children:e.jsxs("a",{href:w("admin.roles.index"),children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Back to Roles"]})}),e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"User Role Assignment"})]}),a.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{variant:"outline",onClick:()=>C("assign"),children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Assign Roles (",a.length,")"]}),e.jsxs(m,{variant:"outline",onClick:()=>C("remove"),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Remove Roles (",a.length,")"]})]})]}),children:[e.jsx(P,{title:"User Role Assignment"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(c,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:k.length})]})]})})}),e.jsx(c,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Available Roles"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:h.length})]})]})})}),e.jsx(c,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Selected Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:a.length})]})]})})}),e.jsx(c,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"System Roles"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:h.filter(s=>s.is_system_role).length})]})]})})})]}),e.jsx(c,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(z,{placeholder:"Search users...",value:y,onChange:s=>D(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-gray-400"}),e.jsxs(G,{value:f,onValueChange:B,children:[e.jsx(J,{className:"w-48",children:e.jsx(K,{placeholder:"Filter by role"})}),e.jsxs(Q,{children:[e.jsx(b,{value:"none",children:"All roles"}),h.map(s=>e.jsx(b,{value:s.name,children:s.name},s.id))]})]})]})]})})}),e.jsxs(c,{children:[e.jsx(q,{children:e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-5 w-5"}),"User Role Matrix",e.jsxs(o,{variant:"secondary",children:[l.length," users"]})]})}),e.jsxs(n,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider w-12",children:e.jsx(v,{checked:l.length>0&&l.every(s=>a.includes(s.user.id)),onCheckedChange:L})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Current Roles"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Member Since"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:l.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(v,{checked:a.includes(s.user.id),onCheckedChange:t=>_(s.user.id,!!t)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:s.user.name}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.user.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.roles.length>0?s.roles.map(t=>e.jsx(o,{variant:S(t),children:t},t)):e.jsx(o,{variant:"outline",children:"No roles"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(s.user.created_at).toLocaleDateString()})]},s.user.id))})]})}),l.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(x,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100",children:"No users found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Try adjusting your search or filter criteria."})]})]})]})]})}),e.jsx(W,{open:A,onOpenChange:g,children:e.jsxs(X,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:j==="assign"?"Assign Roles":"Remove Roles"}),e.jsx(M,{children:j==="assign"?`Select roles to assign to ${a.length} selected user(s).`:`Select roles to remove from ${a.length} selected user(s).`})]}),e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 gap-3",children:h.map(s=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded",children:[e.jsx(v,{checked:p.includes(s.id),onCheckedChange:t=>F(s.id,!!t)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx(o,{variant:S(s.name),children:s.name}),s.is_system_role&&e.jsx(o,{variant:"outline",children:"System"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s.description||"No description"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[s.users_count," users currently have this role"]})]})]},s.id))})}),e.jsxs(ee,{children:[e.jsx(m,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(m,{onClick:T,disabled:p.length===0,children:j==="assign"?"Assign Roles":"Remove Roles"})]})]})})]})}export{as as default};
