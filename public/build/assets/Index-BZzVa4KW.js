var Oe=Object.defineProperty;var We=(t,r,s)=>r in t?Oe(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s;var de=(t,r,s)=>We(t,typeof r!="symbol"?r+"":r,s);import{r as l,j as e,R as Be,S as Fe}from"./app-BMIA6nir.js";import{C as K,a as me,b as fe,d as xe,c as Z}from"./card-BAsSN-2Z.js";import{B as U,U as qe}from"./x-C3KwZK3B.js";import{c as pe,B as b,u as I,P as B,a as ge}from"./createLucideIcon-Cg8jdX0w.js";import{T as z}from"./triangle-alert-BWIpgUmg.js";import{R as Ue}from"./refresh-cw-CkrxGXg9.js";import{I as be}from"./input-Bg5GDATO.js";import{P as V}from"./index-DgfI6AGt.js";import{c as Xe,u as Ye}from"./index-DdwO_6Rs.js";import{u as k}from"./index-DwXxsQvB.js";import{b as Ve}from"./index-BeGDJhOY.js";import{e as $e,S as Je,a as Ge,b as Qe,c as Ke,d as q}from"./select-B6KOX9nY.js";import{c as A}from"./index-BN56TOeV.js";import{S as he}from"./separator-DnQonHW9.js";import{T as ve}from"./textarea-CP26afIU.js";import{L as O}from"./label-CM6YsqH1.js";import{D as ee,b as te,c as re,d as se,e as ne,f as oe}from"./dialog-BAVny-7O.js";import{T as we}from"./thumbs-up-BgoIjls2.js";import{T as Se}from"./thumbs-down-SVKOui9E.js";import{B as je}from"./bot-COuCQh0r.js";import{E as Ze}from"./external-link-DiDOWbPw.js";import{T as ye}from"./ticket-B_Ks_Sjf.js";import{S as et}from"./send-C-AP4C9s.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";import"./chevron-down-CrO8JO_i.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],rt=pe("wifi-off",tt);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],nt=pe("wifi",st);var ot={};function at(){const[t,r]=l.useState(null),[s,a]=l.useState(!1),n=async()=>{a(!0);try{const o=await fetch(`${ot.NEXT_PUBLIC_API_URL}/support/chatbot/suggestions`,{method:"GET",credentials:"include",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});r(o.ok)}catch{r(!1)}finally{a(!1)}};return l.useEffect(()=>{n();const o=setInterval(n,3e4);return()=>clearInterval(o)},[]),t===null?e.jsxs(U,{variant:"secondary",className:"text-xs",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-pulse mr-1"}),"Connecting..."]}):e.jsx(U,{variant:t?"default":"destructive",className:"text-xs",children:t?e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"w-3 h-3 mr-1"}),"Connected"]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-3 h-3 mr-1"}),"Disconnected"]})})}class lt extends Be.Component{constructor(s){super(s);de(this,"retry",()=>{this.setState({hasError:!1,error:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,a){console.error("Chatbot Error:",s,a)}render(){if(this.state.hasError){const s=this.props.fallback||it;return e.jsx(s,{error:this.state.error,retry:this.retry})}return this.props.children}}function it({error:t,retry:r}){return e.jsxs(K,{className:"m-4",children:[e.jsxs(me,{children:[e.jsxs(fe,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(z,{className:"w-5 h-5"}),"Something went wrong"]}),e.jsx(xe,{children:"The chatbot encountered an error. Please try refreshing or contact support if the problem persists."})]}),e.jsxs(Z,{children:[t&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded text-sm text-red-700",children:[e.jsx("strong",{children:"Error:"})," ",t.message]}),e.jsxs(b,{onClick:r,className:"w-full",children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})]})}function ct(t,r){return l.useReducer((s,a)=>r[s][a]??s,t)}var ae="ScrollArea",[Ce,sr]=Xe(ae),[dt,j]=Ce(ae),Ne=l.forwardRef((t,r)=>{const{__scopeScrollArea:s,type:a="hover",dir:n,scrollHideDelay:o=600,...i}=t,[c,d]=l.useState(null),[u,h]=l.useState(null),[m,f]=l.useState(null),[p,v]=l.useState(null),[C,H]=l.useState(null),[N,T]=l.useState(0),[M,D]=l.useState(0),[P,R]=l.useState(!1),[_,E]=l.useState(!1),g=I(r,x=>d(x)),w=Ve(n);return e.jsx(dt,{scope:s,type:a,dir:w,scrollHideDelay:o,scrollArea:c,viewport:u,onViewportChange:h,content:m,onContentChange:f,scrollbarX:p,onScrollbarXChange:v,scrollbarXEnabled:P,onScrollbarXEnabledChange:R,scrollbarY:C,onScrollbarYChange:H,scrollbarYEnabled:_,onScrollbarYEnabledChange:E,onCornerWidthChange:T,onCornerHeightChange:D,children:e.jsx(B.div,{dir:w,...i,ref:g,style:{position:"relative","--radix-scroll-area-corner-width":N+"px","--radix-scroll-area-corner-height":M+"px",...t.style}})})});Ne.displayName=ae;var Te="ScrollAreaViewport",Pe=l.forwardRef((t,r)=>{const{__scopeScrollArea:s,children:a,nonce:n,...o}=t,i=j(Te,s),c=l.useRef(null),d=I(r,c,i.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(B.div,{"data-radix-scroll-area-viewport":"",...o,ref:d,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e.jsx("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});Pe.displayName=Te;var y="ScrollAreaScrollbar",le=l.forwardRef((t,r)=>{const{forceMount:s,...a}=t,n=j(y,t.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:i}=n,c=t.orientation==="horizontal";return l.useEffect(()=>(c?o(!0):i(!0),()=>{c?o(!1):i(!1)}),[c,o,i]),n.type==="hover"?e.jsx(ht,{...a,ref:r,forceMount:s}):n.type==="scroll"?e.jsx(ut,{...a,ref:r,forceMount:s}):n.type==="auto"?e.jsx(Re,{...a,ref:r,forceMount:s}):n.type==="always"?e.jsx(ie,{...a,ref:r}):null});le.displayName=y;var ht=l.forwardRef((t,r)=>{const{forceMount:s,...a}=t,n=j(y,t.__scopeScrollArea),[o,i]=l.useState(!1);return l.useEffect(()=>{const c=n.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),i(!0)},h=()=>{d=window.setTimeout(()=>i(!1),n.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",h),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",h)}}},[n.scrollArea,n.scrollHideDelay]),e.jsx(V,{present:s||o,children:e.jsx(Re,{"data-state":o?"visible":"hidden",...a,ref:r})})}),ut=l.forwardRef((t,r)=>{const{forceMount:s,...a}=t,n=j(y,t.__scopeScrollArea),o=t.orientation==="horizontal",i=J(()=>d("SCROLL_END"),100),[c,d]=ct("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return l.useEffect(()=>{if(c==="idle"){const u=window.setTimeout(()=>d("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(u)}},[c,n.scrollHideDelay,d]),l.useEffect(()=>{const u=n.viewport,h=o?"scrollLeft":"scrollTop";if(u){let m=u[h];const f=()=>{const p=u[h];m!==p&&(d("SCROLL"),i()),m=p};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[n.viewport,o,d,i]),e.jsx(V,{present:s||c!=="hidden",children:e.jsx(ie,{"data-state":c==="hidden"?"hidden":"visible",...a,ref:r,onPointerEnter:A(t.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:A(t.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),Re=l.forwardRef((t,r)=>{const s=j(y,t.__scopeScrollArea),{forceMount:a,...n}=t,[o,i]=l.useState(!1),c=t.orientation==="horizontal",d=J(()=>{if(s.viewport){const u=s.viewport.offsetWidth<s.viewport.scrollWidth,h=s.viewport.offsetHeight<s.viewport.scrollHeight;i(c?u:h)}},10);return L(s.viewport,d),L(s.content,d),e.jsx(V,{present:a||o,children:e.jsx(ie,{"data-state":o?"visible":"hidden",...n,ref:r})})}),ie=l.forwardRef((t,r)=>{const{orientation:s="vertical",...a}=t,n=j(y,t.__scopeScrollArea),o=l.useRef(null),i=l.useRef(0),[c,d]=l.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=_e(c.viewport,c.content),h={...a,sizes:c,onSizesChange:d,hasThumb:u>0&&u<1,onThumbChange:f=>o.current=f,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:f=>i.current=f};function m(f,p){return bt(f,i.current,c,p)}return s==="horizontal"?e.jsx(mt,{...h,ref:r,onThumbPositionChange:()=>{if(n.viewport&&o.current){const f=n.viewport.scrollLeft,p=ue(f,c,n.dir);o.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:f=>{n.viewport&&(n.viewport.scrollLeft=f)},onDragScroll:f=>{n.viewport&&(n.viewport.scrollLeft=m(f,n.dir))}}):s==="vertical"?e.jsx(ft,{...h,ref:r,onThumbPositionChange:()=>{if(n.viewport&&o.current){const f=n.viewport.scrollTop,p=ue(f,c);o.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:f=>{n.viewport&&(n.viewport.scrollTop=f)},onDragScroll:f=>{n.viewport&&(n.viewport.scrollTop=m(f))}}):null}),mt=l.forwardRef((t,r)=>{const{sizes:s,onSizesChange:a,...n}=t,o=j(y,t.__scopeScrollArea),[i,c]=l.useState(),d=l.useRef(null),u=I(r,d,o.onScrollbarXChange);return l.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),e.jsx(ke,{"data-orientation":"horizontal",...n,ref:u,sizes:s,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":$(s)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.x),onDragScroll:h=>t.onDragScroll(h.x),onWheelScroll:(h,m)=>{if(o.viewport){const f=o.viewport.scrollLeft+h.deltaX;t.onWheelScroll(f),Ie(f,m)&&h.preventDefault()}},onResize:()=>{d.current&&o.viewport&&i&&a({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:Y(i.paddingLeft),paddingEnd:Y(i.paddingRight)}})}})}),ft=l.forwardRef((t,r)=>{const{sizes:s,onSizesChange:a,...n}=t,o=j(y,t.__scopeScrollArea),[i,c]=l.useState(),d=l.useRef(null),u=I(r,d,o.onScrollbarYChange);return l.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),e.jsx(ke,{"data-orientation":"vertical",...n,ref:u,sizes:s,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":$(s)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.y),onDragScroll:h=>t.onDragScroll(h.y),onWheelScroll:(h,m)=>{if(o.viewport){const f=o.viewport.scrollTop+h.deltaY;t.onWheelScroll(f),Ie(f,m)&&h.preventDefault()}},onResize:()=>{d.current&&o.viewport&&i&&a({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:Y(i.paddingTop),paddingEnd:Y(i.paddingBottom)}})}})}),[xt,Ee]=Ce(y),ke=l.forwardRef((t,r)=>{const{__scopeScrollArea:s,sizes:a,hasThumb:n,onThumbChange:o,onThumbPointerUp:i,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:h,onResize:m,...f}=t,p=j(y,s),[v,C]=l.useState(null),H=I(r,g=>C(g)),N=l.useRef(null),T=l.useRef(""),M=p.viewport,D=a.content-a.viewport,P=k(h),R=k(d),_=J(m,10);function E(g){if(N.current){const w=g.clientX-N.current.left,x=g.clientY-N.current.top;u({x:w,y:x})}}return l.useEffect(()=>{const g=w=>{const x=w.target;(v==null?void 0:v.contains(x))&&P(w,D)};return document.addEventListener("wheel",g,{passive:!1}),()=>document.removeEventListener("wheel",g,{passive:!1})},[M,v,D,P]),l.useEffect(R,[a,R]),L(v,_),L(p.content,_),e.jsx(xt,{scope:s,scrollbar:v,hasThumb:n,onThumbChange:k(o),onThumbPointerUp:k(i),onThumbPositionChange:R,onThumbPointerDown:k(c),children:e.jsx(B.div,{...f,ref:H,style:{position:"absolute",...f.style},onPointerDown:A(t.onPointerDown,g=>{g.button===0&&(g.target.setPointerCapture(g.pointerId),N.current=v.getBoundingClientRect(),T.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),E(g))}),onPointerMove:A(t.onPointerMove,E),onPointerUp:A(t.onPointerUp,g=>{const w=g.target;w.hasPointerCapture(g.pointerId)&&w.releasePointerCapture(g.pointerId),document.body.style.webkitUserSelect=T.current,p.viewport&&(p.viewport.style.scrollBehavior=""),N.current=null})})})}),X="ScrollAreaThumb",Ae=l.forwardRef((t,r)=>{const{forceMount:s,...a}=t,n=Ee(X,t.__scopeScrollArea);return e.jsx(V,{present:s||n.hasThumb,children:e.jsx(pt,{ref:r,...a})})}),pt=l.forwardRef((t,r)=>{const{__scopeScrollArea:s,style:a,...n}=t,o=j(X,s),i=Ee(X,s),{onThumbPositionChange:c}=i,d=I(r,m=>i.onThumbChange(m)),u=l.useRef(void 0),h=J(()=>{u.current&&(u.current(),u.current=void 0)},100);return l.useEffect(()=>{const m=o.viewport;if(m){const f=()=>{if(h(),!u.current){const p=vt(m,c);u.current=p,c()}};return c(),m.addEventListener("scroll",f),()=>m.removeEventListener("scroll",f)}},[o.viewport,h,c]),e.jsx(B.div,{"data-state":i.hasThumb?"visible":"hidden",...n,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:A(t.onPointerDownCapture,m=>{const p=m.target.getBoundingClientRect(),v=m.clientX-p.left,C=m.clientY-p.top;i.onThumbPointerDown({x:v,y:C})}),onPointerUp:A(t.onPointerUp,i.onThumbPointerUp)})});Ae.displayName=X;var ce="ScrollAreaCorner",De=l.forwardRef((t,r)=>{const s=j(ce,t.__scopeScrollArea),a=!!(s.scrollbarX&&s.scrollbarY);return s.type!=="scroll"&&a?e.jsx(gt,{...t,ref:r}):null});De.displayName=ce;var gt=l.forwardRef((t,r)=>{const{__scopeScrollArea:s,...a}=t,n=j(ce,s),[o,i]=l.useState(0),[c,d]=l.useState(0),u=!!(o&&c);return L(n.scrollbarX,()=>{var m;const h=((m=n.scrollbarX)==null?void 0:m.offsetHeight)||0;n.onCornerHeightChange(h),d(h)}),L(n.scrollbarY,()=>{var m;const h=((m=n.scrollbarY)==null?void 0:m.offsetWidth)||0;n.onCornerWidthChange(h),i(h)}),u?e.jsx(B.div,{...a,ref:r,style:{width:o,height:c,position:"absolute",right:n.dir==="ltr"?0:void 0,left:n.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Y(t){return t?parseInt(t,10):0}function _e(t,r){const s=t/r;return isNaN(s)?0:s}function $(t){const r=_e(t.viewport,t.content),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=(t.scrollbar.size-s)*r;return Math.max(a,18)}function bt(t,r,s,a="ltr"){const n=$(s),o=n/2,i=r||o,c=n-i,d=s.scrollbar.paddingStart+i,u=s.scrollbar.size-s.scrollbar.paddingEnd-c,h=s.content-s.viewport,m=a==="ltr"?[0,h]:[h*-1,0];return Le([d,u],m)(t)}function ue(t,r,s="ltr"){const a=$(r),n=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,o=r.scrollbar.size-n,i=r.content-r.viewport,c=o-a,d=s==="ltr"?[0,i]:[i*-1,0],u=$e(t,d);return Le([0,i],[0,c])(u)}function Le(t,r){return s=>{if(t[0]===t[1]||r[0]===r[1])return r[0];const a=(r[1]-r[0])/(t[1]-t[0]);return r[0]+a*(s-t[0])}}function Ie(t,r){return t>0&&t<r}var vt=(t,r=()=>{})=>{let s={left:t.scrollLeft,top:t.scrollTop},a=0;return function n(){const o={left:t.scrollLeft,top:t.scrollTop},i=s.left!==o.left,c=s.top!==o.top;(i||c)&&r(),s=o,a=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(a)};function J(t,r){const s=k(t),a=l.useRef(0);return l.useEffect(()=>()=>window.clearTimeout(a.current),[]),l.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(s,r)},[s,r])}function L(t,r){const s=k(r);Ye(()=>{let a=0;if(t){const n=new ResizeObserver(()=>{cancelAnimationFrame(a),a=window.requestAnimationFrame(s)});return n.observe(t),()=>{window.cancelAnimationFrame(a),n.unobserve(t)}}},[t,s])}var He=Ne,wt=Pe,St=De;const Me=l.forwardRef(({className:t,children:r,...s},a)=>e.jsxs(He,{ref:a,className:ge("relative overflow-hidden",t),...s,children:[e.jsx(wt,{className:"h-full w-full rounded-[inherit]",children:r}),e.jsx(ze,{}),e.jsx(St,{})]}));Me.displayName=He.displayName;const ze=l.forwardRef(({className:t,orientation:r="vertical",...s},a)=>e.jsx(le,{ref:a,orientation:r,className:ge("flex touch-none select-none transition-colors",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...s,children:e.jsx(Ae,{className:"relative flex-1 rounded-full bg-border"})}));ze.displayName=le.displayName;const jt="http://localhost:8000";class yt{async request(r,s={}){const a=`${jt}/support/chatbot${r}`,n=await fetch(a,{credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...s.headers},...s});if(!n.ok){const o=await n.json().catch(()=>({}));throw new Error(o.message||`API request failed: ${n.statusText}`)}return n.json()}async sendMessage(r){return this.request("/chat",{method:"POST",body:JSON.stringify(r)})}async getConversation(r){return this.request(`/conversation?conversation_id=${r}`)}async getSuggestions(){return this.request("/suggestions")}async rateResponse(r){return this.request("/rate",{method:"POST",body:JSON.stringify(r)})}async createTicket(r){return this.request("/create-ticket",{method:"POST",body:JSON.stringify(r)})}async escalateToHuman(r){return this.request("/escalate",{method:"POST",body:JSON.stringify(r)})}}const W=new yt;function Ct({open:t,onOpenChange:r,conversationId:s,messageIndex:a}){const[n,o]=l.useState(null),[i,c]=l.useState(""),[d,u]=l.useState(!1),h=async()=>{if(!(!s||a===null||!n)){u(!0);try{await W.rateResponse({conversation_id:s,message_index:a,rating:n,feedback:i.trim()||void 0}),r(!1),o(null),c("")}catch{}finally{u(!1)}}};return e.jsx(ee,{open:t,onOpenChange:r,children:e.jsxs(te,{className:"sm:max-w-[425px]",children:[e.jsxs(re,{children:[e.jsx(se,{children:"Rate this response"}),e.jsx(ne,{children:"Help us improve by rating how helpful this response was."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(O,{className:"text-sm font-medium",children:"Was this response helpful?"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs(b,{variant:n==="helpful"?"default":"outline",onClick:()=>o("helpful"),className:"flex-1",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Helpful"]}),e.jsxs(b,{variant:n==="not_helpful"?"default":"outline",onClick:()=>o("not_helpful"),className:"flex-1",children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Not Helpful"]})]})]}),e.jsxs("div",{children:[e.jsx(O,{htmlFor:"feedback",className:"text-sm font-medium",children:"Additional feedback (optional)"}),e.jsx(ve,{id:"feedback",value:i,onChange:m=>c(m.target.value),placeholder:"Tell us how we can improve...",className:"mt-1",maxLength:500}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[i.length,"/500 characters"]})]})]}),e.jsxs(oe,{children:[e.jsx(b,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(b,{onClick:h,disabled:!n||d,children:d?"Submitting...":"Submit Rating"})]})]})})}function Nt({open:t,onOpenChange:r,conversationId:s}){const[a,n]=l.useState(""),[o,i]=l.useState("medium"),[c,d]=l.useState(!1),u=async()=>{if(!(!s||!a.trim())){d(!0);try{const h=await W.createTicket({conversation_id:s,title:a.trim(),priority:o,category_id:void 0});r(!1),n(""),i("medium")}catch{}finally{d(!1)}}};return e.jsx(ee,{open:t,onOpenChange:r,children:e.jsxs(te,{className:"sm:max-w-[425px]",children:[e.jsxs(re,{children:[e.jsx(se,{children:"Create Support Ticket"}),e.jsx(ne,{children:"Create a support ticket from this conversation. Our team will review it and get back to you."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(O,{htmlFor:"title",className:"text-sm font-medium",children:"Ticket Title *"}),e.jsx(be,{id:"title",value:a,onChange:h=>n(h.target.value),placeholder:"Brief description of your issue",className:"mt-1",maxLength:255})]}),e.jsxs("div",{children:[e.jsx(O,{htmlFor:"priority",className:"text-sm font-medium",children:"Priority"}),e.jsxs(Je,{value:o,onValueChange:h=>i(h),children:[e.jsx(Ge,{className:"mt-1",children:e.jsx(Qe,{})}),e.jsxs(Ke,{children:[e.jsx(q,{value:"low",children:"Low"}),e.jsx(q,{value:"medium",children:"Medium"}),e.jsx(q,{value:"high",children:"High"}),e.jsx(q,{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded",children:[e.jsx("p",{className:"font-medium mb-1",children:"What happens next?"}),e.jsxs("ul",{className:"text-xs space-y-1",children:[e.jsx("li",{children:"• Your conversation will be included in the ticket"}),e.jsx("li",{children:"• Our AI will automatically categorize your issue"}),e.jsx("li",{children:"• You'll receive email updates on progress"}),e.jsx("li",{children:"• A support agent will review and respond"})]})]})]}),e.jsxs(oe,{children:[e.jsx(b,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(b,{onClick:u,disabled:!a.trim()||c,children:c?"Creating...":"Create Ticket"})]})]})})}function Tt({open:t,onOpenChange:r,conversationId:s}){const[a,n]=l.useState(""),[o,i]=l.useState(!1),c=async()=>{if(s){i(!0);try{await W.escalateToHuman({conversation_id:s,reason:a.trim()||void 0}),r(!1),n("")}catch{}finally{i(!1)}}};return e.jsx(ee,{open:t,onOpenChange:r,children:e.jsxs(te,{className:"sm:max-w-[425px]",children:[e.jsxs(re,{children:[e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-orange-500"}),"Connect with Human Agent"]}),e.jsx(ne,{children:"We'll connect you with a human agent who can provide more personalized assistance."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(O,{htmlFor:"reason",className:"text-sm font-medium",children:"Reason for escalation (optional)"}),e.jsx(ve,{id:"reason",value:a,onChange:d=>n(d.target.value),placeholder:"Let us know why you need human assistance...",className:"mt-1",maxLength:500}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.length,"/500 characters"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 bg-blue-50 p-3 rounded",children:[e.jsx("p",{className:"font-medium mb-1",children:"What to expect:"}),e.jsxs("ul",{className:"text-xs space-y-1",children:[e.jsx("li",{children:"• A human agent will review your conversation"}),e.jsx("li",{children:"• Response time: typically 5-15 minutes"}),e.jsx("li",{children:"• You'll be notified when an agent joins"}),e.jsx("li",{children:"• Your conversation history will be preserved"})]})]})]}),e.jsxs(oe,{children:[e.jsx(b,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(b,{onClick:c,disabled:o,children:o?"Connecting...":"Connect with Agent"})]})]})})}function Pt({suggestions:t,onSuggestionClick:r}){return e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map((s,a)=>e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>r(s),className:"text-left justify-start h-auto p-3 flex-col items-start",children:[e.jsx("span",{className:"text-sm",children:s.text}),e.jsx(U,{variant:"secondary",className:"text-xs mt-1",children:s.category})]},a))})}function Rt({message:t,onRate:r,onCreateTicket:s,onEscalate:a}){const n=t.role==="user";return e.jsxs("div",{className:`flex gap-3 ${n?"flex-row-reverse":"flex-row"}`,children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${n?"bg-blue-600":"bg-gray-600"}`,children:n?e.jsx(qe,{className:"w-4 h-4 text-white"}):e.jsx(je,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:`flex-1 max-w-[80%] ${n?"text-right":"text-left"}`,children:[e.jsx(K,{className:`${n?"bg-blue-600 text-white":"bg-white text-gray-800"}`,children:e.jsxs(Z,{className:"p-3",children:[e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:t.message}),t.intent&&!n&&e.jsx("div",{className:"mt-2",children:e.jsx(U,{variant:"secondary",className:"text-xs",children:t.intent.replace("_"," ")})}),t.confidence&&!n&&e.jsx("div",{className:"mt-1",children:e.jsxs("span",{className:"text-xs text-gray-500",children:["Confidence: ",Math.round(t.confidence*100),"%"]})}),t.suggestions&&t.suggestions.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"You might also try:"}),e.jsx("ul",{className:"text-xs space-y-1",children:t.suggestions.map((o,i)=>e.jsxs("li",{className:"text-gray-700",children:["• ",o]},i))})]}),t.actions&&t.actions.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:t.actions.map((o,i)=>e.jsxs(b,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>{o.type==="link"&&o.url?window.open(o.url,"_blank"):o.action==="create_ticket"?s():o.action==="escalate"&&a()},children:[o.type==="link"&&e.jsx(Ze,{className:"w-3 h-3 mr-1"}),o.action==="create_ticket"&&e.jsx(ye,{className:"w-3 h-3 mr-1"}),o.action==="escalate"&&e.jsx(z,{className:"w-3 h-3 mr-1"}),o.label]},i))}),t.requiresHuman&&e.jsxs("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded text-yellow-800 text-xs",children:[e.jsx(z,{className:"w-3 h-3 inline mr-1"}),"This issue may require human assistance"]})]})}),!n&&e.jsxs("div",{className:"flex gap-1 mt-2 justify-start",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:r,className:"h-6 w-6 p-0 hover:bg-green-100",children:e.jsx(we,{className:"w-3 h-3"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:r,className:"h-6 w-6 p-0 hover:bg-red-100",children:e.jsx(Se,{className:"w-3 h-3"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(t.timestamp).toLocaleTimeString()})]})]})}function Et(){const[t,r]=l.useState([]),[s,a]=l.useState(""),[n,o]=l.useState(!1),[i,c]=l.useState(null),[d,u]=l.useState([]),[h,m]=l.useState(!1),[f,p]=l.useState(!1),[v,C]=l.useState(!1),[H,N]=l.useState(null),T=l.useRef(null);l.useEffect(()=>{D(),r([{id:"1",role:"assistant",message:"Hello! I'm here to help you with any questions or issues you might have. How can I assist you today?",timestamp:new Date().toISOString(),intent:"greeting"}])},[]),l.useEffect(()=>{M()},[t]);const M=()=>{if(T.current){const x=T.current.querySelector("[data-radix-scroll-area-viewport]");x&&(x.scrollTop=x.scrollHeight)}},D=async()=>{try{const x=await W.getSuggestions();u(x.suggestions)}catch(x){console.error("Failed to load suggestions:",x)}},P=async x=>{if(!x.trim()||n)return;const F={id:Date.now().toString(),role:"user",message:x.trim(),timestamp:new Date().toISOString()};r(S=>[...S,F]),a(""),o(!0);try{const S=await W.sendMessage({message:x.trim(),conversation_id:i,context:{}});i||c(S.conversation_id);const G={id:(Date.now()+1).toString(),role:"assistant",message:S.response,timestamp:new Date().toISOString(),intent:S.intent,suggestions:S.suggestions,actions:S.actions,confidence:S.confidence,requiresHuman:S.requires_human};r(Q=>[...Q,G]),S.requires_human&&C(!0)}catch(S){console.error("Failed to send message:",S);const G={id:(Date.now()+1).toString(),role:"assistant",message:"I'm sorry, I'm having trouble processing your request right now. Please try again or contact support directly.",timestamp:new Date().toISOString(),intent:"error"};r(Q=>[...Q,G])}finally{o(!1)}},R=x=>{P(x.text)},_=x=>{N(x),m(!0)},E=()=>{p(!0)},g=()=>{C(!0)},w=x=>{x.preventDefault(),P(s)};return e.jsxs("div",{className:"flex flex-col h-[600px]",children:[e.jsx(Me,{ref:T,className:"flex-1 p-4",children:e.jsxs("div",{className:"space-y-4",children:[t.map((x,F)=>e.jsx(Rt,{message:x,onRate:()=>_(F),onCreateTicket:E,onEscalate:g},x.id)),n&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})]})}),t.length===1&&d.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(he,{}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Quick suggestions:"}),e.jsx(Pt,{suggestions:d,onSuggestionClick:R})]})]}),e.jsx(he,{}),e.jsxs("div",{className:"p-4",children:[e.jsxs("form",{onSubmit:w,className:"flex gap-2",children:[e.jsx(be,{value:s,onChange:x=>a(x.target.value),placeholder:"Type your message...",disabled:n,className:"flex-1",maxLength:1e3}),e.jsx(b,{type:"submit",disabled:n||!s.trim(),children:e.jsx(et,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[s.length,"/1000 characters"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:E,disabled:!i,children:[e.jsx(ye,{className:"w-3 h-3 mr-1"}),"Create Ticket"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:g,disabled:!i,children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),"Human Help"]})]})]})]}),e.jsx(Ct,{open:h,onOpenChange:m,conversationId:i,messageIndex:H}),e.jsx(Nt,{open:f,onOpenChange:p,conversationId:i}),e.jsx(Tt,{open:v,onOpenChange:C,conversationId:i})]})}function nr(){return e.jsxs("div",{className:"min-h-screen bg-gray-900 p-4",children:[e.jsx(Fe,{title:"Support Agent"}),e.jsxs("div",{className:"container mx-auto max-w-4xl",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-400 mb-2",children:"Support Assistant"}),e.jsx("p",{className:"text-gray-600",children:"Get instant help with your questions and issues"})]}),e.jsxs(K,{className:"shadow-xl",children:[e.jsx(me,{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),"Chat Support"]}),e.jsx(xe,{className:"text-blue-100",children:"Ask me anything about your account, billing, or technical issues"})]}),e.jsx(at,{})]})}),e.jsx(Z,{className:"p-0",children:e.jsx(lt,{children:e.jsx(Et,{})})})]})]})]})}export{nr as default};
