import{u as W,r as Z,j as e,S as q,x as b,A as j}from"./app-BMIA6nir.js";import{A as G}from"./AppLayout-DbMk6clK.js";import{C as d,a as m,b as x,c as h}from"./card-BAsSN-2Z.js";import{c as J,B as p}from"./createLucideIcon-Cg8jdX0w.js";import{I as w}from"./input-Bg5GDATO.js";import{B as S}from"./x-C3KwZK3B.js";import{S as C,a as R,b as T,c as D,d as u}from"./select-B6KOX9nY.js";import{T as K,a as O,b as A,c as o,d as Q,e as c}from"./table-DqBb-9tC.js";import{u as X}from"./useTranslate-ER5gAOX6.js";import{t as v}from"./index-Dj2TB_RL.js";import{A as Y}from"./arrow-left-UX2kDF52.js";import{D as ee}from"./download-CNZP3fGS.js";import{R as M}from"./refresh-cw-CkrxGXg9.js";import{D as se}from"./dollar-sign-Cli0KufN.js";import{C as k}from"./circle-check-big-DCsv6rXk.js";import{T as ae}from"./trending-up-00s2SIxN.js";import{F as ne}from"./funnel-v8IwREza.js";import{S as te}from"./search-_p1CX5vB.js";import{T as re}from"./triangle-alert-BWIpgUmg.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./bell-5VRgJnzP.js";import"./file-text-D25AipK4.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./plus-BjPf5uI-.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M5 12h14",key:"1ays0h"}]],I=J("minus",oe);function os({reconciliation_items:r,summary:t,providers:B,filters:i}){const{t:a}=X(),l=W(),[y,F]=Z.useState(i.search||""),L=s=>{s.preventDefault(),j.get(l("finance.momo.reconciliation"),{...i,search:y})},N=(s,n)=>{j.get(l("finance.momo.reconciliation"),{...i,[s]:n==="all"?"":n})},E=()=>{j.post(l("finance.momo.reconciliation.run"),{},{onSuccess:()=>{v.success(a("finance.momo.reconciliation_started","Reconciliation process started"))},onError:()=>{v.error(a("common.error_occurred","An error occurred"))}})},P=s=>{j.post(l("finance.momo.reconciliation.resolve",s),{},{onSuccess:()=>{v.success(a("finance.momo.discrepancy_resolved","Discrepancy resolved"))},onError:()=>{v.error(a("common.error_occurred","An error occurred"))}})},U=()=>{window.open(l("finance.momo.reconciliation.export",i),"_blank")},z=s=>{const n={matched:{variant:"default",icon:k,color:"text-green-600"},unmatched:{variant:"secondary",icon:I,color:"text-gray-600"},disputed:{variant:"destructive",icon:re,color:"text-red-600"}},g=n[s]||n.unmatched,$=g.icon;return e.jsxs(S,{variant:g.variant,className:"flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),a(`finance.momo.reconciliation.${s}`,s)]})},H=s=>{if(!s)return null;const n={amount_mismatch:{variant:"destructive",color:"text-red-600"},status_mismatch:{variant:"secondary",color:"text-yellow-600"},missing_transaction:{variant:"outline",color:"text-gray-600"},duplicate:{variant:"secondary",color:"text-blue-600"}},g=n[s]||n.missing_transaction;return e.jsx(S,{variant:g.variant,className:"text-xs",children:a(`finance.momo.discrepancy.${s}`,s.replace("_"," "))})},f=(s,n="ZMW")=>new Intl.NumberFormat("en-US",{style:"currency",currency:n}).format(s),V=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),_=s=>`${s.toFixed(1)}%`;return e.jsxs(G,{title:a("finance.momo.reconciliation","Mobile Money Reconciliation"),breadcrumbs:[{label:a("finance.title","Finance"),href:"/finance"},{label:a("finance.momo.title","Mobile Money"),href:"/finance/momo"},{label:a("finance.momo.reconciliation","Reconciliation")}],children:[e.jsx(q,{title:a("finance.momo.reconciliation","Mobile Money Reconciliation")}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(p,{variant:"outline",size:"icon",asChild:!0,children:e.jsx(b,{href:l("finance.momo.index"),children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100",children:a("finance.momo.reconciliation","Mobile Money Reconciliation")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("finance.momo.reconciliation_description","Reconcile transactions with provider records")})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{variant:"outline",onClick:U,children:[e.jsx(ee,{className:"h-4 w-4"}),a("finance.momo.export_report","Export Report")]}),e.jsxs(p,{onClick:E,children:[e.jsx(M,{className:"h-4 w-4"}),a("finance.momo.run_reconciliation","Run Reconciliation")]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(d,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:a("finance.momo.total_transactions","Total Transactions")}),e.jsx(se,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(h,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.total_transactions.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:f(t.total_amount)})]})]}),e.jsxs(d,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:a("finance.momo.matched_transactions","Matched")}),e.jsx(k,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(h,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.matched_transactions.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:f(t.matched_amount)})]})]}),e.jsxs(d,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:a("finance.momo.unmatched_transactions","Unmatched")}),e.jsx(I,{className:"h-4 w-4 text-gray-600"})]}),e.jsxs(h,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:t.unmatched_transactions.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:_(t.unmatched_transactions/t.total_transactions*100)})]})]}),e.jsxs(d,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:a("finance.momo.reconciliation_rate","Reconciliation Rate")}),e.jsx(ae,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(h,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:_(t.reconciliation_rate)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.discrepancy_amount>0&&e.jsxs("span",{className:"text-red-600",children:[f(t.discrepancy_amount)," discrepancy"]})})]})]})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),a("common.filters","Filters")]})}),e.jsx(h,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[e.jsx("form",{onSubmit:L,className:"lg:col-span-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{placeholder:a("finance.momo.search_placeholder","Search transactions..."),value:y,onChange:s=>F(s.target.value),className:"flex-1"}),e.jsx(p,{type:"submit",size:"icon",variant:"outline",children:e.jsx(te,{className:"h-4 w-4"})})]})}),e.jsxs(C,{value:i.provider_id||"all",onValueChange:s=>N("provider_id",s),children:[e.jsx(R,{children:e.jsx(T,{placeholder:a("finance.momo.all_providers","All Providers")})}),e.jsxs(D,{children:[e.jsx(u,{value:"all",children:a("finance.momo.all_providers","All Providers")}),B.map(s=>e.jsx(u,{value:s.id.toString(),children:s.display_name},s.id))]})]}),e.jsxs(C,{value:i.status||"all",onValueChange:s=>N("status",s),children:[e.jsx(R,{children:e.jsx(T,{placeholder:a("finance.momo.all_statuses","All Statuses")})}),e.jsxs(D,{children:[e.jsx(u,{value:"all",children:a("finance.momo.all_statuses","All Statuses")}),e.jsx(u,{value:"matched",children:a("finance.momo.reconciliation.matched","Matched")}),e.jsx(u,{value:"unmatched",children:a("finance.momo.reconciliation.unmatched","Unmatched")}),e.jsx(u,{value:"disputed",children:a("finance.momo.reconciliation.disputed","Disputed")})]})]}),e.jsx(w,{type:"date",placeholder:a("common.date_from","Date From"),value:i.date_from||"",onChange:s=>N("date_from",s.target.value)})]})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),a("finance.momo.reconciliation_items","Reconciliation Items")]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.from,"-",r.to," of ",r.total]})]})}),e.jsxs(h,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(K,{children:[e.jsx(O,{children:e.jsxs(A,{children:[e.jsx(o,{children:a("finance.momo.provider_reference","Provider Ref")}),e.jsx(o,{children:a("finance.momo.internal_transaction","Internal Transaction")}),e.jsx(o,{children:a("finance.momo.amount","Amount")}),e.jsx(o,{children:a("finance.momo.status_comparison","Status Comparison")}),e.jsx(o,{children:a("finance.momo.reconciliation_status","Reconciliation")}),e.jsx(o,{children:a("finance.momo.discrepancy","Discrepancy")}),e.jsx(o,{children:a("finance.momo.date","Date")}),e.jsx(o,{className:"w-[50px]"})]})}),e.jsx(Q,{children:r.data.map(s=>e.jsxs(A,{children:[e.jsx(c,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-mono text-sm",children:s.provider_transaction_id}),s.provider_reference&&e.jsx("div",{className:"text-xs text-gray-500",children:s.provider_reference})]})}),e.jsx(c,{children:s.transaction?e.jsxs("div",{children:[e.jsx(b,{href:l("finance.momo.show",s.transaction.id),className:"font-medium text-blue-600 hover:underline",children:s.transaction.transaction_number}),e.jsx("div",{className:"text-xs text-gray-500",children:s.transaction.phone_number})]}):e.jsx("span",{className:"text-gray-400 text-sm",children:"No match"})}),e.jsx(c,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:f(s.amount,s.currency)}),s.discrepancy_amount&&s.discrepancy_amount!==0&&e.jsxs("div",{className:"text-xs text-red-600",children:["Δ ",f(s.discrepancy_amount,s.currency)]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Provider:"})," ",s.provider_status]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Internal:"})," ",s.internal_status]})]})}),e.jsx(c,{children:z(s.status)}),e.jsx(c,{children:H(s.discrepancy_type)}),e.jsx(c,{className:"text-sm text-gray-600 dark:text-gray-400",children:V(s.transaction_date)}),e.jsx(c,{children:s.status==="disputed"&&e.jsx(p,{variant:"outline",size:"sm",onClick:()=>P(s.id),children:a("finance.momo.resolve","Resolve")})})]},s.id))})]})}),r.links&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",r.from," to ",r.to," of ",r.total," results"]}),e.jsx("div",{className:"flex gap-2",children:r.links.map((s,n)=>e.jsx(p,{variant:s.active?"default":"outline",size:"sm",disabled:!s.url,onClick:()=>s.url&&j.get(s.url),dangerouslySetInnerHTML:{__html:s.label}},n))})]})]})]})]})]})}export{os as default};
