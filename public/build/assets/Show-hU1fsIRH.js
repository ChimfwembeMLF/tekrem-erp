import{u as Q,j as e,S as U,x as l,A as h}from"./app-BMIA6nir.js";import{A as H,R as M}from"./AppLayout-DbMk6clK.js";import{C as d,a as m,b as o,c as x}from"./card-BAsSN-2Z.js";import{B as t}from"./createLucideIcon-Cg8jdX0w.js";import{B as f,U as V}from"./x-C3KwZK3B.js";import{T as X,a as G,b as k,c as j,d as J,e as p}from"./table-DqBb-9tC.js";import{u as K}from"./useTranslate-ER5gAOX6.js";import{t as i}from"./index-Dj2TB_RL.js";import{A as O}from"./arrow-left-UX2kDF52.js";import{S as b}from"./shield-DwKJ9Ble.js";import{R as T}from"./refresh-cw-CkrxGXg9.js";import{C as g}from"./circle-x-D-Fm_LhT.js";import{S as W}from"./send-C-AP4C9s.js";import{D as Z}from"./download-CNZP3fGS.js";import{S as Y}from"./square-pen-CReBrXbl.js";import{M as ee}from"./mail-CApE3o7R.js";import{P as se}from"./phone-347MTOqH.js";import{B as ae}from"./building-DIkCZBBP.js";import{F as re}from"./file-text-D25AipK4.js";import{Q as te}from"./qr-code-DGVtFBDO.js";import{E as ne}from"./external-link-DiDOWbPw.js";import{T as ce}from"./triangle-alert-BWIpgUmg.js";import{E as ie}from"./eye-DdivFxyT.js";import{D as le}from"./dollar-sign-Cli0KufN.js";import{C as de}from"./NotificationComponent-CHA3vjZG.js";import{C as me}from"./circle-check-big-DCsv6rXk.js";import{C as I}from"./clock-BTinGqFV.js";import"./useTypedPage-hmuARwun.js";import"./sheet-1SUjjT9Y.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./plus-BjPf5uI-.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./bell-5VRgJnzP.js";function xs({invoice:s}){var z,v,C,S,A,R;const{t:a}=K(),n=Q(),P=()=>{h.post(n("finance.invoices.send",s.id),{},{onSuccess:()=>{i.success(a("finance.invoice_sent","Invoice sent successfully"))},onError:()=>{i.error(a("common.error_occurred","An error occurred"))}})},E=()=>{h.post(n("finance.zra.submit",s.id),{},{onSuccess:()=>{i.success(a("finance.zra.submission_started","ZRA submission started"))},onError:()=>{i.error(a("common.error_occurred","An error occurred"))}})},B=()=>{h.post(n("finance.zra.resubmit",s.id),{},{onSuccess:()=>{i.success(a("finance.zra.resubmission_started","ZRA resubmission started"))},onError:()=>{i.error(a("common.error_occurred","An error occurred"))}})},L=()=>{confirm(a("finance.zra.confirm_cancel","Are you sure you want to cancel this ZRA submission?"))&&h.post(n("finance.zra.cancel",s.id),{},{onSuccess:()=>{i.success(a("finance.zra.cancelled","ZRA submission cancelled"))},onError:()=>{i.error(a("common.error_occurred","An error occurred"))}})},c=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:s.currency}).format(r),F=r=>{switch(r){case"paid":return"bg-green-100 text-green-800";case"sent":return"bg-blue-100 text-blue-800";case"overdue":return"bg-red-100 text-red-800";case"draft":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},q=r=>{switch(r){case"paid":return"✓";case"sent":return"→";case"overdue":return"!";case"draft":return"○";default:return"○"}},y=r=>{const u={not_submitted:{variant:"secondary",icon:I,color:"text-gray-600"},pending:{variant:"secondary",icon:I,color:"text-yellow-600"},submitted:{variant:"default",icon:T,color:"text-blue-600"},approved:{variant:"default",icon:me,color:"text-green-600"},rejected:{variant:"destructive",icon:g,color:"text-red-600"},cancelled:{variant:"secondary",icon:g,color:"text-gray-600"}},D=u[r]||u.not_submitted,$=D.icon;return e.jsxs(f,{variant:D.variant,className:"flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),a(`finance.zra.status.${r}`,r.replace("_"," "))]})},N=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",_=s.total_amount-s.paid_amount,w=s.paid_amount/s.total_amount*100;return e.jsxs(H,{title:`${a("finance.invoice","Invoice")} ${s.invoice_number}`,breadcrumbs:[{label:a("finance.title","Finance"),href:"/finance"},{label:a("finance.invoices","Invoices"),href:"/finance/invoices"},{label:s.invoice_number}],children:[e.jsx(U,{title:`${a("finance.invoice","Invoice")} ${s.invoice_number}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(t,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(l,{href:n("finance.invoices.index"),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),a("common.back","Back")]})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight",children:[a("finance.invoice","Invoice")," ",s.invoice_number]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(f,{className:F(s.status),variant:"secondary",children:[e.jsx("span",{className:"mr-1",children:q(s.status)}),s.status]}),e.jsx("span",{className:"text-muted-foreground",children:"•"}),y(s.zra_status),e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsxs("span",{className:"text-muted-foreground",children:[a("finance.due_date","Due"),": ",new Date(s.due_date).toLocaleDateString()]}),s.is_zra_locked&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsxs(f,{variant:"outline",className:"text-orange-600 border-orange-600",children:[e.jsx(b,{className:"h-3 w-3 mr-1"}),a("finance.zra.locked","ZRA Locked")]})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.zra_status==="not_submitted"&&!s.is_zra_locked&&e.jsxs(t,{onClick:E,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),a("finance.zra.submit","Submit to ZRA")]}),(s.zra_status==="rejected"||s.zra_status==="cancelled")&&!s.is_zra_locked&&e.jsxs(t,{onClick:B,variant:"outline",className:"border-blue-600 text-blue-600",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),a("finance.zra.resubmit","Resubmit to ZRA")]}),(s.zra_status==="pending"||s.zra_status==="submitted")&&e.jsxs(t,{onClick:L,variant:"outline",className:"border-red-600 text-red-600",children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),a("finance.zra.cancel","Cancel ZRA")]}),s.status==="draft"&&!s.is_zra_locked&&e.jsxs(t,{onClick:P,children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),a("finance.send_invoice","Send Invoice")]}),e.jsx(t,{variant:"outline",asChild:!0,children:e.jsxs(l,{href:n("finance.invoices.pdf",s.id),target:"_blank",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),a("finance.download_pdf","Download PDF")]})}),!s.is_zra_locked&&e.jsx(t,{variant:"outline",asChild:!0,children:e.jsxs(l,{href:n("finance.invoices.edit",s.id),children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),a("common.edit","Edit")]})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),a("finance.client_information","Client Information")]})}),e.jsx(x,{children:s.billable?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsx("h3",{className:"font-semibold text-lg",children:s.billable.name})}),e.jsxs("div",{className:"grid gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.billable.email})]}),s.billable.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.billable.phone})]}),s.billable.address&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.billable.address})]})]})]}):e.jsx("p",{className:"text-muted-foreground",children:a("finance.no_client","No client assigned")})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),a("finance.invoice_items","Invoice Items")]})}),e.jsxs(x,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(X,{children:[e.jsx(G,{children:e.jsxs(k,{children:[e.jsx(j,{children:a("finance.description","Description")}),e.jsx(j,{className:"text-center",children:a("finance.quantity","Qty")}),e.jsx(j,{className:"text-right",children:a("finance.unit_price","Unit Price")}),e.jsx(j,{className:"text-right",children:a("finance.total","Total")})]})}),e.jsx(J,{children:s.items.map(r=>e.jsxs(k,{children:[e.jsx(p,{className:"font-medium",children:r.description}),e.jsx(p,{className:"text-center",children:r.quantity}),e.jsx(p,{className:"text-right",children:c(r.unit_price)}),e.jsx(p,{className:"text-right font-medium",children:c(r.total_price)})]},r.id))})]})}),e.jsxs("div",{className:"mt-6 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a("finance.subtotal","Subtotal"),":"]}),e.jsx("span",{className:"font-medium",children:c(s.subtotal)})]}),s.tax_amount>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a("finance.tax","Tax"),":"]}),e.jsx("span",{className:"font-medium",children:c(s.tax_amount)})]}),s.discount_amount>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a("finance.discount","Discount"),":"]}),e.jsxs("span",{className:"font-medium",children:["-",c(s.discount_amount)]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold pt-2 border-t",children:[e.jsxs("span",{children:[a("finance.total","Total"),":"]}),e.jsx("span",{children:c(s.total_amount)})]})]})]})]}),(s.notes||s.terms)&&e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(o,{children:a("finance.additional_information","Additional Information")})}),e.jsxs(x,{className:"space-y-4",children:[s.notes&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:a("finance.notes","Notes")}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:s.notes})]}),s.terms&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:a("finance.terms","Terms & Conditions")}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:s.terms})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),a("finance.zra.compliance","ZRA Compliance")]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a("finance.zra.status","Status"),":"]}),y(s.zra_status)]}),((z=s.zra_smart_invoice)==null?void 0:z.zra_reference)&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a("finance.zra.reference","ZRA Reference"),":"]}),e.jsx("span",{className:"text-sm font-mono",children:s.zra_smart_invoice.zra_reference})]}),((v=s.zra_smart_invoice)==null?void 0:v.submitted_at)&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a("finance.zra.submitted_at","Submitted"),":"]}),e.jsx("span",{className:"text-sm",children:N(s.zra_smart_invoice.submitted_at)})]}),((C=s.zra_smart_invoice)==null?void 0:C.approved_at)&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a("finance.zra.approved_at","Approved"),":"]}),e.jsx("span",{className:"text-sm",children:N(s.zra_smart_invoice.approved_at)})]}),((S=s.zra_smart_invoice)==null?void 0:S.rejected_at)&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a("finance.zra.rejected_at","Rejected"),":"]}),e.jsx("span",{className:"text-sm",children:N(s.zra_smart_invoice.rejected_at)})]}),s.zra_qr_code&&e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx(te,{className:"h-5 w-5 mx-auto text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:a("finance.zra.qr_code","ZRA QR Code")})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg border inline-block",children:e.jsx("img",{src:s.zra_qr_code,alt:"ZRA QR Code",className:"w-32 h-32 mx-auto"})}),((A=s.zra_smart_invoice)==null?void 0:A.verification_url)&&e.jsx(t,{variant:"outline",size:"sm",className:"mt-2",asChild:!0,children:e.jsxs("a",{href:s.zra_smart_invoice.verification_url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),a("finance.zra.verify","Verify")]})})]})}),((R=s.zra_smart_invoice)==null?void 0:R.validation_errors)&&s.zra_smart_invoice.validation_errors.length>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ce,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-red-600",children:a("finance.zra.validation_errors","Validation Errors")})]}),e.jsx("div",{className:"space-y-1",children:s.zra_smart_invoice.validation_errors.map((r,u)=>e.jsx("div",{className:"text-xs text-red-600 bg-red-50 p-2 rounded",children:r},u))})]}),e.jsx("div",{className:"pt-4 border-t space-y-2",children:s.zra_smart_invoice&&e.jsx(t,{variant:"outline",size:"sm",className:"w-full",asChild:!0,children:e.jsxs(l,{href:n("finance.zra.show",s.zra_smart_invoice.id),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),a("finance.zra.view_details","View ZRA Details")]})})})]})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),a("finance.invoice_summary","Invoice Summary")]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:[a("finance.issue_date","Issue Date"),":"]}),e.jsx("span",{children:new Date(s.issue_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:[a("finance.due_date","Due Date"),":"]}),e.jsx("span",{children:new Date(s.due_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:[a("finance.currency","Currency"),":"]}),e.jsx("span",{children:s.currency})]}),e.jsxs("div",{className:"flex justify-between font-medium pt-2 border-t",children:[e.jsxs("span",{children:[a("finance.total_amount","Total Amount"),":"]}),e.jsx("span",{children:c(s.total_amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:[a("finance.paid_amount","Paid Amount"),":"]}),e.jsx("span",{className:"text-green-600",children:c(s.paid_amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:[a("finance.remaining_amount","Remaining"),":"]}),e.jsx("span",{className:_>0?"text-red-600":"text-green-600",children:c(_)})]})]}),s.paid_amount>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:a("finance.payment_progress","Payment Progress")}),e.jsxs("span",{children:[Math.round(w),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(w,100)}%`}})})]}),e.jsxs("div",{className:"pt-4 border-t space-y-2",children:[_>0&&e.jsx(t,{asChild:!0,className:"w-full",children:e.jsxs(l,{href:n("finance.payments.create",{invoice:s.id}),children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),a("finance.record_payment","Record Payment")]})}),e.jsx(t,{variant:"outline",asChild:!0,className:"w-full",children:e.jsxs(l,{href:n("finance.invoices.pdf",s.id),target:"_blank",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),a("finance.download_pdf","Download PDF")]})})]})]})]}),s.payments.length>0&&e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),a("finance.payment_history","Payment History")]})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-3",children:s.payments.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.payment_number}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[new Date(r.payment_date).toLocaleDateString()," • ",r.payment_method]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:c(r.amount)}),e.jsx(f,{variant:"secondary",className:r.status==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800",children:r.status})]})]},r.id))})})]})]})]})]})]})}export{xs as default};
