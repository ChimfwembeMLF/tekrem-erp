import{u as J,r as b,j as e,S as L,A as w}from"./app-BMIA6nir.js";import{A as I}from"./AppLayout-DbMk6clK.js";import{C as d,a as o,b as r,d as j,c as p}from"./card-BAsSN-2Z.js";import{B as f}from"./createLucideIcon-Cg8jdX0w.js";import{I as C}from"./input-Bg5GDATO.js";import{L as m}from"./label-CM6YsqH1.js";import{T as h}from"./textarea-CP26afIU.js";import{S as B,a as P,b as $,c as M,d as H}from"./select-B6KOX9nY.js";import{S as T}from"./switch-_qD_kSA5.js";import{S as V}from"./separator-DnQonHW9.js";import{A as k,a as A}from"./alert-CNp8ZuHk.js";import{u as z}from"./useTranslate-ER5gAOX6.js";import{t as u}from"./index-Dj2TB_RL.js";import{A as R}from"./arrow-left-UX2kDF52.js";import{S as U}from"./star-D4SUxlZH.js";import{E as q}from"./eye-DdivFxyT.js";import{S as G}from"./save-D6UyxhH5.js";import{T as D}from"./triangle-alert-BWIpgUmg.js";import{C as K}from"./code-CCW4zUdR.js";import{S as Q}from"./sheet-1SUjjT9Y.js";import"./useTypedPage-hmuARwun.js";import"./index-BN56TOeV.js";import"./index-DdwO_6Rs.js";import"./index-DgfI6AGt.js";import"./index-BeGDJhOY.js";import"./index-DwXxsQvB.js";import"./AppProvider-NPNBF0OW.js";import"./users-3SuyoAg3.js";import"./message-square-32k9udjC.js";import"./message-circle-CVsRMw7b.js";import"./NotificationComponent-CHA3vjZG.js";import"./x-C3KwZK3B.js";import"./bell-5VRgJnzP.js";import"./dollar-sign-Cli0KufN.js";import"./file-text-D25AipK4.js";import"./trending-up-00s2SIxN.js";import"./smartphone-BqGcJ2Wh.js";import"./shield-DwKJ9Ble.js";import"./building-DIkCZBBP.js";import"./ticket-B_Ks_Sjf.js";import"./book-open-DEtrBf1m.js";import"./image-Ct2miMof.js";import"./calendar-DTsvo4Hi.js";import"./clock-BTinGqFV.js";import"./graduation-cap-leaforsl.js";import"./brain-D-NomhzH.js";import"./user-cog-hTW3YbTW.js";import"./key-Qw2I2-NE.js";import"./plus-BjPf5uI-.js";import"./bot-COuCQh0r.js";import"./globe-S29F6yCY.js";import"./share-2-cOWypco3.js";import"./chevron-down-CrO8JO_i.js";import"./log-out-B525vUfE.js";import"./index-BDIc0y8N.js";import"./index-DTi2vEM4.js";function Ye({template:i,categories:E,errors:t}){var S;const{t:s}=z(),v=J(),[N,x]=b.useState(!1),[c,_]=b.useState({name:i.name,slug:i.slug,description:i.description||"",content:i.content,category:i.category,is_active:i.is_active,is_default:i.is_default,fields:JSON.stringify(i.fields||{},null,2),settings:JSON.stringify(i.settings||{},null,2)}),n=(a,l)=>{if(_(g=>({...g,[a]:l})),a==="name"&&!c.slug){const g=l.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");_(O=>({...O,slug:g}))}},y=async a=>{a.preventDefault(),x(!0);try{try{JSON.parse(c.fields),JSON.parse(c.settings)}catch{u.error(s("cms.invalid_json","Invalid JSON format in fields or settings")),x(!1);return}w.put(v("cms.templates.update",i.id),{...c,fields:JSON.parse(c.fields),settings:JSON.parse(c.settings)},{onSuccess:()=>{u.success(s("cms.template_updated","Template updated successfully"))},onError:l=>{console.error("Validation errors:",l),u.error(s("cms.template_update_failed","Failed to update template"))},onFinish:()=>{x(!1)}})}catch(l){console.error("Error updating template:",l),u.error(s("cms.template_update_failed","Failed to update template")),x(!1)}},F=()=>{const a={...c,content:c.content||"<p>Preview content...</p>"};sessionStorage.setItem("template_preview",JSON.stringify(a)),window.open(`/cms/templates/${i.id}/preview`,"_blank")};return e.jsxs(I,{children:[e.jsx(L,{title:`${s("common.edit","Edit")} ${i.name}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>w.visit(v("cms.templates.index")),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),s("common.back","Back")]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[s("common.edit","Edit")," ",i.name,i.is_default&&e.jsx(U,{className:"h-5 w-5 text-yellow-500 fill-current"})]}),e.jsx("p",{className:"text-muted-foreground",children:s("cms.edit_template_description","Modify template settings and content")})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",onClick:F,disabled:!c.content,children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),s("cms.preview","Preview")]}),e.jsxs(f,{onClick:y,disabled:N||!c.name||!c.content,children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),N?s("common.saving","Saving..."):s("common.save","Save")]})]})]}),i.usage_stats&&e.jsxs(k,{children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx(A,{children:s("cms.template_usage_warning","This template is used by {{count}} pages. Changes may affect existing content.",{count:i.usage_stats.total_pages})})]}),Object.keys(t||{}).length>0&&e.jsxs(k,{variant:"destructive",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx(A,{children:s("common.validation_errors","Please fix the validation errors below")})]}),e.jsx("form",{onSubmit:y,className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(r,{children:s("cms.basic_information","Basic Information")}),e.jsx(j,{children:s("cms.template_basic_info_desc","Enter the basic template details")})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(m,{htmlFor:"name",children:[s("cms.template_name","Template Name")," *"]}),e.jsx(C,{id:"name",value:c.name,onChange:a=>n("name",a.target.value),placeholder:s("cms.enter_template_name","Enter template name"),className:t!=null&&t.name?"border-destructive":""}),(t==null?void 0:t.name)&&e.jsx("p",{className:"text-sm text-destructive",children:t.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"slug",children:s("cms.slug","Slug")}),e.jsx(C,{id:"slug",value:c.slug,onChange:a=>n("slug",a.target.value),placeholder:s("cms.auto_generated","Auto-generated from name"),className:t!=null&&t.slug?"border-destructive":""}),(t==null?void 0:t.slug)&&e.jsx("p",{className:"text-sm text-destructive",children:t.slug})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",children:s("cms.description","Description")}),e.jsx(h,{id:"description",value:c.description,onChange:a=>n("description",a.target.value),placeholder:s("cms.template_description_placeholder","Describe this template..."),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(m,{htmlFor:"category",children:[s("cms.category","Category")," *"]}),e.jsxs(B,{value:c.category,onValueChange:a=>n("category",a),children:[e.jsx(P,{className:t!=null&&t.category?"border-destructive":"",children:e.jsx($,{placeholder:s("cms.select_category","Select a category")})}),e.jsx(M,{children:Object.entries(E).map(([a,l])=>e.jsx(H,{value:a,children:l},a))})]}),(t==null?void 0:t.category)&&e.jsx("p",{className:"text-sm text-destructive",children:t.category})]})]})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5"}),s("cms.template_content","Template Content")]}),e.jsx(j,{children:s("cms.template_content_desc","Enter the HTML/Blade template content")})]}),e.jsx(p,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(m,{htmlFor:"content",children:[s("cms.content","Content")," *"]}),e.jsx(h,{id:"content",value:c.content,onChange:a=>n("content",a.target.value),placeholder:s("cms.template_content_placeholder","Enter your template HTML/Blade content..."),rows:15,className:`font-mono text-sm ${t!=null&&t.content?"border-destructive":""}`}),(t==null?void 0:t.content)&&e.jsx("p",{className:"text-sm text-destructive",children:t.content})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),s("cms.template_settings","Template Settings")]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(m,{children:s("cms.active","Active")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("cms.template_active_desc","Make this template available for use")})]}),e.jsx(T,{checked:c.is_active,onCheckedChange:a=>n("is_active",a)})]}),e.jsx(V,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(m,{children:s("cms.default_template","Default Template")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("cms.default_template_desc","Set as the default template for new pages")})]}),e.jsx(T,{checked:c.is_default,onCheckedChange:a=>n("is_default",a)})]})]})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(r,{children:s("cms.template_info","Template Information")})}),e.jsxs(p,{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("cms.created_by","Created by"),": "]}),e.jsx("span",{children:((S=i.created_by)==null?void 0:S.name)||"Unknown"})]}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("cms.created_at","Created"),": "]}),e.jsx("span",{children:new Date(i.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("cms.updated_at","Updated"),": "]}),e.jsx("span",{children:new Date(i.updated_at).toLocaleDateString()})]}),i.usage_stats&&e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s("cms.pages_using","Pages using"),": "]}),e.jsx("span",{className:"font-medium",children:i.usage_stats.total_pages})]})]})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(r,{children:s("cms.advanced_settings","Advanced Settings")}),e.jsx(j,{children:s("cms.advanced_settings_desc","JSON configuration for fields and settings")})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"fields",children:s("cms.template_fields","Template Fields")}),e.jsx(h,{id:"fields",value:c.fields,onChange:a=>n("fields",a.target.value),placeholder:'{"field_name": {"type": "text", "label": "Field Label"}}',rows:4,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("cms.json_format","JSON format")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"settings",children:s("cms.template_settings_json","Template Settings")}),e.jsx(h,{id:"settings",value:c.settings,onChange:a=>n("settings",a.target.value),placeholder:'{"layout": "app", "cache_enabled": true}',rows:4,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("cms.json_format","JSON format")})]})]})]})]})]})})]})]})}export{Ye as default};
