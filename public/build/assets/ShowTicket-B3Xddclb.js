import{u as O,r as S,G as m,j as e,S as G,x as I}from"./app-BMIA6nir.js";import{C as V}from"./CustomerLayout-7LFTkDxI.js";import{C as n,a as i,b as l,c,d as T}from"./card-BAsSN-2Z.js";import{U as _,B as t}from"./x-C3KwZK3B.js";import{B as r}from"./createLucideIcon-Cg8jdX0w.js";import{T as x}from"./textarea-CP26afIU.js";import{A as W}from"./arrow-left-UX2kDF52.js";import{C as X}from"./circle-check-big-DCsv6rXk.js";import{R as Y}from"./rotate-ccw-BcdmK91W.js";import{M as h}from"./message-square-32k9udjC.js";import{S as J}from"./send-C-AP4C9s.js";import{C as K}from"./calendar-DTsvo4Hi.js";import{C as Q}from"./clock-BTinGqFV.js";import{C as Z}from"./circle-x-D-Fm_LhT.js";import{E as ee}from"./eye-DdivFxyT.js";import{S as D}from"./star-D4SUxlZH.js";import"./avatar-DdiG0YBt.js";import"./index-DdwO_6Rs.js";import"./index-DwXxsQvB.js";import"./NotificationComponent-CHA3vjZG.js";import"./index-BN56TOeV.js";import"./index-BeGDJhOY.js";import"./index-DgfI6AGt.js";import"./useTypedPage-hmuARwun.js";import"./bell-5VRgJnzP.js";import"./sheet-1SUjjT9Y.js";import"./users-3SuyoAg3.js";import"./log-out-B525vUfE.js";import"./file-text-D25AipK4.js";function Be({ticket:s}){const o=O(),[R,u]=S.useState(!1),[B,p]=S.useState(!1),{data:j,setData:P,post:A,processing:f,reset:k}=m({content:""}),{data:g,setData:v,post:F,processing:N}=m({satisfaction_rating:5,satisfaction_feedback:""}),{data:b,setData:L,post:U,processing:y}=m({reason:""}),d=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),C=a=>{switch(a){case"open":return e.jsx(t,{variant:"destructive",children:"Open"});case"in_progress":return e.jsx(t,{variant:"default",className:"bg-blue-100 text-blue-800",children:"In Progress"});case"resolved":return e.jsx(t,{variant:"default",className:"bg-green-100 text-green-800",children:"Resolved"});case"closed":return e.jsx(t,{variant:"secondary",children:"Closed"});default:return e.jsx(t,{variant:"outline",children:a})}},w=a=>{switch(a){case"urgent":return e.jsx(t,{variant:"destructive",children:"Urgent"});case"high":return e.jsx(t,{variant:"destructive",className:"bg-orange-100 text-orange-800",children:"High"});case"medium":return e.jsx(t,{variant:"default",className:"bg-yellow-100 text-yellow-800",children:"Medium"});case"low":return e.jsx(t,{variant:"secondary",children:"Low"});default:return e.jsx(t,{variant:"outline",children:a})}},E=a=>{a.preventDefault(),A(o("customer.support.tickets.comments.store",s.id),{onSuccess:()=>{k()}})},q=a=>{a.preventDefault(),F(o("customer.support.tickets.close",s.id))},z=a=>{a.preventDefault(),U(o("customer.support.tickets.reopen",s.id))},M=["resolved"].includes(s.status),$=["closed"].includes(s.status),H=!["closed"].includes(s.status);return e.jsxs(V,{children:[e.jsx(G,{title:`Ticket #${s.ticket_number}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(I,{href:o("customer.support.index"),children:e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Back to Support"]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight",children:["Ticket #",s.ticket_number]}),C(s.status),w(s.priority)]}),e.jsx("p",{className:"text-muted-foreground",children:s.title})]})]}),e.jsxs("div",{className:"flex gap-2",children:[M&&e.jsxs(r,{variant:"outline",onClick:()=>u(!0),className:"text-green-600 hover:text-green-700",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Close Ticket"]}),$&&e.jsxs(r,{variant:"outline",onClick:()=>p(!0),className:"text-blue-600 hover:text-blue-700",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Reopen Ticket"]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(n,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-5 w-5"}),"Description"]})}),e.jsx(c,{children:e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"whitespace-pre-wrap",children:s.description})})})]}),e.jsxs(n,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-5 w-5"}),"Comments (",s.comments.length,")"]})}),e.jsxs(c,{className:"space-y-4",children:[s.comments.length>0?e.jsx("div",{className:"space-y-4",children:s.comments.map(a=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-secondary rounded-full flex items-center justify-center",children:e.jsx(_,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:a.user.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:d(a.created_at)})]})]}),e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"whitespace-pre-wrap",children:a.content})})]},a.id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(h,{className:"mx-auto h-8 w-8 mb-2"}),e.jsx("p",{children:"No comments yet"})]}),H&&e.jsxs("form",{onSubmit:E,className:"space-y-4 pt-4 border-t",children:[e.jsx("div",{children:e.jsx(x,{placeholder:"Add a comment...",value:j.content,onChange:a=>P("content",a.target.value),rows:4,required:!0})}),e.jsxs(r,{type:"submit",disabled:f||!j.content.trim(),children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),f?"Sending...":"Add Comment"]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(l,{children:"Ticket Details"})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx("div",{className:"mt-1",children:C(s.status)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Priority"}),e.jsx("div",{className:"mt-1",children:w(s.priority)})]}),s.category&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Category"}),e.jsx("div",{className:"mt-1",children:e.jsx(t,{variant:"outline",style:{backgroundColor:s.category.color+"20",color:s.category.color},children:s.category.name})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Created"}),e.jsxs("div",{className:"text-sm mt-1 flex items-center gap-2",children:[e.jsx(K,{className:"h-3 w-3"}),d(s.created_at)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Last Updated"}),e.jsxs("div",{className:"text-sm mt-1 flex items-center gap-2",children:[e.jsx(Q,{className:"h-3 w-3"}),d(s.updated_at)]})]}),s.closed_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Closed"}),e.jsxs("div",{className:"text-sm mt-1 flex items-center gap-2",children:[e.jsx(Z,{className:"h-3 w-3"}),d(s.closed_at)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Views"}),e.jsxs("div",{className:"text-sm mt-1 flex items-center gap-2",children:[e.jsx(ee,{className:"h-3 w-3"}),s.view_count]})]})]})]}),s.assignedTo&&e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(l,{children:"Assigned To"})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-secondary rounded-full flex items-center justify-center",children:e.jsx(_,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.assignedTo.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.assignedTo.email})]})]})})]}),s.satisfaction_rating&&e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(l,{children:"Your Rating"})}),e.jsxs(c,{children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[[1,2,3,4,5].map(a=>e.jsx(D,{className:`h-4 w-4 ${a<=s.satisfaction_rating?"text-yellow-400 fill-current":"text-gray-300"}`},a)),e.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:[s.satisfaction_rating,"/5"]})]}),s.satisfaction_feedback&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:['"',s.satisfaction_feedback,'"']})]})]})]})]}),R&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs(n,{className:"w-full max-w-md",children:[e.jsxs(i,{children:[e.jsx(l,{children:"Close Ticket"}),e.jsx(T,{children:"Please rate your experience and provide feedback"})]}),e.jsx(c,{children:e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Satisfaction Rating"}),e.jsx("div",{className:"flex items-center gap-1 mt-2",children:[1,2,3,4,5].map(a=>e.jsx("button",{type:"button",onClick:()=>v("satisfaction_rating",a),className:"p-1",children:e.jsx(D,{className:`h-6 w-6 ${a<=g.satisfaction_rating?"text-yellow-400 fill-current":"text-gray-300"}`})},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Feedback (Optional)"}),e.jsx(x,{placeholder:"Tell us about your experience...",value:g.satisfaction_feedback,onChange:a=>v("satisfaction_feedback",a.target.value),rows:3,className:"mt-2"})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(r,{type:"submit",disabled:N,className:"flex-1",children:N?"Closing...":"Close Ticket"}),e.jsx(r,{type:"button",variant:"outline",onClick:()=>u(!1),className:"flex-1",children:"Cancel"})]})]})})]})}),B&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs(n,{className:"w-full max-w-md",children:[e.jsxs(i,{children:[e.jsx(l,{children:"Reopen Ticket"}),e.jsx(T,{children:"Please provide a reason for reopening this ticket"})]}),e.jsx(c,{children:e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Reason"}),e.jsx(x,{placeholder:"Why are you reopening this ticket?",value:b.reason,onChange:a=>L("reason",a.target.value),rows:3,className:"mt-2",required:!0})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(r,{type:"submit",disabled:y||!b.reason.trim(),className:"flex-1",children:y?"Reopening...":"Reopen Ticket"}),e.jsx(r,{type:"button",variant:"outline",onClick:()=>p(!1),className:"flex-1",children:"Cancel"})]})]})})]})})]})]})}export{Be as default};
